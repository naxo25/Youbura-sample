{"version":3,"sources":["webpack://youbora/webpack/universalModuleDefinition","webpack://youbora/webpack/bootstrap","webpack://youbora/./node_modules/youboralib/src/log.js","webpack://youbora/./node_modules/youboralib/src/object.js","webpack://youbora/./node_modules/youboralib/src/util.js","webpack://youbora/./node_modules/youboralib/src/constants.js","webpack://youbora/./node_modules/youboralib/src/comm/request.js","webpack://youbora/./node_modules/youboralib/src/emitter.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/transform.js","webpack://youbora/./node_modules/youboralib/src/chrono.js","webpack://youbora/./node_modules/youboralib/src/version.js","webpack://youbora/./node_modules/youboralib/src/constants/adapter.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/formatparsers/parser.js","webpack://youbora/./node_modules/youboralib/src/constants/transportFormat.js","webpack://youbora/./node_modules/youboralib/src/youboralib.js","webpack://youbora/./node_modules/youboralib/src/mixins/isarray.js","webpack://youbora/./node_modules/youboralib/src/timer.js","webpack://youbora/./node_modules/youboralib/src/comm/communication.js","webpack://youbora/./node_modules/youboralib/src/plugin/storage.js","webpack://youbora/./node_modules/youboralib/src/infinity/infinity.js","webpack://youbora/./node_modules/youboralib/src/adapter/adapter.js","webpack://youbora/./node_modules/youboralib/src/mixins/assign.js","webpack://youbora/./node_modules/youboralib/src/monitors/hybridnetwork.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/view.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resource.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/formatparsers/hlsparser.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparser.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/formatparsers/dashparser.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/formatparsers/locationheaderparser.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/offline.js","webpack://youbora/./node_modules/youboralib/src/plugin/options.js","webpack://youbora/./node_modules/youboralib/src/constants/streamingProtocols.js","webpack://youbora/./node_modules/youboralib/src/plugin/requestbuilder.js","webpack://youbora/./node_modules/youboralib/src/detectors/backgroundDetector.js","webpack://youbora/./node_modules/youboralib/src/detectors/deviceDetector.js","webpack://youbora/./node_modules/youboralib/src/deviceUUID/hashgenerator.js","webpack://youbora/./node_modules/youboralib/src/adapter/playheadmonitor.js","webpack://youbora/./src/sp.js","webpack://youbora/./node_modules/youboralib/src/polyfills.js","webpack://youbora/./node_modules/youboralib/src/mixins/create.js","webpack://youbora/./node_modules/youboralib/src/constants/adPosition.js","webpack://youbora/./node_modules/youboralib/src/constants/event.js","webpack://youbora/./node_modules/youboralib/src/constants/manifestError.js","webpack://youbora/./node_modules/youboralib/src/constants/service.js","webpack://youbora/./node_modules/youboralib/src/constants/willSendEvent.js","webpack://youbora/./node_modules/youboralib/src/constants/adInsertionType.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/level3.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/cloudfront.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/akamai.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/highwinds.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/fastly.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/telefonica.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/amazon.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/edgecast.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnparsers/balancer.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/resourceparsers/cdnSwitch.js","webpack://youbora/./node_modules/youboralib/src/plugin/deprecatedOptions.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/flow.js","webpack://youbora/./node_modules/youboralib/src/plugin/offlineStorage.js","webpack://youbora/./node_modules/youboralib/src/comm/transform/wrong.js","webpack://youbora/./node_modules/youboralib/src/monitors/browserLoadTimes.js","webpack://youbora/./node_modules/youboralib/src/monitors/speedIndex.js","webpack://youbora/./node_modules/youboralib/src/detectors/blockDetector.js","webpack://youbora/./node_modules/youboralib/src/detectors/resizeScrollDetector.js","webpack://youbora/./node_modules/youboralib/src/deviceUUID/dataextractor.js","webpack://youbora/./node_modules/youboralib/src/deviceUUID/md5.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+content.js","webpack://youbora/./node_modules/youboralib/src/adapter/playbackchronos.js","webpack://youbora/./node_modules/youboralib/src/adapter/playbackflags.js","webpack://youbora/./node_modules/youboralib/src/adapter/adapter+ads.js","webpack://youbora/./node_modules/youboralib/src/adapter/adapter+content.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+getters.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+content+getters.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+ads.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+ads+getters.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+pings.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+fire.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+infinity.js","webpack://youbora/./node_modules/youboralib/src/plugin/plugin+infinity+getters.js","webpack://youbora/./src/adapter.js","webpack://youbora/./src/ads/nativeads.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Emitter","isArray","Log","_emitter","on","apply","arguments","off","emit","Level","SILENT","ERROR","WARNING","NOTICE","DEBUG","VERBOSE","Event","LOG","logLevel","plainLogs","report","msg","level","color","console","log","document","logMethod","letter","5","4","3","2","1","prefix","_getCurrentTime","this","documentMode","_plainReport","error","warn","debug","splice","Date","getDate","slice","getMinutes","getSeconds","getMilliseconds","Array","notice","verbose","loadLevelFromUrl","location","_parseLevelFromUrl","search","url","exec","assign","createObject","YouboraObject","constructor","extend","protoProps","staticProps","child","parent","__super__","Util","stripProtocol","strippedUrl","replace","err","addProtocol","httpSecure","serviceUrl","protocol","indexOf","parseNumber","def","isNaN","Infinity","logAllEvents","extraEvents","e","type","playerEvents","shift","concat","length","addEventListener","buildRenditionString","width","height","bitrate","ret","Math","round","buildErrorParams","code","metadata","params","errorCode","errorMetadata","errorLevel","calculateAdViewability","player","screenPercent","isVisible","getBoundingClientRect","box","top","innerHeight","bottom","right","left","innerWidth","pixels","trunc","x1","x2","y1","getMetricsFrom","op1","op2","metrics","metric","temporal","AdPosition","Adapter","Constants","ManifestError","Service","WillSendEvent","AdInsertionType","YBRequest","host","service","options","xhr","createXHR","defaultOptions","retries","cache","setParam","getTime","XMLHttpRequest","ActiveXObject","getXHR","getResponse","response","getResponseText","responseText","getResponseHeaders","getAllResponseHeaders","getUrl","getParamString","event","callback","callbackParams","SUCCESS","onreadystatechange","readyState","removeEventListener","param","string","JSON","stringify","encodeURIComponent","getParam","setBody","body","send","open","method","requestHeaders","setRequestHeader","retryAfter","maxRetries","setTimeout","atv","_globalListeners","forEach","LOAD","ABORT","onEvery","push","offEvery","index","_listeners","data","_eachCallback","target","Transform","_isBusy","_sendRequest","transformName","parse","request","isBlocking","done","DONE","hasToSend","getState","STATE_BLOCKED","STATE_NO_BLOCKED","STATE_OFFLINE","Chrono","reset","startTime","stopTime","pauseTime","offset","getDeltaTime","stop","retValue","now","tempOffset","tempStop","start","resume","pause","clone","chrono","version","Parser","_realResource","_lastManifest","_transportFormat","iterations","resource","lastManifest","getResource","getTransportFormat","getLastManifest","shouldExecute","MP4","MPEG2","CMF","previousYoubora","youbora","VERSION","polyfills","HybridNetwork","Timer","Request","Communication","ViewTransform","ResourceTransform","CdnParser","HlsParser","DashParser","OfflineParser","LocationheaderParser","Options","Plugin","Storage","RequestBuilder","PlayheadMonitor","adapters","BackgroundDetector","DeviceDetector","UUIDGenerator","registerAdapter","unregisterAdapter","obj","toString","interval","isRunning","_timer","_setTick","clearTimeout","pluginref","transforms","pluginRef","_requests","sendRequest","_registerRequest","buildRequest","addTransform","transform","_processRequests","removeTransform","pos","workingQueue","rejected","transformState","_transform","getHost","YouboraStorage","disableCookies","disable","disabled","isEnabled","localStorage","setItem","removeItem","setLocal","_setCookie","getLocal","_localGetRemove","removeLocal","storageMethod","cookieMethod","setSession","sessionStorage","getSession","_sessionGetRemove","removeSession","getStorages","setStorages","removeStorages","cname","cvalue","cookie","_getCookie","ca","decodeURIComponent","split","charAt","substring","_removeCookie","Comm","WrongTransform","YouboraInfinity","plugin","_plugin","andBeyond","begin","dimensions","_comm","viewTransform","storage","_registeredProperties","getIsSessionExpired","fireNav","_sendExtraBeat","fireSessionStart","_generateNewContext","context","btoa","_setLastActive","_firstActive","getFirstActive","Number","getLastActive","getComm","infinityStarted","SESSION_START","_getParamsJson","fireSessionStop","SESSION_STOP","newSession","isActive","restartViewTransform","setOptions","getContext","NAV","_beat","time","_sendBeat","fireEvent","eventName","values","topLevelDimensions","builtParams","EVENT","register","registerOnce","unregister","isNavigaton","isStart","returnparams","key2","paramsObject","page","route","sessionExpire","BEAT","PlaybackChronos","PlaybackFlags","AdapterConstants","flags","chronos","monitor","_isAdsAdapter","setPlayer","tag","getVersion","unregisterListeners","getElementById","registerListeners","dispose","fireStop","monitorPlayhead","monitorBuffers","monitorSeeks","stopMonitor","Type","BUFFER","SEEK","skipNextTick","getPlayhead","getDuration","getBitrate","getTotalBytes","getTitle","getPlayerVersion","getPlayerName","fireInit","fireStart","backgroundDetector","canBlockStartCalls","isStarted","total","join","START","fireJoin","isJoined","_isAds","isInitiated","JOIN","firePause","isBuffering","fireBufferEnd","isPaused","PAUSE","fireResume","RESUME","fireBufferBegin","convertFromSeek","isSeeking","buffer","seek","BUFFER_BEGIN","cancelBuffer","BUFFER_END","_isStopReady","STOP","viewedMax","setIsAds","fireCasted","casted","fireError","fireFatalError","TypeError","output","source","nextKey","HybridNetowrk","getCdnTraffic","Streamroot","_getStreamrootPeerObject","_getStreamrootInstanceObject","peer5","getStats","totalHttpDownloaded","teltoo","stats","totalReceivedBytes","p2pReceivedBytes","getP2PTraffic","totalP2PDownloaded","getUploadTraffic","totalP2PUploaded","getIsP2PEnabled","p2pAvailable","peerAgents","agent","isP2PEnabled","instances","instance","dnaDownloadEnabled","dnaUploadEnabled","objectName","check","agentInst","currentContent","session","_viewIndex","_session","_httpSecure","init","offline","pingTime","beatTime","getDataTime","getStoredData","setData","DATA","outputformat","requestBuilder","buildParams","system","_receiveData","_failedData","resp","q","h","pt","bt","exp","req","nextView","getViewCode","setHost","getAccountCode","sessionRoot","EventList","PingTime","sessionId","CreateView","infinity","parentId","navContext","INIT","PING","CdnSwitch","_initResource","_cdnName","_cdnNodeHost","_cdnNodeTypeString","_cdnNodeType","_responses","_getInitialCdnResource","getCdnName","getNodeHost","getNodeTypeString","getNodeType","_parseManifestEnabled","isParseManifest","_cdnEnabled","isParseCdnNode","_cdnList","getParseCdnNodeList","_cdnNameHeader","getParseCdnNodeNameHeader","setBalancerHeaderName","_setTimeout","_isFinalUrl","parseManifest","_parseCDN","segmentExtensions","ext","lastIndexOf","timeoutComplete","_parseTimeout","lastSrc","parserArray","_parseManifest","format","parser","isCdnSwitch","switchDetector","Events","cdn","cdnParser","getResponses","getParsedCdnName","getParsedNodeHost","getParsedNodeTypeString","getParsedNodeType","lastSent","parsedResource","transportFormat","nodeHost","nodeType","nodeTypeString","TransportFormat","parentResource","matches","replaceAll","res","trim","prevParent","ind","substr","_parseWithManifest","_options","cdnName","parsers","requestMethod","parseType","addParser","setCdnName","setRequestMethod","setParseType","responses","headerString","_parseResponse","_requestResponse","useheaders","headers","headerName","toLowerCase","line","_executeParser","regex","element","ElementType","HOST","TYPE","HOST_AND_TYPE","TYPE_AND_HOST","NAME","toUpperCase","_cdnConfigs","Balancer","add","config","parseLocation","locationRegexp","RegExp","manifest","newRes","_htmlDecode","parseFinalResource","input","createElement","innerHTML","childNodes","nodeValue","baseUrlRegexp","segmentUrlRegexp","segmentTemplateRegexp","_getManifestMetadata","_isFullUrl","found","startsWith","OfflineTransform","offlineStorage","addEvent","DeprecatedOptions","StreamingProtocol","enabled","accountCode","preventZombieViews","referer","referral","disableStorage","forceInit","linkedViewId","waitForMetadata","pendingMetadata","base","isInBase","undefined","deprecatedOptions","deprecated","newKey","exists","getNewName","setExtraParams","paramsArray","setCustomDimensions","setAdExtraParams","setAdCustomDimensions","HDS","HLS","MSS","DASH","RTMP","RTP","RTSP","startParams","adStartParams","_adNumber","fetchParams","paramList","onlyDifferent","getterName","getters","getGetters","buildBody","bodyParams","differentParams","getNewAdNumber","adNumber","position","getAdPosition","getNewBreakNumber","breakNumber","getChangedEntities","entities","requestNumber","playhead","playrate","fps","droppedFrames","mediaDuration","totalBytes","throughput","rendition","title","title2","live","mediaResource","transactionCode","properties","playerVersion","pluginVersion","libVersion","userType","streamingProtocol","obfuscateIp","householdId","latency","packetLoss","packetSent","param1","param2","param3","param4","param5","param6","param7","param8","param9","param10","param11","param12","param13","param14","param15","param16","param17","param18","param19","param20","extraparam1","extraparam2","extraparam3","extraparam4","extraparam5","extraparam6","extraparam7","extraparam8","extraparam9","extraparam10","adPlayhead","adDuration","adCampaign","adCreativeId","adBitrate","adTitle","adResource","adPlayerVersion","adProperties","adAdapterVersion","givenBreaks","expectedBreaks","expectedPattern","breaksTime","givenAds","expectedAds","adsExpected","adViewedDuration","adViewability","fullscreen","audio","skippable","adProvider","adInsertionType","pluginInfo","isp","connectionType","ip","deviceInfo","username","anonymousUser","joinDuration","bufferDuration","seekDuration","pauseDuration","adJoinDuration","adBufferDuration","adPauseDuration","adTotalDuration","language","playerStartupTime","pageLoadTime","cdnDownloadedTraffic","p2pDownloadedTraffic","p2pEnabled","uploadTraffic","viewJson","deviceUUID","sessionMetrics","scrollDepth","adsBlocked","smartswitchConfigCode","smartswitchGroupCode","smartswitchContractCode","appName","appReleaseVersion","package","saga","tvshow","season","titleEpisode","channel","drm","videoCodec","audioCodec","codecSettings","codecProfile","containerFormat","contentId","imdbID","gracenoteID","contentType","genre","contentLanguage","subtitles","contractedResolution","cost","price","playbackType","email","isInBackground","listenerReference","_visibilityListener","_reset","startDetection","isBackgroundDetectorStarted","stopDetection","settings","_getSettings","visibilityState","_toBackground","_toForeground","_adsAdapter","stopChronoView","_fireStop","_firePause","lastBeatTime","difftime","startChronoView","deviceDetector","isSmartTV","isDesktop","isAndroid","isIphone","isPlayStation","_fireX","fireMethod","adsAdapter","getAdsAdapter","contentAdapter","getAdapter","navigator","userAgent","_isSmartTVDevice","match","_isPlaystationDevice","_isIphoneDevice","_isAndroidDevice","_isSmartphoneDevice","_isDesktopDevice","isSmartphone","DataExtractor","MD5","HashGenerator","dataExtractor","getPreviousKey","generateHashKey","getAllData","_hashFunction","getKey","inputString","outputString","adapter","_adapter","_seekEnabled","_bufferEnabled","_chrono","_lastPlayhead","progress","deltaTime","bufferThreshold","kBUFFER_THRESHOLD_RATIO","seekThreshold","kSEEK_THRESHOLD_RATIO","getPlayrate","currentPlayhead","_getPlayhead","diffPlayhead","abs","fireSeekBegin","fireSeekEnd","NONE","Function","func","args","bound","invokedAsConstructor","thisArg","len","x","NaN","floor","ceil","F","Error","Preroll","Midroll","Postroll","SEEK_BEGIN","SEEK_END","CLICK","MANIFEST","PODSTART","PODSTOP","QUARTILE","VIDEO_EVENT","NO_RESPONSE","EMPTY","WRONG","AD_INIT","AD_START","AD_JOIN","AD_PAUSE","AD_RESUME","AD_BUFFER","AD_STOP","AD_CLICK","AD_ERROR","AD_MANIFEST","AD_POD_START","AD_POD_STOP","AD_QUARTILE","OFFLINE_EVENTS","WILL_SEND_INIT","WILL_SEND_START","WILL_SEND_JOIN","WILL_SEND_PAUSE","WILL_SEND_RESUME","WILL_SEND_SEEK","WILL_SEND_BUFFER","WILL_SEND_ERROR","WILL_SEND_FATAL_ERROR","WILL_SEND_STOP","WILL_SEND_PING","WILL_SEND_VIDEO_EVENT","WILL_SEND_AD_START","WILL_SEND_AD_JOIN","WILL_SEND_AD_PAUSE","WILL_SEND_AD_RESUME","WILL_SEND_AD_BUFFER","WILL_SEND_AD_STOP","WILL_SEND_AD_CLICK","WILL_SEND_AD_ERROR","WILL_SEND_AD_MANIFEST","WILL_SEND_AD_POD_START","WILL_SEND_AD_POD_STOP","WILL_SEND_AD_QUARTILE","WILL_SEND_SESSION_START","WILL_SEND_SESSION_STOP","WILL_SEND_NAV","WILL_SEND_BEAT","WILL_SEND_EVENT","WILL_SEND_OFFLINE_EVENTS","ClientSide","ServerSide","Pragma","getURLToParse","_request","_successfulRequest","parseInt","_failedRequest","optionName","Dictionary","newName","FlowTransform","OfflineStorage","BrowserLoadTimes","BlockDetector","ResizeScrollDetector","dataReq","uuidGenerator","isAdsManifestSent","playedPostrolls","isBreakStarted","initChrono","_ping","_sendPing","_refreshData","_checkOldData","resourceTransform","lastEventTime","_initInfinity","hybridNetwork","browserLoadTimes","resizeScrollDetector","blockDetector","setAdapter","getIsDataExpired","getStorageHost","_stopPings","startDelayed","_totalPrerollsTime","_savedAdManifest","_savedAdError","_send","willSendEvent","getIsLive","lastServeiceSent","_initComm","getFastDataConfig","enable","_services","actualView","viewList","givenIds","_getOldViewList","_newView","viewId","_getValidId","fullEvent","temp","getView","idToSend","removeView","id","stringList","random","sent","RUMSpeedIndex","timeObject","playerSetup","perfObject","myTimesObject","_windowLoaded","performance","timing","getEntriesByType","PerformanceObserver","observer","list","entries","getEntries","largestContentfulPaint","renderTime","supportedEntryTypes","observe","entryTypes","onLoad","_getEnoughFPS","_fireLoadTimesEvent","_getLastMetrics","_getAllValues","PageLoadTime","getPageLoadTime","DNSTime","getDnsTime","TCPTime","getTcpTime","HandshakeTime","getHandshakeTime","DomReadyTime","getDomReadyTime","BackendTime","getBackendTime","FrontendTime","getFrontendTime","VisualReady","getTimeToVisuallyReady","TimeToInteractive","getTimeToInteractive","JsTime","getJSTime","CssTime","getCSSTime","ImageTime","getImageTime","FontTime","getFontTime","AvgReqLatency","getAvgReqLatency","MaxReqLatency","getMaxReqLatency","FirstPaint","getFirstPaint","FirstContentfulPaint","getFirstContentfulPaint","LargestContentfulPaint","getLargestContentfulPaint","SpeedIndex","getSpeedIndex","loadEventEnd","navigationStart","getPlayerStartupTime","domainLookupEnd","domainLookupStart","connectEnd","connectStart","secureConnectionStart","domComplete","responseStart","firstPaint","max","domContentLoadedEventEnd","_getXTime","count","scripts","requestStart","firstContentfulPaint","validExtensions","initiatorType","valid","duration","contentfulPaint","msFirstPaint","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","preFPS","setPlayerSetupTime","win","doc","GetElementViewportRect","el","intersect","elRect","min","documentElement","clientHeight","clientWidth","area","CheckElement","rect","rects","pageBackgroundWeight","navStart","elements","getElementsByTagName","re","style","getComputedStyle","tagName","src","lastIndex","tm","contentWindow","GetRects","timings","requests","responseEnd","j","GetRectTimings","paintMetrics","k","headURLs","headElements","children","async","rel","href","doneCritical","requestEnd","GetFirstPaint","paints","0","sort","a","b","accumulated","CalculateVisualProgress","lastTime","lastProgress","elapsed","CalculateSpeedIndex","isBlocked","_changeListener","loadReference","_loadListener","pageHeight","maxHeight","getScrollDepth","docEl","scrollHeight","offsetHeight","_updateCompletionRate","prevHeight","pageYOffset","getIsVisible","returnValue","getNonRandomData","timestamp","getTimestamp","getUserAgent","threads","getVirtualCores","getLanguage","langList","getAvailableLanguages","resolution","getResolution","colorDepth","getColorDepth","deviceMemory","getMemory","touchscreen","getTouchscreen","getLocalStorage","getSessionStorage","cookiesAvailable","getCookiesAvailable","flashAvailable","getHasFlash","timeZone","getTimeZone","plugins","getPluginList","_getNavigatorValue","screen","pluginlist","counter","description","filename","getTimezoneOffset","_navigatorCheck","L","K","G","I","H","u","aa","Z","f","D","B","P","E","v","g","Y","X","W","V","C","charCodeAt","String","fromCharCode","J","PluginContentMixin","removeAdapter","contentAdapterListeners","_startListener","_joinListener","_pauseListener","_resumeListener","_seekBufferBeginListener","_seekEndListener","_bufferEndListener","_errorListener","_stopListener","_videoEventListener","_startPings","allParamsReady","_isExtraMetadataReady","_adSavedError","_adSavedManifest","_retryStart","fireBreakStop","_blockError","errorParams","_lastErrorParams","_lastErrorTime","expectedPostrolls","pat","post","breaks","map","isEnded","isStopped","lastQuartileSent","AdapterAdsMixin","getPosition","getGivenBreaks","getExpectedBreaks","getExpectedPattern","getBreaksTime","getGivenAds","getExpectedAds","getAudioEnabled","getIsSkippable","getIsFullscreen","getCampaign","getCreativeId","getProvider","getAdInsertionType","fireClick","fireQuartile","quartile","fireManifest","message","errorType","errorMessage","fireSkip","skipped","fireBreakStart","AdapterContentMixin","getFramesPerSecond","getDroppedFrames","getThroughput","getRendition","getTitle2","getHouseholdId","getLatency","getPacketLoss","getPacketSent","getMetrics","getAudioCodec","getVideoCodec","convertFromBuffer","cancelSeek","PluginGetterMixin","getUserType","getObfuscateIp","getExtraparam1","getExtraparam2","getExtraparam3","getExtraparam4","getExtraparam5","getExtraparam6","getExtraparam7","getExtraparam8","getExtraparam9","getExtraparam10","getExtraparam11","getExtraparam12","getExtraparam13","getExtraparam14","getExtraparam15","getExtraparam16","getExtraparam17","getExtraparam18","getExtraparam19","getExtraparam20","getAdExtraparam1","getAdExtraparam2","getAdExtraparam3","getAdExtraparam4","getAdExtraparam5","getAdExtraparam6","getAdExtraparam7","getAdExtraparam8","getAdExtraparam9","getAdExtraparam10","getPluginInfo","lib","getAdapterVersion","adAdapter","getAdAdapterVersion","getIp","getIsp","getConnectionType","getDeviceInfo","info","getDeviceCode","deviceCode","getModel","model","getBrand","brand","getDeviceType","deviceType","getDeviceName","deviceName","getOsName","osName","getOsVersion","osVersion","getBrowserName","browserName","getBrowserVersion","browserVersion","getBrowserType","browserType","getBrowserEngine","browserEngine","getUsername","getAnonymousUser","getEmail","getReferer","getReferral","referrer","getRequestNumber","getOfflineView","getDeviceUUID","getSmartswitchConfigCode","getSmartswitchGroupCode","getSmartswitchContractCode","getAppName","getAppReleaseVersion","getIsBlocked","PluginContentGetterMixin","_safeGetterAdapter","getWebkitDroppedFrames","webkitDroppedFrameCount","getWebkitBitrate","webkitVideoDecodedByteCount","_lastWebkitBitrate","delta","getParsedResource","getTransactionCode","getMetadata","getCdn","getPluginVersion","getLibVersion","getStreamingProtocol","getVideoMetrics","getJoinDuration","getBufferDuration","getSeekDuration","getPauseDuration","getPackage","getSaga","getTvShow","getSeason","getEpisodeTitle","getChannel","getID","getImdbId","getGracenoteID","getType","getGenre","getVideoLanguage","getSubtitles","getContractedResolution","getCost","getPrice","getPlaybackType","getDRM","getCodecSettings","getCodecProfile","getContainerFormat","getLinkedViewId","functionName","PluginAdsMixin","setAdsAdapter","removeAdsAdapter","adsAdapterListeners","_adStartListener","_adJoinListener","_adPauseListener","_adResumeListener","_adBufferBeginListener","_adBufferEndListener","_adStopListener","_adErrorListener","_adClickListener","_adManifestListener","_adBreakStartListener","_adBreakStopListener","_adQuartileListener","getAdResource","getAdTitle","getAdDuration","adStartSent","_sendAdEventIfAllowed","adInitSent","WILL_SEND_AD_INIT","adConnected","adConnectedTime","_blockAdError","_lastAdErrorParams","getAdCreativeId","_lastAdErrorTime","willSend","PluginAdsGettersMixin","getAdPlayerVersion","_safeGetterAdsAdapter","temporalRet","getAdNumber","getBreakNumber","getAdPlayhead","getAdBitrate","getWebkitAdBitrate","_lastWebkitAdBitrate","getAdCampaign","getAdProvider","getAdMetadata","expBreaks","expPattern","pre","mid","pattern","getAdsExpected","getAdJoinDuration","getAdBufferDuration","getAdPauseDuration","getAdTotalDuration","getAdViewedDuration","_getTimeMaxOrAcum","getAdViewability","acum","maxTime","option","PluginPingMixin","diffTime","PluginFireMixin","fireOfflineEvents","_offlineParams","_generateAndSendOffline","offlineReference","bodyAndId","newViewCode","offlineId","PluginInfinityMixin","_navListener","_sessionStartListener","_sessionStopListener","_eventListener","_sendInfinity","getSessionMetrics","PluginInfinityGettersMixin","setStoredData","setDataTime","setLastActive","last","getPageName","Bitmovin","tech","playingAds","lastPlayhead","getCurrentTime","getPlaybackSpeed","getPlaybackVideoData","playbackValues","isLive","getConfig","sourceObject","dash","hls","progressive","bitmovin","references","ON_ERROR","errorListener","ON_PAUSED","pauseListener","ON_PLAY","playListener","ON_PLAYING","playingListener","ON_PLAYBACK_FINISHED","endedListener","ON_SEEK","seekingListener","ON_SEEKED","seekedListener","ON_SEGMENT_PLAYBACK","joinListener","ON_SOURCE_UNLOADED","ON_STOP_BUFFERING","ON_TIME_CHANGED","joinChangedListener","ON_AD_BREAK_FINISHED","endAdsListener","ON_AD_BREAK_STARTED","startAdsListener","addEventHandler","removeEventHandler","NativeAdsAdapter","ON_AD_CLICKED","clickListener","ON_AD_ERROR","ON_AD_FINISHED","endListener","ON_AD_MANIFEST_LOADED","manifestListener","ON_AD_PLAYBACK_FINISHED","ON_AD_SKIPPED","skipListener","ON_AD_STARTED","clickThroughUrl"],"mappings":"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","file":"sp.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"youbora\"] = factory();\n\telse\n\t\troot[\"youbora\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 36);\n","var Emitter = require('./emitter')\nvar isArray = require('./mixins/isarray')\n\n/**\n * Static Log class for YouboraLib\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar Log = {\n\n  _emitter: new Emitter(),\n\n  /** Exposes {@link youbora.EvenfulObject.on} */\n  on: function () { Log._emitter.on.apply(Log._emitter, arguments) },\n  /** Exposes {@link youbora.EvenfulObject.off} */\n  off: function () { Log._emitter.off.apply(Log._emitter, arguments) },\n  /** Exposes {@link youbora.EvenfulObject.emit} */\n  emit: function () { Log._emitter.emit.apply(Log._emitter, arguments) },\n\n  /**\n   * Enum for log levels\n   * @enum\n   */\n  Level: {\n    /** No console outputs */\n    SILENT: 6,\n    /** Console will show errors */\n    ERROR: 5,\n    /** Console will show warnings */\n    WARNING: 4,\n    /** Console will show notices (ie: life-cyrcle logs) */\n    NOTICE: 3,\n    /** Console will show debug messages (ie: player events) */\n    DEBUG: 2,\n    /** Console will show verbose messages (ie: Http Requests) */\n    VERBOSE: 1\n  },\n\n  /**\n   * Enum for events\n   * @enum\n   */\n  Event: {\n    /** Sent each time a messaged is issued, even if log level does not handle it. */\n    LOG: 'log'\n  },\n\n  /**\n   * Only logs of this imporance or higher will be shown.\n   * @default youbora.Log.Levels.ERROR\n   * @see {@link youbora.Log.Levels}\n   */\n  logLevel: 5,\n\n  /**\n   * If true, console logs will always be outputed without colors (for debbugin in devices).\n   * @default false\n   */\n  plainLogs: false,\n\n  /**\n   * Returns a console message\n   *\n   * @private\n   * @param {(string|error|array)} msg Message string, error object or array of messages.\n   * @param {Log.Levels} [level=Log.Levels.NOTICE] Defines the level of the error sent.\n   * Only errors with higher or equal level than Log.logLevel will be displayed.\n   * @param {string} [color=darkcyan] Color of the header\n   * @see {@link Youbora.Log.debugLevel}\n   */\n  report: function (msg, level, color) {\n    if (typeof console !== 'undefined' && console.log && typeof document !== 'undefined') {\n      level = level || Log.Level.NOTICE\n      color = color || 'darkcyan'\n\n      var letters = {\n        5: 'e', // Error\n        4: 'w', // Warning\n        3: 'n', // Notice\n        2: 'd', // Debug\n        1: 'v' // Verbose\n      }\n\n      var letter = letters[level]\n      var prefix = '[Youbora]' + Log._getCurrentTime() + ' ' + letter + ':'\n\n      this.emit('log', { level: level, msg: msg, prefix: prefix })\n\n      // Show messages in actual console if level is enought\n      if (Log.logLevel <= level) {\n        if (Log.plainLogs || document.documentMode) { // document.documentMode exits only in IE\n          // Plain log for IE and devices\n          Log._plainReport(msg, prefix)\n        } else {\n          // choose log method\n          var logMethod\n          if (level === Log.Level.ERROR && console.error) {\n            logMethod = console.error\n          } else if (level === Log.Level.WARNING && console.warn) {\n            logMethod = console.warn\n          } else if (level === Log.Level.DEBUG && console.debug) {\n            logMethod = console.debug\n          } else {\n            logMethod = console.log\n          }\n\n          // print message\n          prefix = '%c' + prefix\n          if (isArray(msg)) {\n            msg.splice(0, 0, prefix, 'color: ' + color)\n            logMethod.apply(console, msg)\n          } else {\n            logMethod.call(console, prefix, 'color: ' + color, msg)\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Returns the current time in format hh:mm:ss.mmm (with trailing 0s)\n   * @private\n   * @return {string} Current time.\n   */\n  _getCurrentTime: function () {\n    var d = new Date()\n    var hh = ('0' + d.getDate()).slice(-2)\n    var mm = ('0' + d.getMinutes()).slice(-2)\n    var ss = ('0' + d.getSeconds()).slice(-2)\n    var mmm = ('00' + d.getMilliseconds()).slice(-3)\n    return '[' + hh + ':' + mm + ':' + ss + '.' + mmm + ']'\n  },\n\n  /**\n   * Returns a console message without style\n   *\n   * @private\n   * @param {(string|object|array)} msg Message string, object or array of messages.\n   * @param {string} prefix Prefix of the message.\n   */\n  _plainReport: function (msg, prefix) {\n    if (msg instanceof Array) {\n      for (var m in msg) {\n        Log._plainReport(msg[m], prefix)\n      }\n    } else {\n      if (typeof msg === 'string') {\n        console.log(prefix + ' ' + msg)\n      } else {\n        console.log(prefix + ' <next line>')\n        console.log(msg)\n      }\n    }\n  },\n\n  /**\n   * Sends an error (level 1) console log.\n   * Supports unlimited arguments: (\"this\", \"is\", \"a\", \"message\")\n   * @memberof $YB\n   * @see {@link $YB.report}\n   */\n  error: function () {\n    Log.report([].slice.call(arguments), Log.Level.ERROR, 'darkred')\n  },\n\n  /**\n   * Sends a warning (level 2) console log.\n   * Supports unlimited arguments: (\"this\", \"is\", \"a\", \"message\")\n   * @memberof $YB\n   * @see {@link $YB.report}\n   */\n  warn: function () {\n    Log.report([].slice.call(arguments), Log.Level.WARNING, 'darkorange')\n  },\n\n  /**\n   * Sends a notice (level 3) console log.\n   * Supports unlimited arguments: (\"this\", \"is\", \"a\", \"message\")\n   * @memberof $YB\n   * @see {@link $YB.report}\n   */\n  notice: function () {\n    Log.report([].slice.call(arguments), Log.Level.NOTICE, 'darkgreen')\n  },\n\n  /**\n   * Sends a debug message (level 4) to console.\n   * Supports unlimited arguments: (\"this\", \"is\", \"a\", \"message\")\n   * @memberof $YB\n   * @see {@link $YB.report}\n   */\n  debug: function () {\n    Log.report([].slice.call(arguments), Log.Level.DEBUG, 'indigo')\n  },\n\n  /**\n   * Sends a verbose message (level 5) to console.\n   * Supports unlimited arguments: (\"this\", \"is\", \"a\", \"message\")\n   * @memberof $YB\n   * @see {@link $YB.report}\n   */\n  verbose: function () {\n    Log.report([].slice.call(arguments), Log.Level.VERBOSE, 'navy')\n  },\n\n  /**\n   * This function is automatically executed at youboralib's init.\n   * Will search inside window.location.search for attribute 'youbora-debug=X'.\n   * X can have one of these values, that will modify LogLevel.\n   * 6: SILENT,\n   * 5: ERROR,\n   * 4: WARNING,\n   * 3: NOTICE,\n   * 2: DEBUG,\n   * 1: VERBOSE\n   *\n   * If youbora-console=plain is present, plainLogs will be set to true.\n   */\n  loadLevelFromUrl: function () {\n    if (typeof window !== 'undefined' && window.location) {\n      this._parseLevelFromUrl(window.location.search)\n    }\n  },\n\n  _parseLevelFromUrl: function (url) {\n    if (url) {\n      var m = /\\?.*&*youbora-debug=(.+)/i.exec(url)\n      if (m !== null) {\n        Log.logLevel = m[1]\n      }\n\n      var m2 = /\\?.*&*youbora-debug=plain/i.exec(url)\n      if (m2 !== null) {\n        Log.plainLogs = true\n      }\n    }\n  }\n}\n\nmodule.exports = Log\n","var assign = require('./mixins/assign')\nvar createObject = require('./mixins/create')\n\nvar YouboraObject = function () { }\n\nYouboraObject.prototype = {\n  /**\n   * A base class that other Classes should inherit from.\n   * It has a no-op constructor intended to be overridden by classes that extend from this.\n   *\n   * @constructs YouboraObject\n   * @abstract\n   * @memberof youbora\n   */\n  constructor: function () { }\n}\n\n/**\n * This method allows the extension of the current class, emulating 1-level inheritance.\n * It is inspired by Backbone's extend, but removing all references to underscore.\n *\n * @see http://backbonejs.org/#Model-extend\n *\n * @example\n * var A = YouboraObject.extend({ a: 1, b: 1, c: { d: 0 } });\n * var a = new A(); // { a: 1, b: 1, c: { d: 0 } }\n *\n * var B = A.extend({ b: 2, c: { e: 3 } });\n * var b = new B(); // { a: 1, b: 2, c: { e: 3 } }\n *\n * @param  {Object} protoProps  Prototype properties (available on the instances)\n * @param  {Object} staticProps Static properties (available on the contructor)\n * @return {Object}             New sub class\n */\nYouboraObject.extend = function (protoProps, staticProps) {\n  var parent = this\n  var child\n\n  // The constructor function for the new subclass is either defined by you\n  // (the \"constructor\" property in your `extend` definition), or defaulted\n  // by us to simply call the parent constructor.\n  if (protoProps && protoProps.hasOwnProperty('constructor')) { // eslint-disable-line no-prototype-builtins\n    child = protoProps.constructor\n  } else {\n    child = function () { return parent.apply(this, arguments) }\n  }\n\n  // Add static properties to the constructor function, if supplied.\n  assign(child, parent, staticProps)\n\n  // Set the prototype chain to inherit from `parent`, without calling\n  // `parent`'s constructor function and add the prototype properties.\n  child.prototype = createObject(parent.prototype)\n  if (protoProps) assign(child.prototype, protoProps)\n  child.prototype.constructor = child\n\n  // Set a convenience property in case the parent's prototype is needed\n  // later.\n  child.__super__ = parent.prototype\n  return child\n}\n\nmodule.exports = YouboraObject\n","var Log = require('./log')\n\n/**\n * This static class provides utility methods.\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar Util = {\n  /**\n     * Strip {protocol}:// and // from the begining of the string.\n     *\n     * @param {string} url\n     * @returns {string} stripped url\n     */\n  stripProtocol: function (url) {\n    var strippedUrl = url\n    try {\n      strippedUrl = url.replace(/^(.*?:\\/\\/|\\/\\/)/i, '')\n    } catch (err) {\n      Log.warn(err)\n    }\n    return strippedUrl\n  },\n\n  /**\n     * Adds specific protocol. ie: [http://]nqs.nice264.com\n     *\n     * @param {string} url Domain of the service. Without protocol. ie: 'nqs.nice264.com'.\n     * @param {boolean|null} [httpSecure]\n     * If true will add https, if false http.\n     * Otherwise will add //\n     * @return Return the complete service URL.\n     */\n  addProtocol: function (url, httpSecure) {\n    var serviceUrl = 'http://localhost/'\n    try {\n      serviceUrl = 'http://' + url\n      if (httpSecure || (typeof window !== 'undefined' && window.location.protocol.indexOf('https') === 0)) {\n        serviceUrl = 'https://' + url\n      } else if (typeof window !== 'undefined' && window.location.protocol.indexOf('http') === 0) {\n        serviceUrl = '//' + url\n      }\n    } catch (err) {\n      Log.warn(err)\n    }\n    return serviceUrl\n  },\n\n  /**\n     * Return n if it isn't NaN, negative, Infinity, null or undefined.\n     * In any other case, return def.\n     *\n     * @param {mixed} n Number to be parsed.\n     * @param {number} def Number to return if n is not correct.\n     */\n  parseNumber: function (n, def) {\n    return (!isNaN(n) &&\n      n >= 0 &&\n      n !== Infinity &&\n      n !== -Infinity &&\n      n !== null &&\n      typeof n !== 'undefined')\n      ? n\n      : def\n  },\n\n  /**\n     * This utility method will add most of the HTML5 common event listeners to the player sent.\n     * This common events will be listened: 'canplay', 'buffering', 'waiting', 'ended', 'play',\n     * 'playing', 'pause', 'resume', 'error', 'abort', 'seek', 'seeking', 'seeked', 'stalled',\n     * 'dispose', 'loadeddata', 'loadstart'.\n     *\n     * Events will be reported as DEBUG level messages.\n     *\n     * @param {object|function} o Object to attach the events.\n     * @param {array} [extraEvents]\n     * An array of extra events to watch. ie:  ['timeupdate', 'progress'].\n     * If the first item is null, no common events will be added.\n     * @param {function} [report] Callback function called to report events.\n     * Default calls Log.debug()\n     */\n  logAllEvents: function (o, extraEvents, report) {\n    try {\n      if (Log.logLevel <= Log.Level.DEBUG) {\n        report = report || function (e) {\n          Log.debug('Event: ' + e.type)\n        }\n\n        var playerEvents = [\n          'canplay', 'buffering', 'waiting', 'ended', 'play', 'playing',\n          'pause', 'resume', 'error', 'abort', 'seek', 'seeking', 'seeked',\n          'stalled', 'dispose', 'loadeddata', 'loadstart'\n        ]\n        if (extraEvents) {\n          if (extraEvents[0] === null) {\n            extraEvents.shift()\n            playerEvents = extraEvents\n          } else {\n            playerEvents = playerEvents.concat(extraEvents)\n          }\n        }\n\n        for (var i = 0; i < playerEvents.length; i++) {\n          if (typeof o === 'function') {\n            o.call(window, playerEvents[i], report)\n          } else if (o.on) {\n            o.on(playerEvents[i], report)\n          } else if (o.addEventListener) {\n            o.addEventListener(playerEvents[i], report)\n          }\n        }\n      }\n    } catch (err) {\n      Log.error(err)\n    }\n  },\n\n  /**\n     * Builds a string that represents the rendition.\n     *\n     * The returned string will have the following format: <width>x<height>@bitrate<suffix?>.\n     * If either the width or height are < 1, only the bitrate will be returned.\n     * If bitrate is < 1, only the dimensions will be returned.\n     * If bitrate is < and there is no dimensions, a null will be returned.\n     * The bitrate will also have one of the following suffixes dependin on its\n     * magnitude: bps, Kbps, Mbps\n     *\n     * @param {any} width The width of the asset. If only 1 argument is sent, it will be treated\n     * as bitrate.\n     * @param {any} height The height of the asset.\n     * @param {any} bitrate The indicated bitrate (in the manifest) of the asset.\n     * @returns {string} A string with the following format: <width>x<height>@<bitrate><suffix>\n     */\n  buildRenditionString: function (width, height, bitrate) {\n    if (arguments.length === 1) {\n      bitrate = width\n      width = null\n      height = null\n    }\n\n    var ret = null\n    if (width && height) {\n      ret = width + 'x' + height\n    }\n\n    if (typeof bitrate === 'number' && !isNaN(bitrate) && bitrate >= 1) {\n      if (ret) {\n        ret += '@'\n      } else {\n        ret = ''\n      }\n\n      if (bitrate < 1e3) {\n        ret += Math.round(bitrate) + 'bps'\n      } else if (bitrate < 1e6) {\n        bitrate = Math.round(bitrate / 1e3)\n        ret += bitrate + 'Kbps'\n      } else {\n        bitrate = Math.round(bitrate / 1e4) / 1e2\n        ret += bitrate + 'Mbps'\n      }\n    }\n    return ret\n  },\n\n  /**\n     * Returns a params dictionary with the error values.\n     *\n     * @param {String|Object} [code] Error Code, if an object is sent, it will be treated as params.\n     * @param {String} [msg] Error Message\n     * @param {Object} [metadata] Object defining error metadata\n     * @param {String} [level] Level of the error. Currently supports 'error' and 'fatal'\n     * @returns {Object} Key:value params.\n     */\n  buildErrorParams: function (code, msg, metadata, level) {\n    var params = {}\n    if (typeof code === 'object' && code !== null) {\n      params = code\n    } else {\n      params.errorCode = code || 'FAILURE'\n      params.msg = msg || params.errorCode\n      params.errorMetadata = metadata\n      params.errorLevel = level\n    }\n    return params\n  },\n\n  /**\n     * Returns a boolean indicating if more than the desired % of pixels are on screen.\n     *\n     * @param {Object} [player] Player object\n     * @param {Number} [screenPercent] Threshold % of pixels on screen to return true.\n     * @returns {Boolean} Its on screen or not.\n     */\n  calculateAdViewability: function (player, screenPercent) {\n    var isVisible = true\n    if (typeof window !== 'undefined' && player && typeof player.getBoundingClientRect === 'function') {\n      var box = player.getBoundingClientRect()\n      // 100% outside the window cases\n      if (box.top >= window.innerHeight || box.bottom <= 0 ||\n        box.right <= 0 || box.left >= window.innerWidth) {\n        isVisible = false\n      } else {\n        var pixels = Math.trunc(box.height * box.width)\n        var x1 = box.top > 0 ? box.top : 0\n        var x2 = box.bottom > window.innerHeight ? window.innerHeight : box.bottom\n        var y1 = box.left > 0 ? box.left : 0\n        var y2 = box.right > window.innerWidth ? window.innerWidth : box.right\n        var inScreenPixels = (y2 - y1) * (x2 - x1)\n        // more than screenPercent of pixels (by default 50%)\n        isVisible = inScreenPixels * 100 > pixels * (screenPercent || 50)\n      }\n    }\n    return isVisible\n  },\n\n  getMetricsFrom: function (op1, op2) {\n    var metrics = op1 || op2\n    for (var metric in metrics) {\n      if (typeof metrics[metric] !== 'object' || !metrics[metric].value) {\n        var temporal = {}\n        // temporal.oper = 'SUM' //default one?\n        temporal.value = metrics[metric]\n        metrics[metric] = temporal\n      }\n    }\n    return metrics\n  },\n\n  // The following methods replace core js functionallity to ensure compatibility in old versions.\n  assign: require('./mixins/assign'),\n  isArray: require('./mixins/isarray')\n}\n\nmodule.exports = Util\n","var AdPosition = require('./constants/adPosition')\nvar Adapter = require('./constants/adapter')\nvar ManifestError = require('./constants/manifestError')\nvar Service = require('./constants/service')\nvar WillSendEvent = require('./constants/willSendEvent')\nvar AdInsertionType = require('./constants/adInsertionType')\n/**\n * This static class englobes youbora constants.\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar Constants = {\n  AdPosition: AdPosition,\n  ManifestError: ManifestError,\n  Service: Service,\n  WillSendEvent: WillSendEvent,\n  AdInsertionType: AdInsertionType,\n  Adapter: Adapter\n}\n\nmodule.exports = Constants\n","/* global  atv, XMLHttpRequest, ActiveXObject */\nvar YouboraObject = require('../object')\nvar Log = require('../log')\nvar Util = require('../util')\n\nvar YBRequest = YouboraObject.extend(\n  /** @lends youbora.YBRequest.prototype */\n  {\n    /**\n     * YBYBRequest class will wrap XmlHttpRequest and extend its functionality, allowing youbora\n     * to manage queues, blockers and retries.\n     *\n     * @constructs YBRequest\n     * @extends youbora.Object\n     * @memberof youbora\n     *\n     * @param {string} host URL of the request. ie: a-fds.youborafds01.com\n     * @param {string} [service] Name of the service. ie '/start'\n     * @param {Object} [params] Object of key:value params.\n     * @param {Object} [options] Object with custom options.\n     * @param {string} [options.method=\"GET\"] Specifies the method of the request. ie: \"GET\", \"HEAD\".\n     * @param {string} [options.requestHeaders] Object with options of requestHeaders.\n     * ie: { header: value }.\n     * @param {number} [options.retryAfter=5000] Time in ms before sending a failed request again.\n     * 0 to disable.\n     * @param {number} [options.maxRetries=3] Max number of retries. 0 to disable.\n     * @param {bool} [options.cache=false] If false, timestamp will be added to each request to\n     * prevent caching.\n     */\n    constructor: function (host, service, params, options) {\n      /** Instance of XmlHttpRequest (or the item returned by createXHR method). */\n      this.xhr = this.createXHR()\n\n      /** Host of the request */\n      this.host = host || ''\n\n      /** Service of the request */\n      this.service = service || ''\n\n      /** Object of params of the request */\n      this.params = params || {}\n\n      /** Options of the current request */\n      this.options = Util.assign({}, YBRequest.defaultOptions, options)\n\n      /** Number of times this request has failed and retried. */\n      this.retries = 0\n\n      // Add timemark\n      if (!this.options.cache) {\n        this.setParam('timemark', new Date().getTime())\n      }\n    },\n\n    /**\n     * Creates XMLHttpRequest if it is available in the browser.\n     * If not, it tries to create an ActiveXObject XMLHTTP item.\n     * Override this function for custom environments.\n     *\n     * @return YBRequest handler.\n     */\n    createXHR: function () {\n      var xhr = {}\n      try {\n        if (XMLHttpRequest) {\n          xhr = new XMLHttpRequest()\n        } else {\n          xhr = new ActiveXObject('Microsoft.XMLHTTP')\n        }\n      } catch (err) {\n        Log.error(err)\n      }\n      return xhr\n    },\n\n    /**\n     * Returns xhr object.\n     *\n     * @return {XmlHttpRequest} object.\n     */\n    getXHR: function () {\n      return this.xhr\n    },\n\n    getResponse: function () {\n      return this.xhr.response\n    },\n\n    getResponseText: function () {\n      return this.xhr.responseText\n    },\n\n    getResponseHeaders: function () {\n      return this.xhr.getAllResponseHeaders()\n    },\n\n    /** Returns the complete formed url of the request url+service+params. */\n    getUrl: function () {\n      return this.host + this.service + this.getParamString()\n    },\n\n    /**\n     * Wraps this.getHXR.addEventListener.\n     * Accepts a callback that receives (this YBRequest, event)\n     */\n    on: function (event, callback, callbackParams) {\n      if (this.xhr.addEventListener) {\n        this.xhr.addEventListener(event, callback.bind(this, this, callbackParams))\n      } else {\n        if (event === YBRequest.Event.SUCCESS) {\n          this.xhr.onreadystatechange = function () {\n            if (this.xhr.readyState === 4) {\n              callback.bind(this, this, callbackParams)\n            }\n          }.bind(this)\n        }\n      }\n      return this\n    },\n\n    /** Wraps this.getHXR.removeEventListener */\n    off: function (event, callback) {\n      this.xhr.removeEventListener(event, callback)\n      return this\n    },\n\n    /**\n     * Returns the params of the request, stringified.\n     * ie: '?pluginVersion=5.1.0&systemCode=nicetv'.\n     * @return {string} Concatenated Params\n     */\n    getParamString: function () {\n      try {\n        var params = '?'\n        for (var key in this.params) {\n          var param = this.params[key]\n          if (param !== null && typeof param === 'object') {\n            var string = JSON.stringify(param)\n            if (string !== '{}') {\n              params += encodeURIComponent(key) + '=' + encodeURIComponent(string) + '&'\n            }\n          } else if (param !== null && typeof param !== 'undefined' && param !== '') {\n            params += encodeURIComponent(key) + '=' + encodeURIComponent(param) + '&'\n          }\n        }\n        return params.slice(0, -1)\n      } catch (err) {\n        Log.error(err)\n        return ''\n      }\n    },\n\n    /**\n     * Returns the value of the given param, or undefined.\n     * @param {string} key Name of the param.\n     * @return {any}\n     */\n    getParam: function (key) {\n      return this.params[key]\n    },\n\n    /**\n     * Add or set a parameter for the request.\n     * ie: if you want to add 'username=user' use setParam('username', 'user').\n     * @param {string} key Name of the param.\n     * @param {string} value Name of the param.\n     * @return this\n     */\n    setParam: function (key, value) {\n      this.params[key] = value\n      return this\n    },\n\n    setBody: function (body) {\n      this.body = body\n    },\n\n    /**\n     * Sends the request.\n     *\n     * @return returns xhr.send()\n     */\n    send: function () {\n      try {\n        this.xhr.open(this.options.method, this.getUrl(), true)\n\n        // Add custom headers\n        if (this.options.requestHeaders) {\n          for (var key in this.options.requestHeaders) {\n            if (this.options.requestHeaders.hasOwnProperty(key)) { // eslint-disable-line no-prototype-builtins\n              this.xhr.setRequestHeader(key, this.options.requestHeaders[key])\n            }\n          }\n        }\n\n        // Add retries system\n        if (this.options.retryAfter > 0 && this.options.maxRetries > 0) {\n          var genericError = function () {\n            if (this.retries >= this.options.maxRetries) {\n              Log.error('Aborting failed request \"' + this.service + '\". Max retries reached.')\n            } else {\n              Log.warn('YBRequest \"' + this.service + '\" failed. Retry ' + (this.retries + 1) + ' of ' +\n                this.options.maxRetries + ' in ' + this.options.retryAfter + 'ms.')\n              try {\n                setTimeout(function () {\n                  this.retries += 1\n                  this.send()\n                }.bind(this), this.options.retryAfter)\n              } catch (err) {\n                if (typeof atv !== 'undefined') {\n                  atv.setTimeout(function () {\n                    this.retries += 1\n                    this.send()\n                  }.bind(this), this.options.retryAfter)\n                } else {\n                  Log.error(err)\n                }\n              }\n            }\n          }\n          if (this.retries === 0) {\n            this.on(YBRequest.Event.ERROR, genericError.bind(this))\n          }\n        }\n\n        // Log XHR\n        if (Log.logLevel <= Log.Level.VERBOSE) {\n          Log.verbose('XHR Req: ' + this.getUrl())\n        }\n\n        // Register 'on every' listeners\n        for (var event in YBRequest._globalListeners) {\n          YBRequest._globalListeners[event].forEach(function (callback) {\n            this.on(event, callback)\n          }.bind(this))\n        }\n\n        // Send\n        return this.xhr.send(this.body)\n      } catch (err) {\n        Log.error(err)\n      }\n    }\n  },\n\n  /** @lends youbora.YBRequest */\n  {\n    /**\n     * List of events that could be fired from XHR\n     * @enum\n     */\n    Event: {\n      /** Request successful */\n      SUCCESS: 'load',\n      /** Request successful */\n      LOAD: 'load', // Native JS\n      /** Request returned error */\n      ERROR: 'error',\n      /** Request aborted */\n      ABORT: 'abort'\n    },\n\n    /**\n     * This static property includes the default values for the options. In case you do not define\n     * one of them in the constructor, these values will be used instead.\n     *\n     * @param {string} [defaultOptions.method=\"GET\"] Specifies the method of the request.\n     * ie: \"GET\", \"HEAD\".\n     * @param {string} [defaultOptions.requestHeaders] Object with options of requestHeaders.\n     * ie: { header: value }.\n     * @param {number} [defaultOptions.retryAfter=5000] Time in ms before sending a failed request\n     * again. 0 to disable.\n     * @param {number} [defaultOptions.maxRetries=3] Max number of retries. 0 to disable.\n     * @param {bool} [defaultOptions.cache=false] If false, timemark will be added to each request\n     * to prevent caching.\n     */\n    defaultOptions: {\n      method: 'GET',\n      requestHeaders: {},\n      maxRetries: 3,\n      retryAfter: 5000,\n      cache: false\n    },\n\n    /** @private */\n    _globalListeners: {},\n\n    /**\n     * Adds a callback to every instance.\n     * @param {string} event Name of the event.\n     * @param {function} callback Callback of the event.\n     */\n    onEvery: function (event, callback) {\n      YBRequest._globalListeners[event] = YBRequest._globalListeners[event] || []\n      YBRequest._globalListeners[event].push(callback)\n    },\n\n    /**\n     * Removes a global callback\n     * @param {string} event Name of the event.\n     * @param {function} callback Callback of the event.\n     */\n    offEvery: function (event, callback) {\n      if (YBRequest._globalListeners[event]) {\n        var index = YBRequest._globalListeners[event].indexOf(callback)\n        if (index !== -1) {\n          YBRequest._globalListeners[event].splice(index, 1)\n        }\n      }\n    }\n  })\n\nmodule.exports = YBRequest\n","var YouboraObject = require('./object')\nvar isArray = require('./mixins/isarray')\n\n/**\n * This class extends YouboraObject, adding event emitting/listening functionalities.\n *\n * @constructs Emitter\n * @extends youbora.YouboraObject\n * @memberof youbora\n */\nvar Emitter = YouboraObject.extend(\n  /** @lends youbora.Emitter.prototype */\n  {\n    /**\n     * Sets a listener to a given event. Use {@link emit} to trigger those events.\n     * Pass '*' to listen ALL events.\n     *\n     * @param {string} event Name of the event.\n     * @param {function} callback Callback of the event. Receives event and data.\n     * @return this\n     */\n    on: function (event, callback) {\n      this._listeners = this._listeners || {}\n      if (typeof callback === 'function') {\n        this._listeners[event] = this._listeners[event] || []\n        this._listeners[event].push(callback)\n        return this\n      }\n    },\n\n    /**\n     * Removes given callback from the listeners of this object.\n     *\n     * @param {string} event Name of the event.\n     * @param {function} callback Callback of the event.\n     * @return this\n     */\n    off: function (event, callback) {\n      this._listeners = this._listeners || {}\n\n      if (this._listeners[event]) {\n        var index = this._listeners[event].indexOf(callback)\n        if (index !== -1) {\n          this._listeners[event].splice(index, 1)\n        }\n      }\n      return this\n    },\n\n    /**\n     * Emits given event, triggering all the associated callbacks.\n     *\n     * @param {string} event Name of the event.\n     * @param {object} [data] Custom data to be sent to the callbacks.\n     * @return this\n     */\n    emit: function (event, data) {\n      this._listeners = this._listeners || {}\n      data = data || {}\n\n      if (isArray(this._listeners[event])) {\n        this._listeners[event].forEach(this._eachCallback.bind(this, event, data))\n      }\n      if (isArray(this._listeners['*'])) {\n        this._listeners['*'].forEach(this._eachCallback.bind(this, event, data))\n      }\n      return this\n    },\n\n    /**\n     * Travels through the listener list and executes them them.\n     *\n     * @private\n     */\n    _eachCallback: function (event, data, callback) {\n      if (typeof callback === 'function') {\n        var callbackArguments = {\n          type: event,\n          data: data,\n          target: this\n        }\n        callback(callbackArguments)\n      }\n    }\n  }\n)\n\nmodule.exports = Emitter\n","var Emitter = require('../../emitter')\n\nvar Transform = Emitter.extend(\n  /** @lends youbora.Transform.prototype */\n  {\n    /**\n     * Transform classes in YOUBORA help the library parse and work with data.\n     *\n     * A Transform makes some kind of task that may block requests until it's done, or applies changes\n     * to the requests right before they're finally sent.\n     *\n     * {@link ResourceTransform}, {@link ViewTransform}... all extend from this class.\n     *\n     * @constructs Transform\n     * @extends youbora.Emitter\n     * @memberof youbora\n     * @abstract\n     */\n    constructor: function () {\n      /**\n       * Whether the Transform is currently working or not.\n       * @private\n       */\n      this._isBusy = true\n      this._sendRequest = true\n      this.transformName = 'Transform'\n    },\n\n    /**\n     * Override this method to transform info.\n     *\n     * @param {YBRequest} request Request to transform.\n     */\n    parse: function (request) { },\n\n    /**\n     * By default this will return true until {@link #done()} is called. This can be overridden\n     * in order to block {@link Request}s based on any criteria. For instance its\n     * {@link Request#getService()}.\n     *\n     * @param {YBRequest} request Request to transform.\n     * @return {bool} True if queue shall be blocked.\n     */\n    isBlocking: function (request) {\n      return this._isBusy\n    },\n\n    /**\n     * Emits DONE event\n     */\n    done: function () {\n      this._isBusy = false\n      this.emit(Transform.Event.DONE)\n    },\n\n    // offline\n    hasToSend: function (request) {\n      return this._sendRequest\n    },\n\n    getState: function () {\n      if (!this._sendRequest) {\n        return this.STATE_OFFLINE\n      }\n      if (this._isBusy) {\n        return this.STATE_BLOCKED\n      }\n      return this.STATE_NO_BLOCKED\n    }\n\n  },\n\n  /** @lends youbora.Transform */\n  {\n    // Static members\n\n    STATE_OFFLINE: 2,\n    STATE_BLOCKED: 1,\n    STATE_NO_BLOCKED: 0,\n    /**\n     * List of events that could be fired from this class.\n     * @enum\n     */\n    Event: {\n      /** Notifies that this Transform is done processing. */\n      DONE: 'done'\n    }\n  }\n)\n\nmodule.exports = Transform\n","var YouboraObject = require('./object')\n\nvar Chrono = YouboraObject.extend(\n  /** @lends youbora.Chrono.prototype */\n  {\n    /**\n     * This class calculates time lapses between two points in time.\n     *\n     * @constructs Chrono\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     */\n    constructor: function () {\n      this.reset()\n    },\n\n    /** Reset chrono values. */\n    reset: function () {\n      /** Start time */\n      this.startTime = 0\n\n      /** Stop time */\n      this.stopTime = 0\n\n      /** Pause time */\n      this.pauseTime = 0\n\n      /** Offset to be added to deltaTime and stop. in ms. */\n      this.offset = 0\n    },\n\n    /**\n     * Returns the time between start() and the last stop() in ms. Returns -1 if start wasn't\n     * called.\n     * @param {boolean} [stop=true] If true, it will force a stop() if it wasn't called before.\n     * @return {number} Time lapse in ms.\n     */\n    getDeltaTime: function (stop) {\n      var retValue = -1\n      var now = new Date().getTime()\n      if (this.startTime) {\n        if (stop && !this.stopTime) {\n          this.stopTime = now\n        }\n        var tempOffset = this.pauseTime ? now - this.pauseTime : 0\n        var tempStop = this.stopTime ? this.stopTime : now\n        retValue = (this.offset - tempOffset) + (tempStop - this.startTime)\n      }\n      return retValue\n    },\n\n    /**\n     * Starts the chrono.\n     */\n    start: function () {\n      this.startTime = new Date().getTime()\n      this.stopTime = 0\n      this.offset = 0\n    },\n\n    /**\n     * Stops the timer and returns current delta time.\n     * @return {number} Returns the delta time\n     */\n    stop: function () {\n      if (this.pauseTime) this.resume()\n      this.stopTime = new Date().getTime()\n      return this.startTime ? this.offset + (this.stopTime - this.startTime) : -1\n    },\n\n    pause: function () {\n      this.pauseTime = new Date().getTime()\n    },\n\n    resume: function () {\n      this.offset -= (new Date().getTime() - this.pauseTime)\n      this.pauseTime = 0\n    },\n\n    /**\n     * Creates a copy of the chrono.\n     */\n    clone: function () {\n      var chrono = new Chrono()\n      chrono.startTime = this.startTime\n      chrono.stopTime = this.stopTime\n      chrono.offset = this.offset\n      return chrono\n    }\n  }\n)\n\nmodule.exports = Chrono\n","module.exports = require('../manifest.json').version\n","var Event = require('./event')\n\nvar Adapter = {\n  Event: Event\n}\nmodule.exports = Adapter\n","var Emitter = require('../../../../emitter')\n\nvar Parser = Emitter.extend(\n  /** @lends youbora.Parser.prototype */\n  {\n    /**\n     * Class that asynchronously parses a resource in order to get to the URL.\n     *\n     * Since the CDN detection is performed with the resource url, it is essential that this\n     * resource url is pointing to the CDN that is actually hosting the manifest.\n     *\n     * @constructs Parser\n     * @extends youbora.Emitter\n     * @memberof youbora\n     */\n    constructor: function () {\n      this._realResource = null\n      this._lastManifest = null\n      this._transportFormat = null\n      this.iterations = 3\n    },\n\n    /**\n     * Emits DONE event\n     */\n    done: function () {\n      this.iterations = 3\n      this.emit(Parser.Event.DONE)\n    },\n\n    /**\n     * Starts the parsing from the given resource.\n     *\n     * @param {string} resource The resource url.\n     * @param {object} lastManifest The manifest request response if parsed previously.\n     */\n    parse: function (resource, lastManifest) { },\n\n    /**\n     * Get the parsed resource. Will be null/undefined if parsing is not yet started and can be a partial\n     * (an intermediate manifest) result if the parser is still running.\n     *\n     * @return {string} The parsed resource.\n     */\n    getResource: function () {\n      return this._realResource\n    },\n\n    /**\n     * Get the transport format. Will be null/undefined if parsing is not yet started or is still running.\n     *\n     * @return {string} The parsed resource.\n     */\n    getTransportFormat: function () {\n      return this._transportFormat\n    },\n\n    /**\n     * Get the last request manifest response object used to parse the resource.\n     * Will be null/undefined if parsing is not yet started and can be a partial\n     * (an intermediate manifest) result if the parser is still running.\n     *\n     * @return {object} The last manifest request response used to parse the resource.\n     */\n    getLastManifest: function () {\n      return this._lastManifest\n    },\n\n    /**\n     * Get the result of checking a previous manifest to detect if the parser should be used or not.\n     *\n     * @param {string} resource The resource url.\n     * @return {object} The last manifest request response used to parse the resource.\n     */\n    shouldExecute: function (lastManifest) {\n      return true\n    }\n  },\n\n  /** @lends youbora.Parser */\n  {\n    // Static members\n\n    /**\n     * List of events that could be fired from this class.\n     * @enum\n     */\n    Event: {\n      /** Notifies that this DashParser is done processing. */\n      DONE: 'done'\n    }\n  }\n)\n\nmodule.exports = Parser\n","/**\n * List of transport formats\n *   - TS (MPEG-2 TS)\n *   - MP4 (Fragmented MP4)\n *   - CMF\n */\nvar TransportFormat = {\n  MP4: 'MP4',\n  MPEG2: 'TS',\n  CMF: 'CMF'\n}\nmodule.exports = TransportFormat\n","// No-Conflict\nvar previousYoubora = youbora // eslint-disable-line no-use-before-define\nvar youbora = {}\n\n/**\n * This allows you to run multiple instances of YouboraLib on the same webapp.\n * After loading the new version, call `noConflict()` to get a reference to it.\n * At the same time the old version will be returned to Youbora.\n */\nyoubora.noConflict = function () {\n  youbora = previousYoubora\n  return this\n}\n\n// Info\nyoubora.VERSION = require('./version')\n\n// Polyfills\nyoubora.polyfills = require('./polyfills')\nyoubora.polyfills()\n\n// Base Classes\nyoubora.Object = require('./object')\nyoubora.Emitter = require('./emitter')\n\n// Log\nyoubora.Log = require('./log')\nyoubora.Log.loadLevelFromUrl()\n\n// General classes\nyoubora.Util = require('./util')\nyoubora.HybridNetwork = require('./monitors/hybridnetwork')\nyoubora.Chrono = require('./chrono')\nyoubora.Timer = require('./timer')\nyoubora.Constants = require('./constants')\n\n// Comm classes\nyoubora.Request = require('./comm/request')\nyoubora.Communication = require('./comm/communication')\n\n// Resource Transform classes\nyoubora.Transform = require('./comm/transform/transform')\nyoubora.ViewTransform = require('./comm/transform/view')\nyoubora.ResourceTransform = require('./comm/transform/resource')\nyoubora.CdnParser = require('./comm/transform/resourceparsers/cdnparser')\nyoubora.HlsParser = require('./comm/transform/resourceparsers/formatparsers/hlsparser')\nyoubora.DashParser = require('./comm/transform/resourceparsers/formatparsers/dashparser')\nyoubora.OfflineParser = require('./comm/transform/offline')\nyoubora.LocationheaderParser = require('./comm/transform/resourceparsers/formatparsers/locationheaderparser')\n\n// Plugin Classes\nyoubora.Options = require('./plugin/options')\nyoubora.Plugin = require('./plugin/plugin')\nyoubora.Storage = require('./plugin/storage')\nyoubora.RequestBuilder = require('./plugin/requestbuilder')\n\n// Adapters\nyoubora.PlayheadMonitor = require('./adapter/playheadmonitor')\nyoubora.Adapter = require('./adapter/adapter')\nyoubora.adapters = {}\n\n// Infinity\nyoubora.Infinity = require('./infinity/infinity')\n\n// Detector classes\nyoubora.BackgroundDetector = require('./detectors/backgroundDetector')\nyoubora.DeviceDetector = require('./detectors/deviceDetector')\nyoubora.UUIDGenerator = require('./deviceUUID/hashgenerator')\n\n/**\n * Register the given adapter in <youbora>.adapters.\n *\n * @param {string} key Unique adapter identifier.\n * @param {youbora.Adapter} Adapter Adapter class.\n *\n * @memberof youbora\n */\nyoubora.registerAdapter = function (key, Adapter) {\n  this.adapters[key] = Adapter\n}.bind(youbora)\n\n/**\n * Remove the given adapter in <youbora>.adapters.\n *\n * @param {string} key Unique adapter identifier.\n *\n * @memberof youbora\n */\nyoubora.unregisterAdapter = function (key) {\n  this.adapters[key] = null\n}.bind(youbora)\n\nmodule.exports = youbora\n","/**\n * See Array.isArray.\n * @memberof youbora.Util\n */\nmodule.exports = function (obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]'\n}\n","/* global atv */\nvar YouboraObject = require('./object')\nvar Chrono = require('./chrono')\n\nvar Timer = YouboraObject.extend(\n  /** @lends youbora.Timer.prototype */\n  {\n    /**\n     * An Utility class that provides timed events in a defined time interval.\n     *\n     * @param {function} callback The callback to call every due interval.\n     * Callback will receive lapsed ms between calls.\n     * @param {int} [interval=5000] Milliseconds between each call.\n     *\n     * @constructs Timer\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     */\n    constructor: function (callback, interval) {\n      this.callback = callback\n      this.interval = interval || 5000\n      this.isRunning = false\n      this._timer = null\n\n      this.chrono = new Chrono()\n    },\n\n    /**\n     * Starts the timer.\n     */\n    start: function () {\n      if (!this.isRunning) {\n        this.isRunning = true\n        this._setTick()\n      }\n    },\n\n    /**\n     * Stops the timer.\n     */\n    stop: function () {\n      this.isRunning = false\n      if (this._timer) {\n        try {\n          clearTimeout(this._timer)\n        } catch (err) {\n          if (typeof atv !== 'undefined') {\n            atv.clearTimeout(this._timer)\n          }\n        }\n      }\n    },\n\n    /**\n     * Sets the next tick execution.\n     * @private\n     */\n    _setTick: function () {\n      this.chrono.start()\n      try {\n        this._timer = setTimeout(function () {\n          this.callback(this.chrono.stop())\n          this._setTick()\n        }.bind(this), this.interval)\n      } catch (err) {\n        if (typeof atv !== 'undefined') {\n          this._timer = atv.setTimeout(function () {\n            this.callback(this.chrono.stop())\n            this._setTick()\n          }.bind(this), this.interval)\n        }\n      }\n    }\n  }\n)\n\nmodule.exports = Timer\n","var YouboraObject = require('../object')\nvar Log = require('../log')\nvar YBRequest = require('./request')\nvar Transform = require('./transform/transform')\n\nvar Communication = YouboraObject.extend(\n  /** @lends youbora.Communication.prototype */\n  {\n    /**\n     * Youbora Communication implements an abstraction layer over API requests.\n     * Internally, Communication implements queues of {@link Request} objects.\n     * This queue can be blocked using {@link Transform}\n     *\n     * @constructs Communication\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     *\n     * @param {string} host The fastdata host address.\n     * @param {boolean} httpSecure True for https, false for http, undefined for //.\n     */\n    constructor: function (pluginref) {\n      /** Array of {@link Transform}, only when the array is empty the request Queues will begin sending. */\n      this.transforms = []\n      this.pluginRef = pluginref\n      /**\n       * Queue of {@link YBRequest}\n       * @private\n       */\n      this._requests = []\n    },\n\n    /**\n     * Enqueues the request provided.\n     *\n     * @param {YBRequest} request Request to be enqueued\n     * @param {function} [callback] The defined load callback to the Request\n     */\n    sendRequest: function (request, callback, callbackParams) {\n      if (request) {\n        if (typeof callback === 'function') request.on(YBRequest.Event.SUCCESS, callback, callbackParams)\n        this._registerRequest(request)\n      }\n    },\n\n    /**\n     * Build a generic request to the given host.\n     *\n     * @param {string} host Host of the service called.\n     * @param {string} service A string with the service to be called. ie: '/data', '/joinTime'...\n     * @param {Object} [params] Object of key:value params.\n     * @param {function} [callback] The defined load callback to the Request\n     */\n    buildRequest: function (host, service, params, callback) {\n      params = params || {}\n      var request = new YBRequest(host, service, params)\n      if (typeof callback === 'function') request.on(YBRequest.Event.SUCCESS, callback)\n      this._registerRequest(request)\n    },\n\n    /**\n     * Adds a Transform to the queue. See {@link Transform}.\n     *\n     * @param {RequestTransform} transform\n     */\n    addTransform: function (transform) {\n      if (transform.parse && transform.isBlocking) {\n        this.transforms.push(transform)\n        transform.on(Transform.Event.DONE, this._processRequests.bind(this))\n      } else {\n        Log.warn(transform + ' is not a valid RequestTransform.')\n      }\n    },\n\n    /**\n     * Removes a {@link Transform}.\n     *\n     * @param {RequestTransform} transform Transform object to remove.\n     */\n    removeTransform: function (transform) {\n      var pos = this.transforms.indexOf(transform)\n      if (pos !== -1) {\n        this.transforms.splice(pos, 1)\n      } else {\n        Log.warn('Trying to remove unexisting Transform \\'' + transform + '\\'.')\n      }\n    },\n\n    /**\n     * Adds an {@link YBRequest} to the queue of requests.\n     *\n     * @private\n     * @param {YBRequest} request The Request to be queued.\n     */\n    _registerRequest: function (request) {\n      this._requests.push(request)\n      this._processRequests()\n    },\n\n    /**\n     * Execute pending requests in the queue. Returns rejected ones to the queue.\n     * @private\n     */\n    _processRequests: function () {\n      var workingQueue = this._requests\n      this._requests = []\n\n      var rejected = []\n      while (workingQueue.length) {\n        var request = workingQueue.shift()\n        var transformState = this._transform(request)\n        if (transformState === Transform.STATE_NO_BLOCKED) {\n          if (this.pluginRef) request.host = this.pluginRef.getHost()\n          request.send()\n        } else if (transformState === Transform.STATE_BLOCKED) {\n          rejected.push(request)\n        } // else { remove }\n      }\n\n      while (rejected.length) {\n        this._requests.push(rejected.shift())\n      }\n    },\n\n    /**\n     * Pass the given request to each transform.\n     * @private\n     * @returns {int} STATE_NO_BLOCKED if everything is right. STATE_BLOCKED if some parser rejected it.\n     * STATE_OFFLINE if offline transform blocked it.\n     */\n    _transform: function (request) {\n      var ret = Transform.STATE_NO_BLOCKED\n      this.transforms.forEach(function (transform) {\n        if (transform.isBlocking(request)) {\n          ret = Transform.STATE_BLOCKED\n          return\n        } else {\n          transform.parse(request)\n        }\n        if (transform.getState() === Transform.STATE_OFFLINE) {\n          ret = Transform.STATE_OFFLINE\n        }\n      })\n      return ret\n    }\n  })\n\nmodule.exports = Communication\n","/* global localStorage, sessionStorage */\nvar YouboraObject = require('../object')\nvar Log = require('../log')\n\n/**\n * This class manages data sotrage in the browser memory.\n *\n * @extends youbora.Emitter\n * @memberof youbora\n */\nvar YouboraStorage = YouboraObject.extend(\n  /** @lends youbora.YouboraStorage.prototype */\n  {\n    /**\n     *\n     * @constructs YouboraStorage\n     * @extends YouboraObject\n     * @memberof youbora\n     *\n     * @param {String} [prefix] Optional. Sets the prefix for saved objects in storages or cookies. 'youbora' by default.\n     * @param {Boolean} [disableCookies] Optional. Set to true to disable cookies fallback. True by default.\n     */\n    constructor: function (prefix, disableCookies, disable) {\n      this.prefix = prefix || 'youbora'\n      this.disableCookies = disableCookies\n      this.disabled = disable\n    },\n\n    /**\n     * Returns if storages are available or not\n     *\n     */\n    isEnabled: function () {\n      if (this.disabled) return false\n      var ret = true\n      if (this.disableCookies) {\n        try {\n          localStorage.setItem(this.prefix + '.' + 'test', 'true')\n          localStorage.removeItem(this.prefix + '.' + 'test')\n        } catch (err) {\n          ret = false\n        }\n      }\n      return ret\n    },\n\n    /**\n     * Saves in localStorage or equivalent\n     *\n     * @param {string} key Key of the value. Prefix will be appended.\n     * @param {string} value Value.\n     */\n    setLocal: function (key, value) {\n      if (this.disabled) return null\n      var ret = null\n      try {\n        if (typeof localStorage === 'undefined' || !localStorage) {\n          if (!this.disableCookies) {\n            ret = this._setCookie(this.prefix + '.' + key, value)\n          }\n        } else {\n          ret = localStorage.setItem(this.prefix + '.' + key, value)\n        }\n      } catch (err) {\n        Log.error('Youbora Infinity needs localStorage or cookies, not supported by your browser.')\n      }\n      return ret\n    },\n\n    /**\n     * Reads from localStorage or equivalent\n     *\n     * @param {string} key Key of the value. prefix will be appended.\n     */\n    getLocal: function (key) {\n      if (this.disabled) return null\n      return this._localGetRemove('getItem', '_getCookie', key)\n    },\n\n    /**\n     * Removes from localStorage or equivalent\n     *\n     * @param {string} key Key of the value. prefix will be appended.\n     */\n    removeLocal: function (key) {\n      if (this.disabled) return null\n      return this._localGetRemove('removeItem', '_removeCookie', key)\n    },\n\n    _localGetRemove: function (storageMethod, cookieMethod, key) {\n      var ret = null\n      try {\n        if (typeof localStorage === 'undefined' || !localStorage) {\n          if (!this.disableCookies) {\n            ret = this[cookieMethod](this.prefix + '.' + key)\n          }\n        } else {\n          ret = localStorage[storageMethod](this.prefix + '.' + key)\n        }\n      } catch (err) {\n        Log.error('Youbora Infinity needs localStorage or cookies, not supported by your browser.')\n      }\n      return ret\n    },\n\n    /**\n     * Saves in sessionStorage or equivalent\n     *\n     * @param {string} key Key of the value. prefix will be appended.\n     * @param {string} value Value.\n     */\n    setSession: function (key, value) {\n      if (this.disabled) return null\n      var ret = null\n      try {\n        if (typeof sessionStorage === 'undefined' || !sessionStorage) {\n          if (!this.disableCookies) {\n            ret = this._setCookie(this.prefix + '.' + 'session.' + key, value)\n          }\n        } else {\n          ret = sessionStorage.setItem(this.prefix + '.' + key, value)\n        }\n      } catch (err) {\n        Log.error('Youbora Infinity needs sessionStorage or cookies, not supported by your browser.')\n      }\n      return ret\n    },\n\n    /**\n     * Reads from sessionStorage or equivalent\n     *\n     * @param {string} key Key of the value. prefix will be appended.\n     */\n    getSession: function (key) {\n      if (this.disabled) return null\n      return this._sessionGetRemove('getItem', '_getCookie', key)\n    },\n\n    /**\n   * Removes from sessionStorage or equivalent\n   *\n   * @param {string} key Key of the value. prefix will be appended.\n   */\n    removeSession: function (key) {\n      if (this.disabled) return null\n      return this._sessionGetRemove('removeItem', '_removeCookie', key)\n    },\n\n    _sessionGetRemove: function (storageMethod, cookieMethod, key) {\n      var ret = null\n      try {\n        if (typeof sessionStorage === 'undefined' || !sessionStorage) {\n          if (!this.disableCookies) {\n            ret = this[cookieMethod](this.prefix + '.' + 'session.' + key)\n          }\n        } else {\n          ret = sessionStorage[storageMethod](this.prefix + '.' + key)\n        }\n      } catch (err) {\n        Log.error('Youbora Infinity needs sessionStorage or cookies, not supported by your browser.')\n      }\n      return ret\n    },\n\n    /**\n     * Calls getSession and getLocal for the same key\n     * @param {string} key Key of the value. prefix will be appended.\n     */\n    getStorages: function (key) {\n      return this.getSession(key) || this.getLocal(key)\n    },\n\n    /**\n     * Calls getSession and getLocal with the same key and value\n     * @param {string} key Key of the value. prefix will be appended.\n     * @param {string} value Value.\n     */\n    setStorages: function (key, value) {\n      this.setSession(key, value)\n      this.setLocal(key, value)\n    },\n\n    /**\n     * Calls getSession and getLocal for the same key\n     * @param {string} key Key of the value. prefix will be appended.\n     */\n    removeStorages: function (key) {\n      this.removeSession(key)\n      this.removeLocal(key)\n    },\n\n    // Private cookies methods\n\n    /**\n   * Sets a cookie value\n   *\n   * @param {string} cname Key of the value.\n   * @param {Object} cvalue Value.\n   */\n    _setCookie: function (cname, cvalue) {\n      if (typeof document !== 'undefined') {\n        document.cookie = cname + '=' + cvalue + ';'\n      }\n    },\n\n    /**\n   * Gets a cookie value\n   *\n   * @param {string} cname Key of the value.\n   */\n    _getCookie: function (cname) {\n      if (typeof document !== 'undefined') {\n        var name = cname + '='\n        var decodedCookie = decodeURIComponent(document.cookie)\n        var ca = decodedCookie.split(';')\n        for (var i = 0; i < ca.length; i++) {\n          var c = ca[i]\n          while (c.charAt(0) === ' ') {\n            c = c.substring(1)\n          }\n          if (c.indexOf(name) === 0) {\n            return c.substring(name.length, c.length)\n          }\n        }\n      }\n      return null\n    },\n\n    /**\n   * Removes a cookie\n   *\n   * @param {string} cname Key of the value.\n   */\n    _removeCookie: function (cname) {\n      if (typeof document !== 'undefined') {\n        document.cookie = cname + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n      }\n    }\n  }\n)\n\nmodule.exports = YouboraStorage\n","/* global btoa */\nvar Emitter = require('../emitter')\nvar Comm = require('../comm/communication')\nvar WrongTransform = require('../comm/transform/wrong')\nvar Util = require('../util')\n\nvar YouboraInfinity = Emitter.extend(\n  /** @lends youbora.Infinity.prototype */\n  {\n\n    /**\n     * This class is the base of youbora infinity. Every plugin will have an instance.\n     *\n     * @param {youbora.Plugin} plugin Parent plugin.\n     *\n     * @constructs youbora.Infinity\n     * @extends youbora.Emitter\n     * @memberof youbora\n     */\n    constructor: function (plugin) {\n      /** Parent {@link youbora.Plugin} reference. */\n      this._plugin = plugin\n    },\n\n    /**\n     * @alias youbora.Infinity.prototype.begin.\n     */\n    andBeyond: function () {\n      YouboraInfinity.prototype.begin.apply(this, arguments)\n    },\n\n    /**\n     * This method will start infinity logic, setting storage as needed.\n     * Will call fireSessionStart the first time and fireNav for every subsequent route change.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    begin: function (dimensions) {\n      this._comm = new Comm(this._plugin)\n      this._comm.addTransform(this._plugin.viewTransform)\n      this._comm.addTransform(new WrongTransform(this._plugin))\n      if (this._plugin && this._plugin.storage && typeof this._plugin.storage.getLocal === 'function') {\n        this._registeredProperties = this._plugin.storage.getLocal('inifnityRegisteredProperties')\n      }\n      if (!this._plugin.getIsSessionExpired() && this._plugin.storage.getLocal('infinityStarted')) {\n        this.fireNav(dimensions) // returning\n        this._sendExtraBeat()\n      } else {\n        this.fireSessionStart(dimensions) // first time\n      }\n    },\n\n    _generateNewContext: function () {\n      var context = null\n      try {\n        context = btoa(new Date().getTime())\n      } catch (err) {\n        context = 'Default'\n      }\n      this._plugin.storage.setSession('context', context)\n    },\n\n    _setLastActive: function () {\n      if (!this._firstActive) {\n        this._firstActive = this.getFirstActive()\n      }\n      this._plugin.storage.setStorages('lastactive', new Date().getTime())\n    },\n\n    getFirstActive: function () {\n      return Number(this._plugin.getLastActive()) || 0\n    },\n\n    /**\n     * Returns the current {@link youbora.Communication} instance.\n     *\n     * @returns {youbora.Communication} communication instance\n     */\n    getComm: function () {\n      return this._comm\n    },\n\n    // Fire\n    /**\n     * Emits session start request.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireSessionStart: function (dimensions) {\n      if (!this.infinityStarted) {\n        this._plugin.storage.setLocal('infinityStarted', 'true')\n        this.infinityStarted = true\n        this._generateNewContext()\n        this.emit(YouboraInfinity.Event.SESSION_START, this._getParamsJson(dimensions, null, null, true, true))\n        this._setLastActive()\n      }\n    },\n\n    /**\n     * Emits session start request.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireSessionStop: function (params) {\n      if (this.infinityStarted) {\n        this.infinityStarted = false\n        this._plugin.storage.removeStorages('infinityStarted')\n        this.emit(YouboraInfinity.Event.SESSION_STOP, params)\n        this._plugin.storage.removeStorages('data')\n        this._plugin.storage.removeStorages('session')\n        this._plugin.storage.removeStorages('lastactive')\n      }\n    },\n\n    /**\n     * Stops the session and creates a new one\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    newSession: function (options, params) {\n      if (this.isActive()) {\n        this.fireSessionStop()\n        if (this._comm) this._comm.removeTransform(this._plugin.viewTransform)\n        this._plugin.restartViewTransform()\n        if (this._comm) this._comm.addTransform(this._plugin.viewTransform)\n        this._plugin.storage.removeLocal('data')\n      }\n      this._plugin.setOptions(options)\n      this.begin(params)\n    },\n\n    /**\n     * Emits session start request.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireNav: function (dimensions) {\n      if (this.isActive()) {\n        if (!this._plugin.getContext()) {\n          this._generateNewContext()\n        }\n        this.infinityStarted = true\n        this.emit(YouboraInfinity.Event.NAV, this._getParamsJson(dimensions, null, null, true))\n      }\n    },\n\n    _sendExtraBeat: function () {\n      if (this._plugin && this._plugin._beat) {\n        var now = new Date().getTime()\n        var time = this._plugin._beat.chrono.startTime ? (now - this._plugin._beat.chrono.startTime) : 0\n        this._plugin._sendBeat(time)\n        this._plugin._beat.chrono.startTime = now\n      }\n      this._setLastActive()\n    },\n\n    /**\n     * Emits session start request.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireEvent: function (eventName, dimensions, values, topLevelDimensions) {\n      if (this.infinityStarted) {\n        var builtParams = this._getParamsJson(dimensions, values, eventName)\n        Util.assign(builtParams.params, topLevelDimensions || {})\n        this.emit(YouboraInfinity.Event.EVENT, builtParams)\n        this._setLastActive()\n      }\n    },\n\n    /** Register properties sent by the User, to send in all the events\n    *\n    * @memberof youbora.Infinity.prototype\n    */\n    register: function (dimensions, values) {\n      this._registeredProperties = { dimensions: dimensions, values: values }\n      this._plugin.storage.setLocal('inifnityRegisteredProperties', JSON.stringify(this._registeredProperties))\n    },\n\n    /** Calls register if registeredProperties is empty\n    *\n    * @memberof youbora.Infinity.prototype\n    */\n    registerOnce: function (dimensions, values) {\n      if (!this._registeredProperties) {\n        this.register(dimensions, values)\n      }\n    },\n\n    /** Unregister properties registered with register()\n    *\n    * @memberof youbora.Infinity.prototype\n    */\n    unregister: function () {\n      this._registeredProperties = null\n      this._plugin.storage.removeLocal('inifnityRegisteredProperties')\n    },\n\n    /**\n     * Splits params in dimensions (strings) and values (numbers)\n     *\n     * @param {Object} [params] Object of key:value params to split before adding to request.\n     */\n    _getParamsJson: function (dimensions, values, eventName, isNavigaton, isStart) {\n      var returnparams = {}\n      if (eventName) returnparams.name = eventName\n      returnparams.dimensions = dimensions || {}\n      returnparams.values = values || {}\n      if (this._registeredProperties) {\n        for (var key in this._registeredProperties.dimensions) {\n          returnparams.dimensions[key] = this._registeredProperties.dimensions[key]\n        }\n        for (var key2 in this._registeredProperties.values) {\n          returnparams.values[key2] = this._registeredProperties.values[key2]\n        }\n      }\n      var paramsObject = { params: returnparams }\n      if (isNavigaton) {\n        if (paramsObject.params.dimensions.page) {\n          paramsObject.params.page = paramsObject.params.dimensions.page\n          delete paramsObject.params.dimensions.page\n        }\n        if (paramsObject.params.dimensions.route) {\n          paramsObject.params.route = paramsObject.params.dimensions.route\n          delete paramsObject.params.dimensions.route\n        }\n        if (!isStart) {\n          delete paramsObject.params.dimensions\n        }\n        delete paramsObject.params.values\n      }\n      return paramsObject\n    },\n\n    isActive: function () {\n      if (this.infinityStarted || this._plugin.storage.getLocal('infinityStarted')) {\n        return true\n      }\n      var now = new Date().getTime()\n      if (Number(this._plugin.getLastActive()) + this._plugin.sessionExpire > now) {\n        return true\n      }\n      return false\n    }\n  },\n  /** @lends youbora.Plugin */\n  {\n    // Static Memebers //\n    /**\n     * List of events that could be fired\n     * @enum\n     * @event\n     */\n    Event: {\n      NAV: 'nav',\n      SESSION_START: 'sessionStart',\n      SESSION_STOP: 'sessionStop',\n      BEAT: 'beat',\n      EVENT: 'event'\n    }\n  }\n)\n\nmodule.exports = YouboraInfinity\n","var Emitter = require('../emitter')\nvar Log = require('../log')\nvar Util = require('../util')\nvar version = require('../version')\nvar PlaybackChronos = require('./playbackchronos')\nvar PlaybackFlags = require('./playbackflags')\nvar PlayheadMonitor = require('./playheadmonitor')\nvar AdapterConstants = require('../constants/adapter')\n\nvar Adapter = Emitter.extend(\n  /** @lends youbora.this.prototype */\n  {\n    /**\n     * Main Adapter class. All specific player adapters should extend this class specifying a player\n     * class.\n     *\n     * The Adapter works as the 'glue' between the player and YOUBORA acting both as event\n     * translator and as proxy for the {@link Plugin} to get info from the player.\n     *\n     * @constructs Adapter\n     * @extends youbora.Emitter\n     * @memberof youbora\n     *\n     * @param {object|string} player Either an instance of the player or a string containing an ID.\n     */\n    constructor: function (player) {\n      /** An instance of {@link FlagStatus} */\n      this.flags = new PlaybackFlags()\n\n      /** An instance of {@link ChronoStatus} */\n      this.chronos = new PlaybackChronos()\n\n      /** Reference to {@link PlayheadMonitor}. Helps the plugin detect buffers/seeks. */\n      this.monitor = null\n\n      /** Reference to {@link Plugin}. */\n      this.plugin = null\n\n      /** Reference to the player tag */\n      this.player = null\n\n      /** Defines if the adapter is used as adapter or adsAdapter */\n      this._isAdsAdapter = null\n\n      // Register player and event listeners\n      this.setPlayer(player)\n\n      /** Reference to the video/object tag, could be the same as the player. */\n      this.tag = this.player\n\n      Log.notice('Adapter ' + this.getVersion() + ' with Lib ' + version + ' is ready.')\n    },\n\n    /**\n     * Sets a new player, removes the old listeners if needed.\n     *\n     * @param {Object} player Player to be registered.\n     */\n    setPlayer: function (player) {\n      if (this.player) this.unregisterListeners()\n\n      if (typeof player === 'string' && typeof document !== 'undefined') {\n        this.player = document.getElementById(player)\n      } else {\n        this.player = player\n      }\n      this.registerListeners()\n    },\n\n    /**\n     * Override to create event binders.\n     * It's a good practice when implementing a new Adapter to create intermediate methods and call\n     * those when player events are detected instead of just calling the `fire*` methods. This\n     * will allow future users of the Adapter to customize its behaviour by overriding these\n     * methods.\n     *\n     * @example\n     * registerListeners: function () {\n     *  this.player.addEventListener('start', this.onStart.bind(this))\n     * },\n     *\n     * onStart: function (e) {\n     *  this.emit('start')\n     * }\n     */\n    registerListeners: function () {\n    },\n\n    /**\n     * Override to create event de-binders.\n     *\n     * @example\n     * registerListeners: function () {\n     *  this.player.removeEventListener('start', this.onStart)\n     * }\n     */\n    /** Unregister listeners to this.player. */\n    unregisterListeners: function () {\n    },\n\n    /**\n     * This function disposes the currend adapter, removes player listeners and drops references.\n     */\n    dispose: function () {\n      if (this.monitor) this.monitor.stop()\n      this.fireStop()\n      this.unregisterListeners()\n      this.player = null\n      this.tag = null\n    },\n\n    /**\n     * Creates a new {@link PlayheadMonitor} at this.monitor.\n     *\n     * @param {bool} monitorBuffers If true, it will monitor buffers.\n     * @param {bool} monitorSeeks If true, it will monitor seeks.\n     * @param {number} [interval=800] The interval time in ms.\n     */\n    monitorPlayhead: function (monitorBuffers, monitorSeeks, interval) {\n      this.stopMonitor()\n      var type = 0\n      if (monitorBuffers) type |= PlayheadMonitor.Type.BUFFER\n      if (monitorSeeks) type |= PlayheadMonitor.Type.SEEK\n\n      if (!this.monitor || !this.monitor._timer.isRunning) {\n        this.monitor = new PlayheadMonitor(this, type, interval)\n      } else {\n        this.monitor.skipNextTick()\n      }\n    },\n\n    stopMonitor: function () {\n      if (this.monitor) this.monitor.stop()\n    },\n\n    // GETTERS //\n\n    /** Override to return current playhead of the video */\n    getPlayhead: function () {\n      return null\n    },\n\n    /** Override to return video duration */\n    getDuration: function () {\n      return null\n    },\n\n    /** Override to return current bitrate */\n    getBitrate: function () {\n      return null\n    },\n\n    /** Override to return total downloaded bytes */\n    getTotalBytes: function () {\n      return null\n    },\n\n    /** Override to return title */\n    getTitle: function () {\n      return null\n    },\n\n    /** Override to return resource URL. */\n    getResource: function () {\n      return null\n    },\n\n    /** Override to return player version */\n    getPlayerVersion: function () {\n      return null\n    },\n\n    /** Override to return player's name */\n    getPlayerName: function () {\n      return null\n    },\n\n    /** Override to return adapter version. */\n    getVersion: function () {\n      return version + '-generic-js'\n    },\n\n    // FLOW //\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent init if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireInit: function (params) {\n      if (this.plugin) this.plugin.fireInit()\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireStart: function (params) {\n      if (this.plugin && this.plugin.backgroundDetector && this.plugin.backgroundDetector.canBlockStartCalls()) {\n        return null\n      }\n      if (!this.flags.isStarted) {\n        this.flags.isStarted = true\n        this.chronos.total.start()\n        this.chronos.join.start()\n        this.emit(AdapterConstants.Event.START, { params: params })\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireJoin: function (params) {\n      if (!this.flags.isJoined && !this.flags.isStarted && !this._isAds() && this.plugin && this.plugin.isInitiated) {\n        this.fireStart()\n      }\n      if (this.flags.isStarted && !this.flags.isJoined) {\n        this.flags.isStarted = true\n        if (this.monitor) this.monitor.start()\n        this.flags.isJoined = true\n        this.chronos.join.stop()\n        this.emit(AdapterConstants.Event.JOIN, { params: params })\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    firePause: function (params) {\n      if (this.flags.isBuffering) {\n        this.fireBufferEnd()\n      }\n      if (this.flags.isJoined && !this.flags.isPaused) {\n        this.flags.isPaused = true\n\n        this.chronos.pause.start()\n\n        this.emit(AdapterConstants.Event.PAUSE, { params: params })\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireResume: function (params) {\n      if (this.flags.isJoined && this.flags.isPaused) {\n        this.flags.isPaused = false\n\n        this.chronos.pause.stop()\n\n        if (this.monitor) this.monitor.skipNextTick()\n\n        this.emit(AdapterConstants.Event.RESUME, { params: params })\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     * @param {bool} [convertFromSeek=false] If true, will convert current seek to buffer.\n     */\n    fireBufferBegin: function (params, convertFromSeek) {\n      if (this.flags.isJoined && !this.flags.isBuffering) {\n        if (this.flags.isSeeking) {\n          if (convertFromSeek) {\n            Log.notice('Converting current buffer to seek')\n\n            this.chronos.buffer = this.chronos.seek.clone()\n            this.chronos.seek.reset()\n\n            this.flags.isSeeking = false\n          } else {\n            return\n          }\n        } else {\n          this.chronos.buffer.start()\n        }\n\n        this.flags.isBuffering = true\n        this.emit(AdapterConstants.Event.BUFFER_BEGIN, { params: params })\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireBufferEnd: function (params) {\n      if (this.flags.isJoined && this.flags.isBuffering) {\n        this.cancelBuffer()\n        this.emit(AdapterConstants.Event.BUFFER_END, { params: params })\n      }\n    },\n\n    /**\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    cancelBuffer: function (params) {\n      if (this.flags.isJoined && this.flags.isBuffering) {\n        this.flags.isBuffering = false\n\n        this.chronos.buffer.stop()\n\n        if (this.monitor) this.monitor.skipNextTick()\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireStop: function (params) {\n      if (this._isAds() || (this.plugin && this.plugin._isStopReady())) {\n        if ((this._isAds() && this.flags.isStarted) ||\n          (!this._isAds() && (this.flags.isStarted || (this.plugin && this.plugin.isInitiated)))\n        ) {\n          if (this.monitor) this.monitor.stop()\n\n          this.flags.reset()\n          this.chronos.total.stop()\n          this.chronos.join.reset()\n          this.chronos.pause.stop()\n          this.chronos.buffer.stop()\n          this.chronos.seek.stop()\n\n          this.emit(AdapterConstants.Event.STOP, { params: params })\n\n          this.chronos.pause.reset()\n          this.chronos.buffer.reset()\n          this.chronos.seek.reset()\n          this.chronos.viewedMax.splice(0, this.chronos.viewedMax.length)\n        }\n      }\n    },\n\n    setIsAds: function (value) {\n      this._isAdsAdapter = value\n    },\n\n    _isAds: function () {\n      return this._isAdsAdapter\n    },\n\n    /**\n     * @param {Object} [params] Object of key:value params to add to the request.\n     */\n    fireCasted: function (params) {\n      if (!params) params = {}\n      params.casted = true\n      this.fireStop(params)\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {String|Object} [code] Error Code, if an object is sent, it will be treated as params.\n     * @param {String} [msg] Error Message\n     * @param {Object} [metadata] Object defining error metadata\n     * @param {String} [level] Level of the error. Currently supports 'error' and 'fatal'\n     */\n    fireError: function (code, msg, metadata, level) {\n      var params = Util.buildErrorParams(code, msg, metadata, level)\n      if (params.code) {\n        delete params.code\n      }\n      var options = this.plugin ? this.plugin.options : {}\n      if (typeof params.errorCode !== 'undefined' && options['errors.ignore'] &&\n      options['errors.ignore'].indexOf(params.errorCode.toString()) > -1) {\n        // ignore error\n      } else {\n        this.emit(AdapterConstants.Event.ERROR, { params: params })\n        if (typeof params.errorCode !== 'undefined' && options['errors.fatal'] &&\n          options['errors.fatal'].indexOf(params.errorCode.toString()) > -1) {\n          this.fireStop()\n        }\n      }\n    },\n\n    /**\n     * Emits related event and set flags if current status is valid.\n     * ie: won't sent start if isStarted is already true.\n     *\n     * @param {String|Object} [code] Error Code, if an object is sent, it will be treated as params.\n     * @param {String} [msg] Error Message\n     * @param {Object} [metadata] Object defining error metadata\n     */\n    fireFatalError: function (code, msg, metadata, level) {\n      var options = this.plugin ? this.plugin.options : {}\n      if (typeof code !== 'undefined' && options['errors.ignore'] &&\n      options['errors.ignore'].indexOf(code.toString()) > -1) {\n        // ignore error\n      } else {\n        if (this.monitor) this.monitor.stop()\n        this.fireError(code, msg, metadata, level)\n        if (typeof code !== 'undefined' && options['errors.nonFatal'] &&\n          options['errors.nonFatal'].indexOf(code.toString()) > -1) {\n          // no stop\n        } else {\n          this.fireStop()\n        }\n      }\n    }\n  },\n  {\n    /** @lends youbora.Adapter */\n    // Static Memebers //\n\n    /**\n     * List of events that could be fired\n     * @enum\n     * @event\n     */\n    Event: AdapterConstants.Event\n  }\n)\n\nUtil.assign(Adapter.prototype, require('./adapter+ads'))\nUtil.assign(Adapter.prototype, require('./adapter+content'))\n\nmodule.exports = Adapter\n","/**\n * See Object.assign.\n *\n * @memberof youbora.Util\n */\nmodule.exports = function (target) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object')\n  }\n\n  var output = Object(target)\n  for (var index = 1; index < arguments.length; index++) {\n    var source = arguments[index]\n    if (source !== undefined && source !== null) {\n      for (var nextKey in source) {\n        if (source.hasOwnProperty(nextKey)) { // eslint-disable-line no-prototype-builtins\n          output[nextKey] = source[nextKey]\n        }\n      }\n    }\n  }\n  return output\n}\n","/* global Streamroot, peer5, teltoo */\nvar YouboraObject = require('../object')\n/**\n * This static class provides p2p and cdn network traffic information for\n * Streamroot, Peer5 and EasyBroadcast\n *\n * @constructs YouboraObject\n * @extends youbora.YouboraObject\n * @memberof youbora\n *\n */\nvar HybridNetowrk = YouboraObject.extend({\n  /** Returns CDN traffic bytes using streamroot, peer5 or teltoo. Otherwise null */\n  getCdnTraffic: function () {\n    var ret = null\n    if (typeof Streamroot !== 'undefined') {\n      ret = this._getStreamrootPeerObject('cdn', false) || this._getStreamrootInstanceObject('cdnDownload')\n    } else if (typeof peer5 !== 'undefined' && peer5.getStats) {\n      ret = peer5.getStats().totalHttpDownloaded\n    } else if (typeof teltoo !== 'undefined' && teltoo.getStats) {\n      var stats = teltoo.getStats()\n      ret = stats.totalReceivedBytes - stats.p2pReceivedBytes\n    }\n    return ret\n  },\n\n  /** Returns P2P traffic bytes using streamroot, peer5 or teltoo. Otherwise null */\n  getP2PTraffic: function () {\n    var ret = null\n    if (typeof Streamroot !== 'undefined') {\n      ret = this._getStreamrootPeerObject('p2p', true) || this._getStreamrootInstanceObject('dnaDownload')\n    } else if (typeof peer5 !== 'undefined' && peer5.getStats) {\n      ret = peer5.getStats().totalP2PDownloaded\n    } else if (typeof teltoo !== 'undefined' && teltoo.getStats) {\n      ret = teltoo.getStats().p2pReceivedBytes\n    }\n    return ret\n  },\n\n  /** Returns P2P traffic sent in bytes, using streamroot or peer5. Otherwise null */\n  getUploadTraffic: function () {\n    var ret = null\n    if (typeof Streamroot !== 'undefined') {\n      ret = this._getStreamrootPeerObject('upload', true) || this._getStreamrootInstanceObject('dnaUpload')\n    } else if (typeof peer5 !== 'undefined' && peer5.getStats) {\n      ret = peer5.getStats().totalP2PUploaded\n    }\n    return ret\n  },\n\n  /** Returns if P2P is enabled, using streamroot or peer5. Otherwise null */\n  getIsP2PEnabled: function () {\n    var ret = false\n    if (typeof Streamroot !== 'undefined') {\n      if (Streamroot.p2pAvailable && Streamroot.peerAgents) {\n        for (var agent in Streamroot.peerAgents) {\n          ret = ret || Streamroot.peerAgents[agent].isP2PEnabled\n        }\n      } else if (Streamroot.instances) {\n        Streamroot.instances.forEach(function (instance) {\n          ret = ret || instance.dnaDownloadEnabled || instance.dnaUploadEnabled\n        })\n      }\n    } else if (typeof peer5 !== 'undefined' && peer5.isEnabled) {\n      ret = peer5.isEnabled()\n    } else if (typeof teltoo !== 'undefined') {\n      ret = true\n    }\n    return ret\n  },\n\n  _getStreamrootPeerObject: function (objectName, check) {\n    var ret = null\n    if (Streamroot.p2pAvailable && Streamroot.peerAgents) {\n      for (var agent in Streamroot.peerAgents) {\n        var agentInst = Streamroot.peerAgents[agent]\n        if (agentInst.stats && (!check || agentInst.isP2PEnabled)) {\n          ret += agentInst.stats[objectName]\n        }\n      }\n    }\n    return ret\n  },\n\n  _getStreamrootInstanceObject: function (objectName) {\n    var ret = null\n    if (Streamroot.instances) {\n      Streamroot.instances.forEach(function (instance) {\n        if (instance.stats && instance.stats.currentContent) {\n          ret += instance.stats.currentContent[objectName]\n        }\n      })\n    }\n    return ret\n  }\n})\n\nmodule.exports = HybridNetowrk\n","var YBRequest = require('../request')\nvar Transform = require('./transform')\nvar Log = require('../../log')\nvar Util = require('../../util')\nvar Constants = require('../../constants')\n\nvar ViewTransform = Transform.extend(\n  /** @lends youbora.ViewTransform.prototype */\n  {\n    /**\n     * This class manages Fastdata service and view index.\n     *\n     * @constructs\n     * @extends youbora.Transform\n     * @memberof youbora\n     *\n     * @param {Plugin} plugin Instance of {@link Plugin}\n     * @param {string} session If provided, plugin will use this as a FD response.\n     */\n    constructor: function (plugin, session) {\n      Transform.prototype.constructor.apply(this, arguments)\n\n      /** /data response */\n      this.response = {}\n\n      this._viewIndex = new Date().getTime()\n\n      this._session = session\n\n      this._httpSecure = plugin.options['app.https']\n\n      this._plugin = plugin\n\n      this.transformName = 'View'\n    },\n\n    /**\n     * Starts the 'FastData' fetching. This will send the initial request to YOUBORA in order to get\n     * the needed info for the rest of the requests.\n     *\n     * This is an asynchronous process.\n     *\n     * When the fetch is complete, {@link #fastDataConfig} will contain the parsed info.\n     * @see FastDataConfig\n     */\n    init: function () {\n      // offline\n      if (this._plugin.options && this._plugin.options.offline) {\n        // set the options\n        this.response.host = 'OFFLINE'\n        this.response.code = 'OFFLINE'\n        this.response.pingTime = 60\n        this.response.beatTime = 60\n        this.done()\n        return null\n      }\n\n      // reusing old data not expired\n      if (this._plugin.storage.isEnabled()) {\n        var now = new Date().getTime()\n        if (now < this._plugin.sessionExpire + (Number(this._plugin.getDataTime()) || 0) &&\n          this._plugin.getStoredData()) {\n          this.setData(this._plugin.getStoredData())\n          return null\n        }\n      }\n\n      // request new data\n      var service = Constants.Service.DATA\n      var params = {\n        outputformat: 'json'\n      }\n\n      params = this._plugin.requestBuilder.buildParams(params, service)\n      if (params !== null) {\n        Log.notice(service + ' ' + params.system)\n        if (params.system === 'nicetest') {\n          // \"nicetest\" is the default accountCode.\n          // If found here, it's very likely that the customer has forgotten to set it.\n          Log.error(\n            'No accountCode has been set. Please set your accountCode inside plugin\\'s options.'\n          )\n        }\n\n        new YBRequest(this._plugin.getHost(), service, params)\n          .on(YBRequest.Event.SUCCESS, this._receiveData.bind(this))\n          .on(YBRequest.Event.ERROR, this._failedData.bind(this))\n          .send()\n      }\n    },\n\n    /**\n     * Uses given response to set fastdata response.\n     *\n     * @param {String} response Fastdata response as json string.\n     */\n    setData: function (response) {\n      try {\n        var resp = JSON.parse(response)\n        if (this._plugin.options['parse.fdsResponseHost']) {\n          response = response.replace(resp.q.h, this._plugin.options['parse.fdsResponseHost'](resp.q.h))\n          resp = JSON.parse(response)\n        }\n        this.response.msg = response\n        this.response.host = Util.addProtocol(resp.q.h, this._httpSecure)\n        this.response.code = resp.q.c\n        this.response.pingTime = resp.q.pt || 5\n        this.response.beatTime = resp.q.i ? resp.q.i.bt || 30 : 30\n        this.response.sessionExpire = resp.q.i ? resp.q.i.exp || 300 : 300\n        this._plugin.storage.setLocal('sessionExpire', this.response.sessionExpire)\n        this.done()\n      } catch (err) {\n        Log.error('Fastdata response is invalid.')\n      }\n    },\n\n    /**\n     * Parse the response from the fastData service.\n     *\n     * @private\n     */\n    _receiveData: function (req, e) {\n      var msg = req.getResponse()\n      this.setData(msg)\n    },\n\n    _failedData: function (req, e) {\n      Log.error('Fastdata request has failed.')\n    },\n\n    /**\n     * This method will increment the view index (timestamp values). The library handles this\n     * automatically, but some error flow might need calling this manually.\n     * @return {string} new viewcode\n     */\n    nextView: function () {\n      this._viewIndex = new Date().getTime()\n      return this.getViewCode()\n    },\n\n    /**\n     * Returns current viewcode\n     * @return {string} viewcode\n     */\n    getViewCode: function () {\n      return this.response.code + '_' + this._viewIndex\n    },\n\n    /**\n     * Returns the current session\n     *\n     * @returns {string} Session\n     */\n    getSession: function () {\n      return this._session\n    },\n\n    /**\n     * Sets the session\n     *\n     * @param {String} sessionId Sets the session\n     */\n    setSession: function (session) {\n      this._session = session\n    },\n\n    /** Sets the host url\n    *\n    * @param {String} host Sets the host\n    */\n    setHost: function (host) {\n      this.response.host = host\n    },\n\n    /**\n     * Transform requests\n     * @param {youbora.comm.YBRequest} request YBRequest to transform.\n     */\n    parse: function (request) {\n      // Host, system and sessionRoot for all\n      request.host = request.host || this.response.host\n      request.params.system = this._plugin.getAccountCode()\n      request.params.sessionRoot = request.params.sessionRoot || this.getSession()\n\n      // PingTime for ping and start\n      if (ViewTransform.EventList.PingTime.indexOf(request.service) !== -1) {\n        request.params.pingTime = request.params.pingTime || this.response.pingTime\n      }\n\n      // ViewCode for non infinity events\n      if (ViewTransform.EventList.Infinity.indexOf(request.service) === -1) {\n        request.params.code = request.params.code || this.getViewCode()\n      } else {\n        // For infinity events, sessionId\n        request.params.sessionId = request.params.sessionRoot\n      }\n\n      // For init error and start, parentId and navContext\n      if (ViewTransform.EventList.CreateView.indexOf(request.service) !== -1) {\n        if (this._plugin.infinity.infinityStarted || (this._plugin.storage.isEnabled() && this._plugin.storage.getLocal('infinityStarted'))) {\n          request.params.parentId = request.params.sessionRoot\n          request.params.navContext = request.params.navContext || this._plugin.getContext()\n        }\n      }\n    }\n  },\n  {\n    // Static members\n    EventList: {\n      CreateView: [\n        Constants.Service.START,\n        Constants.Service.INIT,\n        Constants.Service.ERROR\n      ],\n      Infinity: [\n        Constants.Service.NAV,\n        Constants.Service.SESSION_START,\n        Constants.Service.SESSION_STOP,\n        Constants.Service.EVENT,\n        Constants.Service.BEAT\n      ],\n      PingTime: [\n        Constants.Service.START,\n        Constants.Service.PING\n      ]\n    }\n  })\n\nmodule.exports = ViewTransform\n","/* global atv */\nvar Transform = require('./transform')\nvar HlsParser = require('./resourceparsers/formatparsers/hlsparser')\nvar CdnParser = require('./resourceparsers/cdnparser')\nvar CdnSwitch = require('./resourceparsers/cdnSwitch')\nvar DashParser = require('./resourceparsers/formatparsers/dashparser')\nvar Parser = require('./resourceparsers/formatparsers/parser')\nvar LocationheaderParser = require('./resourceparsers/formatparsers/locationheaderparser')\nvar Log = require('../../log')\nvar Constants = require('../../constants')\n\nvar ResourceTransform = Transform.extend(\n  /** @lends youbora.ResourceTransform.prototype */\n  {\n    /**\n     * This class parses resource to fetch HLS transportstreams and CDN-related info.\n     *\n     * @constructs ResourceTransform\n     * @extends youbora.Transform\n     * @memberof youbora\n     *\n     * @param {Plugin} plugin Instance of {@link Plugin}\n     */\n    constructor: function (plugin) {\n      ResourceTransform.__super__.constructor.apply(this, arguments)\n\n      this._plugin = plugin\n      this._realResource = null\n      this._transportFormat = null\n      this._initResource = null\n      this._cdnName = null\n      this._cdnNodeHost = null\n      this._cdnNodeTypeString = null\n      this._cdnNodeType = null\n      this._responses = {}\n      this._isBusy = false\n\n      this.transformName = 'Resource'\n    },\n\n    /**\n     * Get the resource. If the transform is done, the real (parsed) resource will be returned\n     * Otherwise the initial one is returned.\n     *\n     * @return {string} The initial or parsed resource\n     */\n    getResource: function () {\n      return this._realResource\n    },\n\n    _getInitialCdnResource: function () {\n      return this._realResource || this._initResource\n    },\n\n    /**\n     * Get the transport format. If the transform detected the chunk format it will be returned, if not, null.\n     *\n     * @return {string} The streaming protocol\n     */\n    getTransportFormat: function () {\n      return this._transportFormat\n    },\n\n    /**\n     * Get the parsed CDN name.\n     *\n     * @return {string} The CDN name or null if unknown\n     */\n    getCdnName: function () {\n      return this._cdnName\n    },\n\n    /**\n     * Get the parsed CDN node.\n     *\n     * @return {string} The CDN node or null if unknown\n     */\n    getNodeHost: function () {\n      return this._cdnNodeHost\n    },\n\n    /**\n     * Get the parsed CDN type string, as returned in the cdn header response.\n     *\n     * @return {string} The CDN type string\n     */\n    getNodeTypeString: function () {\n      return this._cdnNodeTypeString\n    },\n\n    /**\n     * Get the parsed CDN type, parsed from the type string.\n     *\n     * @return {string} The CDN type\n     */\n    getNodeType: function () {\n      return this._cdnNodeType\n    },\n\n    /**\n     * Start the execution. Can be called more than once. If already running, it will be ignored,\n     * if ended it will restart.\n     * @param {string} resource the original resource\n     */\n    init: function (resource) {\n      if (!resource) {\n        this.done()\n        return\n      }\n      if (!this._isBusy) {\n        this._isBusy = true\n        this._initResource = resource\n        this._parseManifestEnabled = this._plugin.isParseManifest()\n        this._cdnEnabled = this._plugin.isParseCdnNode()\n        this._cdnList = this._plugin.getParseCdnNodeList().slice() // clone\n        this._cdnNameHeader = this._plugin.getParseCdnNodeNameHeader()\n        CdnParser.setBalancerHeaderName(this._cdnNameHeader)\n\n        this._setTimeout()\n        if (this._parseManifestEnabled) {\n          if (!this._isFinalUrl(this._initResource)) {\n            this.parseManifest() // Unknown lastManifest or lastSrc, call without arguments\n          } else {\n            this._realResource = this._initResource\n            this.done()\n          }\n        } else {\n          this._parseCDN()\n        }\n      }\n    },\n\n    _isFinalUrl: function (url) {\n      var segmentExtensions = ['.ts', '.mp4', '.m4s', '.cmfv']\n      url = url || ''\n      for (var i in segmentExtensions) {\n        var ext = segmentExtensions[i]\n        if (url.lastIndexOf(ext) === url.length - ext.length) {\n          return true\n        }\n      }\n      return false\n    },\n\n    // done: function () {\n    //  Transform.prototype.done.apply(this, arguments) // super\n    // },\n\n    _setTimeout: function () {\n      // Abort operation after 3s\n      var timeoutComplete = function () {\n        if (this._isBusy) {\n          this.done()\n          Log.warn('ResourceTransform has exceded the maximum execution time (3s) and will be aborted.')\n        }\n      }.bind(this)\n      try {\n        this._parseTimeout = setTimeout(timeoutComplete, 3000)\n      } catch (err) {\n        if (typeof atv !== 'undefined') {\n          this._parseTimeout = atv.setTimeout(timeoutComplete, 3000)\n        } else {\n          Log.error(err)\n        }\n      }\n    },\n\n    parseManifest: function (lastManifest, lastSrc) {\n      var parserArray = [new LocationheaderParser(), new DashParser(), new HlsParser()]\n      this._parseManifest(parserArray, lastManifest, lastSrc || this._initResource)\n    },\n\n    _parseManifest: function (parserArray, lastManifest, lastSrc, format) {\n      if (parserArray.length > 0) {\n        var parser = parserArray[0]\n        if (parser.shouldExecute(lastManifest)) {\n          parser.on(Parser.Event.DONE, function () {\n            this._parseManifest(parserArray.slice(1, parserArray.length), parser.getLastManifest(), parser.getResource(), parser.getTransportFormat() || format)\n          }.bind(this))\n          parser.parse(lastSrc, lastManifest)\n        } else {\n          this._parseManifest(parserArray.slice(1, parserArray.length), lastManifest, lastSrc, format)\n        }\n      } else {\n        this._transportFormat = format\n        this._realResource = lastSrc\n        this._parseCDN()\n      }\n    },\n\n    _parseCDN: function () {\n      if (this._plugin.isCdnSwitch()) {\n        this.switchDetector = new CdnSwitch(this._plugin)\n        this.switchDetector.on(CdnSwitch.Events.DONE, function (resp) {\n          this._cdnName = resp.data\n          this.done()\n        }.bind(this))\n\n        this.switchDetector.on(CdnSwitch.Events.ERROR, function () {\n          this.done()\n        }.bind(this))\n        this.switchDetector.init()\n      } else if (this._cdnEnabled && this._cdnList.length > 0) {\n        var cdn = this._cdnList.shift()\n\n        if (this.getNodeHost()) return // abort\n\n        var cdnParser = CdnParser.create(cdn)\n        if (cdnParser) {\n          cdnParser.on(CdnParser.Event.DONE, function () {\n            this._responses = cdnParser.getResponses()\n            this._cdnName = cdnParser.getParsedCdnName()\n            this._cdnNodeHost = cdnParser.getParsedNodeHost()\n            this._cdnNodeTypeString = cdnParser.getParsedNodeTypeString()\n            this._cdnNodeType = cdnParser.getParsedNodeType()\n            if (this.getNodeHost()) {\n              this.done()\n            } else {\n              this._parseCDN()\n            }\n          }.bind(this))\n          // Run parse\n          cdnParser.parse(this._getInitialCdnResource(), this._responses)\n        } else {\n          this._parseCDN()\n        }\n      } else {\n        this.done()\n      }\n    },\n\n    /**\n     * Replaces the resource and/or Cdn info for the /start service.\n     *\n     * @param {YBRequest} request YBRequest to transform.\n     */\n    parse: function (request) {\n      if (request.service === Constants.Service.START) {\n        var lastSent = this._plugin.requestBuilder.lastSent\n        lastSent.parsedResource = request.params.parsedResource = this.getResource() || request.params.parsedResource\n        lastSent.transportFormat = request.params.transportFormat = this.getTransportFormat() || request.params.transportFormat\n        if (this._cdnEnabled) {\n          lastSent.cdn = request.params.cdn = request.params.cdn || this.getCdnName()\n          lastSent.nodeHost = request.params.nodeHost = this.getNodeHost() || request.params.nodeHost\n          lastSent.nodeType = request.params.nodeType = this.getNodeType() || request.params.nodeType\n          lastSent.nodeTypeString = request.params.nodeTypeString = this.getNodeTypeString() || request.params.nodeTypeString\n        }\n      }\n    }\n  })\n\nmodule.exports = ResourceTransform\n","var YBRequest = require('../../../request')\nvar Parser = require('./parser')\nvar Log = require('../../../../log')\nvar TransportFormat = require('../../../../constants/transportFormat')\n\nvar HlsParser = Parser.extend(\n  /** @lends youbora.HlsParser.prototype */\n  {\n    /**\n     * Starts the HLS parsing from the given resource. The first (outside) call should set the\n     * parentResource to null.\n     *\n     * @param {string} resource Either the resource url or the manifest body.\n     * @param {string} parentResource Parent resource in case relative paths are sent.\n     */\n    parse: function (resource, lastManifest, parentResource) {\n      parentResource = parentResource || ''\n\n      try {\n        var matches = /((\\S*?)(\\.m3u8|\\.m3u|\\.ts|\\.m4s|\\.mp4|\\.cmfv)((\\?|;)\\S*|\\n|\\r|$))/i.exec(resource.replaceAll(',URI=', '\\n').replaceAll('\"', ''))\n      } catch (err) {\n        Log.warn('Parse HLS Regex failed', err)\n        this.done()\n      }\n\n      if (matches !== null) { // get first line ending in .m3u8, .m3u, .mp4, .cmfv or .ts\n        var res = matches[1].trim()\n        var prevParent = ''\n        var index = parentResource.lastIndexOf('/')\n        if (res.indexOf('http') !== 0 && index !== -1) {\n          // If does not start with http, add parentResource relative route.\n          if (res[0] === '/' && res[1] !== '/') {\n            // if its a relative route not using the same path, but the same domain\n            var ind = parentResource.indexOf('/') + 1\n            ind += parentResource.substr(ind, parentResource.length).indexOf('/') + 1 // Second '/'\n            ind += parentResource.substr(ind, parentResource.length).indexOf('/') // Third '/'\n            res = parentResource.slice(0, ind) + res\n          } else {\n            // if its sharing the (omitted) path\n            res = parentResource.slice(0, index) + '/' + res\n          }\n          prevParent = parentResource.slice(0, index) + '/'\n        }\n\n        if (matches[3] === '.m3u8' || matches[3] === '.m3u') { // It is m3u8 or m3u...\n          if (!lastManifest) {\n            var request = new YBRequest(res, null, null, { cache: true })\n\n            request.on(YBRequest.Event.SUCCESS, function (resp) {\n              this._parseWithManifest(resp, prevParent, matches)\n            }.bind(this))\n\n            request.on(YBRequest.Event.ERROR, function (resp) {\n              this.done()\n            }.bind(this))\n\n            request.send()\n          } else {\n            this._parseWithManifest(lastManifest, prevParent, matches)\n          }\n        } else { // It is mp4 or ts...\n          switch (matches[3]) {\n            case '.mp4':\n            case '.m4s':\n              this._transportFormat = TransportFormat.MP4\n              break\n            case '.ts':\n              this._transportFormat = TransportFormat.MPEG2\n              break\n            case '.cmfv':\n              this._transportFormat = TransportFormat.CMF\n          }\n          this._realResource = res\n          this.done()\n        }\n      } else {\n        this.done()\n      }\n    },\n\n    _parseWithManifest: function (resp, prevParent, matches) {\n      this._lastManifest = resp\n      this.parse(resp.getResponseText(), null, prevParent + matches[2])\n    },\n\n    shouldExecute: function (lastManifest) {\n      var ret = true\n      if (lastManifest) {\n        var response = lastManifest.getResponseText()\n        ret = response.indexOf('#EXTM3U') !== -1\n      }\n      return ret\n    }\n  }\n)\n\nmodule.exports = HlsParser\n","var Emitter = require('../../../emitter')\nvar Log = require('../../../log')\nvar Util = require('../../../util')\nvar YBRequest = require('../../request')\n\nvar CdnParser = Emitter.extend(\n  /** @lends youbora.CdnParser.prototype */\n  {\n    /**\n         * Class that asynchronously tries to get information about the CDN where a given resource is\n         * hosted.\n         *\n         * The info we care about is the CDN code itself, the node host and node type.\n         *\n         * The CDN is queried with http HEAD requests. This only will work if the CDN has been properly\n         * configured.\n         *\n         * When HEAD requests are performed against the resources, the CDN returns a set of headers that\n         * contain info about the cdn header and/or cdn type.\n         *\n         * Each CDN is different; some require special headers to be set when the HEAD request is\n         * performed and others don't. Also, the info can come back in any fashion of ways, sometimes\n         * both type and host come in the same response header while sometimes they're in different\n         * headers. The format of these response headers is also different from CDN to CDN, so a\n         * different regex is used for each CDN.\n         *\n         * Lastly, as the values indicating the CDN type are also different, we need a specific mapping\n         * for each one.\n         *\n         * Every instance of this class will represent a 'way' of parsing the HEAD response. So an\n         * instance should be created for Level3, Akamai, Highwinds, etc...\n         *\n         * @constructs CdnParser\n         * @extends youbora.Emitter\n         * @memberof youbora\n         *\n         * @param {object} options This object represents the configuration of a certain CDN parsing\n         * methodology.\n         * @param {string} options.cdnName see {@link CdnParser#setCdnName}.\n         * @param {array} options.parsers see {@link CdnParser#addParser}.\n         * @param {array} options.requestMethod see {@link CdnParser#setRequestMethod}.\n         * @param {array} options.requestHeaders see {@link CdnParser#setRequestHeader}.\n         * @param {function} options.parseType see {@link CdnParser#setParseType}.\n         */\n    constructor: function (options) {\n      this._options = Util.assign({\n        cdnName: null,\n        parsers: [],\n        requestMethod: 'HEAD',\n        requestHeaders: {},\n        parseType: function () { return 0 }\n      }, options)\n\n      this._responses = {}\n    },\n\n    /**\n         * Emits DONE event\n         */\n    done: function () {\n      this.emit(CdnParser.Event.DONE)\n    },\n\n    /**\n         * Adds an object that represents a parse step of the headers.\n         *\n         * Each parser item will define the element parsed (whether if it is a host, a type, both...)\n         * a headerName to parse (ie: x-cache) and a regex to execute over that header.\n         *\n         * @param {object} parser\n         * @param {string} parser.element Which element will be parsed from the request.\n         * Use {@link CdnParser.ElementType} enum.\n         * @param {string} parser.headerName Name of the header to parse.\n         * @param {regex} parser.regex Regex to match against the header content.\n         *\n         * @return itself to chain method calls\n         */\n    addParser: function (parser) {\n      this._options.parsers.push(parser)\n      return this\n    },\n\n    /**\n         * Sets the cdn name. Note that this names are provided by Youbora and must coincede with the\n         * ones offered here: {@link http://mapi.youbora.com:8081/cdns}.\n         *\n         * @return itself to chain method calls\n         */\n    setCdnName: function (name) {\n      this._options.cdnName = name\n      return this\n    },\n\n    /**\n         * Sets the method of the request. HEAD by default.\n         *\n         * @return itself to chain method calls\n         */\n    setRequestMethod: function (method) {\n      this._options.requestMethod = method\n      return this\n    },\n\n    /**\n         * if this CDN requires special headers to be set in order to respond with the info we want,\n         * add them using this method.\n         *\n         * @param {string} key Name of the header.\n         * @param {string} value Content of the header.\n         *\n         * @return itself to chain method calls\n         */\n    setRequestHeader: function (key, value) {\n      this._options.requestHeaders[key] = value\n      return this\n    },\n\n    /**\n         * Adds a parsing function for parsing the type (hit or miss) of the request.\n         *\n         * Parser fucntion will receive a string parsed from a type header (see\n         * {@link CdnParser#addParser}). Should return 1 in case of HIT, 2 in case of MISS and\n         * 0 otherwise.\n         *\n         * @param {function} parser Parsing function\n         *\n         * @return itself to chain method calls\n         */\n    setParseType: function (parser) {\n      this._options.parseType = parser\n      return this\n    },\n\n    /**\n         * Get parsed CDN name.\n         *\n         * @return {string} The CDN name or null if unknown\n         */\n    getParsedCdnName: function () {\n      return this._cdnName\n    },\n\n    /**\n         * Get the parsed CDN node.\n         *\n         * @return {string} The CDN node or null if unknown\n         */\n    getParsedNodeHost: function () {\n      return this._cdnNodeHost\n    },\n\n    /**\n         * Get the parsed CDN type string, as returned in the cdn header response.\n         *\n         * @return {string} The CDN type string\n         */\n    getParsedNodeTypeString: function () {\n      return this._cdnNodeTypeString\n    },\n\n    /**\n         * Get the parsed CDN type, parsed from the type string.\n         *\n         * @return {string} The CDN type\n         */\n    getParsedNodeType: function () {\n      return this._cdnNodeType\n    },\n\n    /**\n         * Returns the request responses from this CdnParser.\n         * This is filled with the responses from the constructor, or created empty if null.\n         * Then the performed request response (if any) is added to this map.\n         * Call this method after \"using\" the CdnParser and pass the responses to the following\n         * CdnParser so it can use the responses if it applies.\n         * @return the request responses\n         */\n    getResponses: function () {\n      return this._responses\n    },\n\n    /**\n         * Parses given headers to check for matches.\n         */\n    parse: function (url, responses) {\n      this._responses = responses || {}\n      var headerString = JSON.stringify(this._options.requestHeaders)\n      if (this._responses[headerString]) {\n        this._parseResponse(this._responses[headerString])\n      } else {\n        this._requestResponse(url)\n      }\n    },\n\n    _requestResponse: function (url) {\n      var headerString = JSON.stringify(this._options.requestHeaders)\n      var useheaders = headerString !== '{}'\n\n      var request = new YBRequest(url, null, null, {\n        method: this._options.requestMethod,\n        maxRetries: 0,\n        requestHeaders: this._options.requestHeaders,\n        cache: true\n      })\n\n      request.on(YBRequest.Event.SUCCESS, function (resp) {\n        this._responses[headerString] = resp.getResponseHeaders()\n        this._parseResponse(this._responses[headerString])\n      }.bind(this))\n\n      request.on(YBRequest.Event.ERROR, function (resp) {\n        if (useheaders) {\n          this._options.requestHeaders = {}\n          this._requestResponse(url)\n        } else {\n          this.done()\n        }\n      }.bind(this))\n\n      request.send()\n    },\n\n    _parseResponse: function (headers) {\n      this._options.parsers.forEach(function (parser) {\n        var headerName = (parser.headerName)\n          ? parser.headerName.toLowerCase()\n          : ''\n        if (headerName) {\n          headers.split('\\n').forEach(function (line) {\n            var index = line.indexOf(':')\n            if (index !== -1) {\n              var key = line.slice(0, index).toLowerCase()\n              if (key === headerName) {\n                this._executeParser(parser, line.slice(index + 1))\n              }\n            }\n          }.bind(this))\n        }\n      }.bind(this))\n      this.done()\n    },\n\n    _executeParser: function (parser, value) {\n      try {\n        var matches = parser.regex.exec(value.trim())\n        if (matches !== null) {\n          if (this._options.cdnName) this._cdnName = this._options.cdnName\n          switch (parser.element) {\n            case CdnParser.ElementType.HOST:\n              this._cdnNodeHost = matches[1]\n              break\n            case CdnParser.ElementType.TYPE:\n              this._cdnNodeTypeString = matches[1]\n              this._cdnNodeType = this._options.parseType(this._cdnNodeTypeString)\n              break\n            case CdnParser.ElementType.HOST_AND_TYPE:\n              this._cdnNodeHost = matches[1]\n              this._cdnNodeTypeString = matches[2]\n              this._cdnNodeType = this._options.parseType(this._cdnNodeTypeString)\n              break\n            case CdnParser.ElementType.TYPE_AND_HOST:\n              this._cdnNodeTypeString = matches[1]\n              this._cdnNodeType = this._options.parseType(this._cdnNodeTypeString)\n              this._cdnNodeHost = matches[2]\n              break\n            case CdnParser.ElementType.NAME:\n              this._cdnName = matches[1].toUpperCase()\n              break\n          }\n        }\n      } catch (err) {\n        Log.warn('CDN parsing for ' + this._options.cdnName +\n          ' could not parse header value ' + value)\n      }\n    },\n\n    shouldExecute: function () {\n      return true\n    }\n\n  },\n\n  /** @lends youbora.CdnParser */\n  {\n    // Static members\n\n    /**\n         * List of events that could be fired from this class.\n         *\n         * @enum\n         */\n    Event: {\n      /** Notifies that this CdnParser is done processing. */\n      DONE: 'done'\n    },\n\n    /**\n         * Possible different bits of info we can get from a header.\n         *\n         * @enum\n         */\n    ElementType: {\n      HOST: 'host',\n      TYPE: 'type',\n      HOST_AND_TYPE: 'host+type',\n      TYPE_AND_HOST: 'type+host',\n      NAME: 'name'\n    },\n\n    /**\n         * List of available CDN parsers.\n         * @private\n         */\n    _cdnConfigs: {},\n\n    /**\n         * This is a special case. The BalancerCdnParser is a custom CDN definition\n         * that tries to get the CDN name directly from one of the headers. This method can be used\n         * as a shortcut to creating a new CDN definition.\n         *\n         * This is usually used with DNS-based load balance services, such as Cedexis.\n         *\n         * Youboralib will use this method by itself using the configuration passed in the\n         * {@link Options}.\n         *\n         * @param {string} cdnNameHeader the header response name where to get the CDN name from.\n         */\n    setBalancerHeaderName: function (name) {\n      CdnParser._cdnConfigs.Balancer.parsers[0].headerName = name\n    },\n\n    /**\n         * Create one of the pre-defined CDN parsers. This method will be called with the keys passed\n         * to {@link Options#'parse.CdnNode.list'}.\n         *\n         * Before using this method, configs must be added first using {@link CdnParser.add}.\n         *\n         * @param {string} cdnName Name of the CDN\n         * @return {CdnParser} An instance or undefined if the names does not match any CDN.\n         */\n    create: function (key) {\n      if (CdnParser._cdnConfigs[key]) {\n        return new CdnParser(CdnParser._cdnConfigs[key])\n      } else {\n        Log.warn('Tried to create an unexisting CdnParser named ' + key)\n      }\n    },\n\n    /**\n         * Adds the given CdnParser's config to the available list. Objects sent must comply with\n         * CdnParser constructor.\n         *\n         * @param {string} key The name that will identify the CDN.\n         * @param {Object} config The parser that defines the CDN.\n         */\n    add: function (key, config) {\n      CdnParser._cdnConfigs[key] = config\n    }\n  }\n)\n\n// Adding built-in parsers\nCdnParser.add('Level3', require('./cdnparsers/level3'))\nCdnParser.add('Cloudfront', require('./cdnparsers/cloudfront'))\nCdnParser.add('Akamai', require('./cdnparsers/akamai'))\nCdnParser.add('Highwinds', require('./cdnparsers/highwinds'))\nCdnParser.add('Fastly', require('./cdnparsers/fastly'))\nCdnParser.add('Telefonica', require('./cdnparsers/telefonica'))\nCdnParser.add('Amazon', require('./cdnparsers/amazon'))\nCdnParser.add('Edgecast', require('./cdnparsers/edgecast'))\nCdnParser.add('Balancer', require('./cdnparsers/balancer'))\n\nmodule.exports = CdnParser\n","var YBRequest = require('../../../request')\nvar Parser = require('./parser')\nvar Log = require('../../../../log')\nvar TransportFormat = require('../../../../constants/transportFormat')\n\nvar DashParser = Parser.extend(\n  /** @lends youbora.DashParser.prototype */\n  {\n    /**\n     * Starts the Dash parsing from the given resource. The first (outside) call should set the\n     * parentResource to null.\n     *\n     * @param {string} resource The resource url.\n     */\n    parse: function (resource, lastManifest) {\n      if (!lastManifest) {\n        var request = new YBRequest(resource, null, null, { cache: true })\n\n        request.on(YBRequest.Event.SUCCESS, function (resp) {\n          this.parseLocation(resp, resource)\n        }.bind(this))\n\n        request.on(YBRequest.Event.ERROR, function (resp) {\n          this.done()\n        }.bind(this))\n\n        request.send()\n      } else {\n        this.parseLocation(lastManifest, resource)\n      }\n    },\n\n    parseLocation: function (lastManifest, resource) {\n      this.iterations--\n      var locationRegexp = new RegExp(/<Location>([\\s\\S]+)<\\/Location>/)\n      try {\n        this._lastManifest = lastManifest\n        var manifest = lastManifest.getResponseText()\n        var matches = locationRegexp.exec(manifest)\n\n        if (matches && matches[1]) {\n          var newRes = this._htmlDecode(matches[1].replace('\\n', ''))\n        }\n        if (newRes && newRes !== resource && this.iterations > 0) {\n          this.parse(newRes)\n        } else {\n          this.parseFinalResource(manifest, resource)\n        }\n      } catch (err) {\n        Log.warn('Dash parse failed')\n        this.done()\n      }\n    },\n\n    _htmlDecode: function (input) {\n      if (typeof document !== 'undefined' && typeof document.createElement === 'function') {\n        var e = document.createElement('textarea')\n        e.innerHTML = input\n        return e.childNodes && e.childNodes.length ? e.childNodes[0].nodeValue : input\n      }\n      return input\n    },\n\n    parseFinalResource: function (manifest, resource) {\n      var baseUrlRegexp = new RegExp(/<BaseURL>([\\s\\S]+)<\\/BaseURL>/)\n      var segmentUrlRegexp = new RegExp(/<SegmentURL[\\s\\S]*media=\"([^\"]+)/)\n      var segmentTemplateRegexp = new RegExp(/<SegmentTemplate[\\s\\S]*media=\"([^\"]+)/)\n      var matches = null\n      // first: base url, second: segment url, third: segment template\n      try {\n        matches = baseUrlRegexp.exec(manifest) || segmentTemplateRegexp.exec(manifest) || segmentUrlRegexp.exec(manifest)\n        this._getManifestMetadata(manifest)\n        if (matches && matches[1] && this._isFullUrl(matches[1])) {\n          if (matches[1].indexOf('\"') > 0) {\n            this._realResource = matches[1].substr(0, matches[1].indexOf('\"')).replace('\\n', '')\n          } else {\n            this._realResource = matches[1].replace('\\n', '')\n          }\n        } else {\n          this._realResource = resource\n        }\n      } catch (err) {\n        Log.warn('Dash manifest parse failed')\n      }\n      this.done()\n    },\n\n    _getManifestMetadata: function (manifest) {\n      try {\n        var transportFormatRegexp = new RegExp(/<AdaptationSet[\\s\\S]*mimeType=\"video\\/([^\"]+)/)\n        var matches = transportFormatRegexp.exec(manifest)\n        var ret = null\n        switch (matches[1]) {\n          case 'mp4':\n          case 'm4s':\n            ret = TransportFormat.MP4\n            break\n          case 'mp2t':\n            ret = TransportFormat.MPEG2\n            break\n          case 'cmfv':\n            ret = TransportFormat.CMF\n            break\n        }\n        this._transportFormat = ret\n      } catch (err) {\n        Log.warn('Couldnt find the transport format')\n      }\n    },\n\n    _isFullUrl: function (url) {\n      return url.indexOf('http') !== -1\n    },\n\n    shouldExecute: function (lastManifest) {\n      var ret = true\n      if (lastManifest) {\n        var response = lastManifest.getResponseText()\n        ret = response.indexOf('<MPD') !== -1\n      }\n      return ret\n    }\n  }\n)\n\nmodule.exports = DashParser\n","var YBRequest = require('../../../request')\nvar Parser = require('./parser')\n\nvar LocationheaderParser = Parser.extend(\n  /** @lends youbora.LocationheaderParser.prototype */\n  {\n    /**\n     * Parses given header to check.\n     */\n    parse: function (url, lastManifest) {\n      if (!lastManifest) {\n        this._realResource = url\n        var request = new YBRequest(url, null, null, {\n          cache: true\n        })\n\n        request.on(YBRequest.Event.SUCCESS, function (resp) {\n          this._parseWithManifest(resp)\n        }.bind(this))\n\n        request.on(YBRequest.Event.ERROR, function (resp) {\n          this.done()\n        }.bind(this))\n\n        request.send()\n      } else {\n        this._parseWithManifest(lastManifest)\n      }\n    },\n\n    _parseWithManifest: function (resp) {\n      this._lastManifest = resp\n      var response = resp.getResponseHeaders()\n      var found = false\n      response.split('\\n').forEach(function (line) {\n        if (line.startsWith('Location:')) {\n          this._realResource = line.slice(10)\n          this.parse(this._realResource)\n          found = true\n        }\n      }.bind(this))\n      if (!found) {\n        this.done()\n      }\n    }\n  }\n)\n\nmodule.exports = LocationheaderParser\n","var Transform = require('./transform')\n\nvar OfflineTransform = Transform.extend(\n  /** @lends youbora.OfflineTransform.prototype */\n  {\n    /**\n     * This class manages Fastdata service and view index.\n     *\n     * @constructs\n     * @extends youbora.Transform\n     * @memberof youbora\n     *\n     * @param {Plugin} plugin Instance of {@link Plugin}\n     * @param {string} session If provided, plugin will use this as a FD response.\n     */\n    constructor: function (plugin, session) {\n      this._sendRequest = false\n      this._isBusy = false\n      this.plugin = plugin\n      this.session = session\n      this.transformName = 'Offline'\n    },\n\n    /**\n     * Transform requests\n     * @param {youbora.comm.YBRequest} request YBRequest to transform.\n     */\n    parse: function (request) {\n      if (request && this.plugin.offlineStorage) {\n        this.plugin.offlineStorage.addEvent(request.service, request.params)\n      }\n    },\n\n    hasToSend: function (request) {\n      return false\n    },\n\n    getState: function () {\n      return Transform.STATE_OFFLINE\n    }\n\n  })\n\nmodule.exports = OfflineTransform\n","var YouboraObject = require('../object')\nvar DeprecatedOptions = require('./deprecatedOptions')\nvar Log = require('../log')\nvar TransportFormat = require('../constants/transportFormat')\nvar StreamingProtocol = require('../constants/streamingProtocols')\n\nvar Options = YouboraObject.extend(\n  /** @lends youbora.Options.prototype */\n  {\n    /**\n     * This Class store youbora configuration settings.\n     * Any value specified in this class, if set, will override the info the plugin is able to get\n     * on its own.\n     *\n     * @constructs Options\n     * @param {Object|Options} [options] A literal containing values.\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     */\n    constructor: function (options) {\n      /** @prop {boolean} [enabled=true] If false, the plugin won't send NQS requests. */\n      this.enabled = true\n\n      /** @prop {string} [host='a-fds.youborafds01.com'] Host of the Fastdata service. */\n      this.host = 'a-fds.youborafds01.com'\n\n      /**\n      * @prop {string} [accountCode='nicetest']\n      * NicePeopleAtWork account code that indicates the customer account.\n      */\n      this.accountCode = 'nicetest'\n\n      /**\n      *  @prop {boolean} [preventZombieViews=true]\n      * If true, the plugin will check if the last event\n      * was sent more than 10 mins ago\n      * so it will not send more events to the same view\n      */\n      this.preventZombieViews = true\n\n      /**\n      * @prop {boolean} [offline=false]\n      * If true the plugin will store the events and send them later when there's connection\n      */\n      this.offline = false\n\n      /** @prop {string} [referer] Site url.\n      *  By default window.location.href */\n      this.referer = null\n\n      /** @prop {string} [referral] Previous site url.\n      *  By default document.referrer */\n      this.referral = null\n\n      /**\n      * @prop {boolean} [disableCookies]\n      * To disable cookies storage fallback after local/sessionstorage\n      * True by default\n      */\n      this.disableCookies = true\n\n      /**\n      * @prop {boolean} [disableStorage]\n      * To disable all possible storages usage (cookies, localStorage, sessionStorage)\n      * CAUTION: enabling this option session tracking may stop to work properly\n      * False by default\n      */\n      this.disableStorage = false\n\n      // USER\n\n      /**\n      * @prop {string} [user.email]\n      * User email.\n      */\n      this['user.email'] = null\n\n      /**\n      * @prop {string} [user.type]\n      * User type.\n      */\n      this['user.type'] = null\n\n      /**\n      * @prop {string} [user.name]\n      * User ID value inside your system.\n      */\n      this['user.name'] = null\n\n      /**\n      *  @prop {boolean} [user.obfuscateIp=false]\n      * If true, the view will have the IP obfuscated\n      */\n      this['user.obfuscateIp'] = false\n\n      /**\n      * @prop {string} [user.anonymousId]\n      * Anonymous identifyer of the user provided by the customer.\n      */\n      this['user.anonymousId'] = null\n\n      // PARSERS\n\n      /**\n      * @prop {boolean} [parse.manifest=false]\n      * If true the plugin will look for location value in manifest header to retrieve the actual resource,\n      * will parse HLS files to use the first .ts file found as resource and\n      * will look for location and segment values inside DASH manifest to retrieve the actual resource\n      * It might slow performance down.\n      */\n      this['parse.manifest'] = false\n\n      /**\n      * @prop {string} [parse.CdnNameHeader]\n      * If defined, resource parse will try to fetch the CDN code from the custom header defined\n      * by this property. ie: 'x-cdn-forward'\n      */\n      this['parse.cdnNameHeader'] = 'x-cdn-forward'\n\n      /**\n      * @prop {boolean} [parse.CdnNode=false]\n      * If true the plugin will query the CDN to retrieve the node name.\n      * It might slow performance down.\n      */\n      this['parse.cdnNode'] = false\n\n      /**\n      * @prop {array<string>} [parse.CdnNode.list=false]\n      * If true the plugin will query the CDN to retrieve the node name.\n      * It might slow performance down.\n      */\n      this['parse.cdnNode.list'] = ['Akamai', 'Amazon', 'Cloudfront', 'Level3', 'Fastly', 'Highwinds', 'Telefonica', 'Edgecast']\n\n      /**\n       * @prop {function} [parse.fdsResponseHost=null]\n       * Parses fastdata response to modify the host where the requests will be sent\n       */\n      this['parse.fdsResponseHost'] = null\n\n      /**\n       * @prop {function} [parse.cdnSwitchHeader=false]\n       * Parses a video chunk or manifest every x seconds to read the x-cdn header and report it\n       */\n      this['parse.cdnSwitchHeader'] = false\n\n      /**\n       * @prop {function} [parse.cdnTTL=60]\n       * if parse.cdnSwitchHeader enabled, the time between new requests\n       */\n      this['parse.cdnTTL'] = 60\n\n      // NETWORK\n\n      /** @prop {string} [network.ip] IP of the viewer/user. ie= '100.100.100.100'. */\n      this['network.ip'] = null\n\n      /** @prop {string} [network.isp] Name of the internet service provider of the viewer/user. */\n      this['network.isp'] = null\n\n      /**\n      * @prop {string} [network.connectionType]\n      * Type of connection used\n      */\n      this['network.connectionType'] = null\n\n      // DEVICE\n\n      /**\n       * @prop {string} [device.id]\n       * Unique identifyer of the device. If set it will consider the value as the device id.\n       * By default the plugin tries to generate a unique id based on exposed information on the browser.\n       * It wont be sent if 'device.isAnonymous option' is set to true.\n       */\n      this['device.id'] = null\n\n      /**\n      * @prop {string} [device.code]\n      * Youbora's device code. If specified it will rewrite info gotten from user agent.\n      * See a list of codes in {@link http://mapi.youbora.com:8081/devices}\n      */\n      this['device.code'] = null\n\n      /**\n      * @prop {string} [device.model]\n      * Device model name\n      */\n      this['device.model'] = null\n\n      /**\n      * @prop {string} [device.brand]\n      * Device vendor name\n      */\n      this['device.brand'] = null\n\n      /**\n      * @prop {string} [device.type]\n      * Device type (pc, smartphone, stb, tv, etc.)\n      */\n      this['device.type'] = null\n\n      /**\n      * @prop {string} [device.name]\n      * Device name. It must exist in NPAW database.\n      */\n      this['device.name'] = null\n\n      /**\n      * @prop {string} [device.osName]\n      * OS name.\n      */\n      this['device.osName'] = null\n\n      /**\n      * @prop {string} [device.osVersion]\n      * OS version.\n      */\n      this['device.osVersion'] = null\n\n      /**\n      * @prop {string} [device.browserName]\n      * Browser name.\n      */\n      this['device.browserName'] = null\n\n      /**\n      * @prop {string} [device.browserVersion]\n      * Browser version.\n      */\n      this['device.browserVersion'] = null\n\n      /**\n      * @prop {string} [device.browserType]\n      * Browser type.\n      */\n      this['device.browserType'] = null\n\n      /**\n      * @prop {string} [device.browserEngine]\n      * Browser engine.\n      */\n      this['device.browserEngine'] = null\n\n      /**\n      * @prop {bool} [device.isAnonymous]\n      * If true, it blocks 'deviceUUID' parameter in requests.\n      */\n      this['device.isAnonymous'] = false\n\n      // CONTENT\n\n      /** @prop {string} [content.transactionCode] Custom unique code to identify the view. */\n      this['content.transactionCode'] = null\n\n      /** @prop {string} [content.resource] URL/path of the current media resource. */\n      this['content.resource'] = null\n\n      /** @prop {boolean} [content.isLive] True if the content is live false if VOD. */\n      this['content.isLive'] = null\n\n      /** @prop {boolean} [content.isLive.noSeek] True if the player seeks automatically when resumed or ending buffer. Only for live content */\n      this['content.isLive.noSeek'] = false\n\n      /** @prop {string} [content.title] Title of the media. */\n      this['content.title'] = null\n\n      /** @prop {string} [content.program] Secondary title of the media */\n      this['content.program'] = null\n\n      /** @prop {number} [content.duration] Duration of the media. */\n      this['content.duration'] = null\n\n      /** @prop {int} [content.fps] Frames per second of the content in the current moment. */\n      this['content.fps'] = null\n\n      /** @prop {int} [content.bitrate] Bitrate of the content in bits per second. */\n      this['content.bitrate'] = null\n\n      /** @prop {int} [content.totalBytes] Total downloaded bytes of the content. */\n      this['content.totalBytes'] = null\n\n      /** @prop {bool} [content.sendTotalBytes] Additionaly report totalbytes or not, default false. */\n      this['content.sendTotalBytes'] = false\n\n      /** @prop {int} [content.throughput] Throughput of the client bandwith in bits per second. */\n      this['content.throughput'] = null\n\n      /** @prop {string} [content.rendition] Name of the current rendition of the content. */\n      this['content.rendition'] = null\n\n      /**\n       * @prop {string} [content.cdn]\n       * Codename of the CDN where the content is streaming from.\n       * See a list of codes in {@link http://mapi.youbora.com:8081/cdns}\n       * */\n      this['content.cdn'] = null\n\n      /** @prop {string} [content.cdnNode] CDN node id */\n      this['content.cdnNode'] = null\n\n      /** @prop {int} [content.cdnType] CDN node content access type\n       * It defines if the content request hits the cache or not\n       * TCP_HIT / HIT: 1\n       * TCP_MISS / MISS: 2\n       * TCP_MEM_HIT: 3\n       * TCP_IMS_HIT: 4\n       */\n      this['content.cdnType'] = null\n\n      /**\n       * @prop {object} [content.metadata]\n       * Item containing mixed extra information about the content like: director, parental rating,\n       * device info or the audio channels.This object may store any serializable key:value info.\n       */\n      this['content.metadata'] = {}\n\n      /**\n       * @prop {object} [content.metrics]\n       * Item containing metrics in json format. Reported every ping if the values change\n       */\n      this['content.metrics'] = {}\n\n      /** @prop {string} [content.streamingProtocol] Name of the streaming media protocol.\n       * Can be:\n       *   - HDS (Adobe HDS)\n       *   - HLS (Apple HLS)\n       *   - MSS (Microsoft Smooth Streaming)\n       *   - DASH (MPEG-DASH)\n       *   - RTMP (Adobe RTMP)\n       *   - RTP (RTP)\n       *   - RTSP (RTSP)\n       */\n      this['content.streamingProtocol'] = null\n\n      /** @prop {string} [content.transportFormat] Name of the transport format.\n       * Can be:\n       *   - TS (MPEG-2 TS)\n       *   - MP$ (Fragmented MP4)\n       */\n      this['content.transportFormat'] = null\n\n      /** @prop {number} [content.package] Package of the media. */\n      this['content.package'] = null\n\n      /** @prop {number} [content.saga] Saga of the media. */\n      this['content.saga'] = null\n\n      /** @prop {number} [content.tvShow] TV Show of the media. */\n      this['content.tvShow'] = null\n\n      /** @prop {number} [content.season] Season of the media. */\n      this['content.season'] = null\n\n      /** @prop {number} [content.episodeTitle] Episode title of the media. */\n      this['content.episodeTitle'] = null\n\n      /** @prop {number} [content.channel] Channel name of the media. */\n      this['content.channel'] = null\n\n      /** @prop {number} [content.id] ID of the media. */\n      this['content.id'] = null\n\n      /** @prop {number} [content.imdbId] IMDB id of the media. */\n      this['content.imdbId'] = null\n\n      /** @prop {number} [content.gracenoteId] Gracenote id of the media. */\n      this['content.gracenoteId'] = null\n\n      /** @prop {number} [content.type] Type of the media. */\n      this['content.type'] = null\n\n      /** @prop {number} [content.genre] Genre of the media. */\n      this['content.genre'] = null\n\n      /** @prop {number} [content.language] Language of the media. */\n      this['content.language'] = null\n\n      /** @prop {number} [content.subtitles] Subtitles of the media. */\n      this['content.subtitles'] = null\n\n      /** @prop {number} [content.contractedResolution] Contracted Resolution of the media. */\n      this['content.contractedResolution'] = null\n\n      /** @prop {number} [content.cost] Cost of the media. */\n      this['content.cost'] = null\n\n      /** @prop {number} [content.price] Price of the media. */\n      this['content.price'] = null\n\n      /** @prop {number} [content.playbackType] Type of the media. Can be Vod, Live, catch-up or offline */\n      this['content.playbackType'] = null\n\n      /** @prop {number} [content.drm] DRM of the media. */\n      this['content.drm'] = null\n\n      // Encoding\n\n      /** @prop {number} [content.encoding.videoCodec] Video codec of the media. */\n      this['content.encoding.videoCodec'] = null\n\n      /** @prop {number} [content.encoding.audioCodec] Audio codec of the media. */\n      this['content.encoding.audioCodec'] = null\n\n      /** @prop {number} [content.encoding.codecSettings] Codec settings of the media. */\n      this['content.encoding.codecSettings'] = null\n\n      /** @prop {number} [content.encoding.codecProfile] Codec profile of the media. */\n      this['content.encoding.codecProfile'] = null\n\n      /** @prop {number} [content.encoding.containerFormat] Container format of the media. */\n      this['content.encoding.containerFormat'] = null\n\n      // ADS\n\n      /**\n      * @prop {object} [ad.metadata]\n      * Item containing mixed extra information about ads like: request url.\n      * This object may store any serializable key:value info.\n      */\n      this['ad.metadata'] = {}\n\n      /**\n      * @prop {string} [ad.campaign]\n      * String containing the name of the campaign\n      */\n      this['ad.campaign'] = null\n\n      /**\n      * @prop {string} [ad.creativeId]\n      * String containing the id of the creative\n      */\n      this['ad.creativeId'] = null\n\n      /**\n      * @prop {string} [ad.provider]\n      * String containing the provider of the ad\n      */\n      this['ad.provider'] = null\n\n      /**\n      * @prop {string} [ad.resource]\n      * String containing the ad resource\n      */\n      this['ad.resource'] = null\n\n      /**\n      * @prop {string} [ad.title]\n      * String containing the title of the campaign\n      */\n      this['ad.title'] = null\n\n      /**\n      * @prop {object} [ad.expectedPattern]\n      * Json with the position of the breaks expected.\n      * Arrays are the number of breaks, and the numbers in them, the number of ads for each break\n      *\n      * Example:\n      * {pre: [1],\n      * mid: [1,2],\n      * post: [1]}\n      * Would be a view with 1 preroll break with 1 ad, 2 midroll breaks, one with 1 ad and\n      * the other with 2, and one postroll break with 1 ad.\n      */\n      this['ad.expectedPattern'] = null\n\n      /**\n      * @prop {string} [ad.givenAds]\n      * Number of ads given by the adserver for this break\n      */\n      this['ad.givenAds'] = null\n\n      /**\n      * @prop {array<int>} [ad.breaksTime]\n      * Array of ints for the time position of adbreaks\n      */\n      this['ad.breaksTime'] = null\n\n      /**\n      * @prop {string} [ad.expectedBreaks]\n      * Number of breaks expected for the view\n      */\n      this['ad.expectedBreaks'] = null\n\n      /**\n      * @prop {int} [ad.givenBreaks]\n      * Number of breaks given by the adserver for the view\n      */\n      this['ad.givenBreaks'] = null\n\n      /**\n      * @prop {boolean} [ad.ignore]\n      * False by default.\n      * If true, youbora blocks ad events and calculates jointime ignoring ad time.\n      */\n      this['ad.ignore'] = false\n\n      /**\n      * @prop {boolean} [ad.blockDetection]\n      * False by default.\n      * If true, youbora sends a request to an url that looks like an ad to check if it has response.\n      */\n      this['ad.blockDetection'] = false\n\n      // APP\n\n      /**\n      * @prop {string} [app.name]\n      * String containing the name of the app\n      */\n      this['app.name'] = null\n\n      /**\n      * @prop {string} [app.releaseVerson]\n      * String containing the app version\n      */\n      this['app.releaseVersion'] = null\n\n      /**\n      * @prop {boolean} [app.https=null]\n      * Define the security of NQS calls.\n      * If true it will use 'https://',\n      * if false it will use 'http://',\n      * if null/undefined it will use '//'.\n      */\n      this['app.https'] = false\n\n      // BACKGROUND\n\n      /**\n      *  @prop {boolean} [background.enabled=false]\n      * If true, plugin will send background/foreground events\n      * Different device behaviour is settable in background.settings\n      */\n      this['background.enabled'] = true\n\n      /**\n      *  @prop {string} [background.settings]\n      * Action to do when the browser goes to background.\n      * Options are 'stop', 'pause', and '' for no action.\n      * stop will be used to stop the view and track post-foreground events in a new view\n      * pause will be used when after foreground event, an action like pressing play button is expected to resume the content\n      * '' will be used if the content can be played in background\n      * If not defined, specific device options will be used\n      * background.setings.android / background.settings.iOS / background.settings.desktop / background.settings.tv\n      * Default specific device values are stop for android and iphone, nothing for desktop.\n      */\n      this['background.settings'] = null\n\n      /**\n      *  @prop {string} [background.settings.android='stop']\n      * If background.settings is not defined, action to do when the browser goes to background if\n      * the device is android type.\n      * Options are 'stop', 'pause', and '' or not defined for no action.\n      * bg by default\n      */\n      this['background.settings.android'] = 'stop'\n\n      /**\n      *  @prop {string} [background.settings.iOS='stop']\n      * If background.settings is not defined, action to do when the browser goes to background if\n      * the device is iphone type.\n      * Options are 'stop', 'pause', and '' or not defined for no action.\n      * bg by default\n      */\n      this['background.settings.iOS'] = 'stop'\n\n      /**\n      *  @prop {string} [background.settings.desktop=null]\n      * If background.settings is not defined, action to do when the browser goes to background if\n      * the device is desktop type.\n      * Options are 'stop', 'pause', and '' or not defined for no action.\n      * Null by default\n      */\n      this['background.settings.desktop'] = null\n\n      /**\n      *  @prop {string} [background.settings.tv='stop']\n      * If background.settings is not defined, action to do when the browser goes to background if\n      * the device is smartTV type.\n      * Options are 'stop', 'pause', and '' or not defined for no action.\n      * bg by default\n      */\n      this['background.settings.tv'] = 'stop'\n\n      /**\n      *  @prop {string} [background.settings.playstation='stop']\n      * If background.settings is not defined, action to do when the browser goes to background if\n      * the device is playstation type.\n      * Options are 'stop', 'pause', and '' or not defined for no action.\n      * Null by default\n      */\n      this['background.settings.playstation'] = 'stop'\n\n      // SMARTSWITCH\n\n      /**\n      *  @prop {string} [smartswitch.configCode]\n      * Config code for smartswitch\n      * null by default\n      */\n      this['smartswitch.configCode'] = null\n\n      /**\n      *  @prop {string} [smartswitch.groupCode]\n      * Group code for smartswitch\n      * null by default\n      */\n      this['smartswitch.groupCode'] = null\n\n      /**\n      *  @prop {string} [smartswitch.contractCode]\n      * Contract code for smartswitch\n      * null by default\n      */\n      this['smartswitch.contractCode'] = null\n\n      // EXTRAPARAMS // CUSTOM DIMENSIONS\n\n      /** @prop {string} [content.customDimension.1] Custom parameter 1. */\n      this['content.customDimension.1'] = null\n\n      /** @prop {string} [content.customDimension.2] Custom parameter 2. */\n      this['content.customDimension.2'] = null\n\n      /** @prop {string} [content.customDimension.3] Custom parameter 3. */\n      this['content.customDimension.3'] = null\n\n      /** @prop {string} [content.customDimension.4] Custom parameter 4. */\n      this['content.customDimension.4'] = null\n\n      /** @prop {string} [content.customDimension.5] Custom parameter 5. */\n      this['content.customDimension.5'] = null\n\n      /** @prop {string} [content.customDimension.6] Custom parameter 6. */\n      this['content.customDimension.6'] = null\n\n      /** @prop {string} [content.customDimension.7] Custom parameter 7. */\n      this['content.customDimension.7'] = null\n\n      /** @prop {string} [content.customDimension.8] Custom parameter 8. */\n      this['content.customDimension.8'] = null\n\n      /** @prop {string} [content.customDimension.9] Custom parameter 9. */\n      this['content.customDimension.9'] = null\n\n      /** @prop {string} [content.customDimension.10] Custom parameter 10. */\n      this['content.customDimension.10'] = null\n\n      /** @prop {string} [content.customDimension.11] Custom parameter 11. */\n      this['content.customDimension.11'] = null\n\n      /** @prop {string} [content.customDimension.12] Custom parameter 12. */\n      this['content.customDimension.12'] = null\n\n      /** @prop {string} [content.customDimension.13] Custom parameter 13. */\n      this['content.customDimension.13'] = null\n\n      /** @prop {string} [content.customDimension.14] Custom parameter 14. */\n      this['content.customDimension.14'] = null\n\n      /** @prop {string} [content.customDimension.15] Custom parameter 15. */\n      this['content.customDimension.15'] = null\n\n      /** @prop {string} [content.customDimension.16] Custom parameter 16. */\n      this['content.customDimension.16'] = null\n\n      /** @prop {string} [content.customDimension.17] Custom parameter 17. */\n      this['content.customDimension.17'] = null\n\n      /** @prop {string} [content.customDimension.18] Custom parameter 18. */\n      this['content.customDimension.18'] = null\n\n      /** @prop {string} [content.customDimension.19] Custom parameter 19. */\n      this['content.customDimension.19'] = null\n\n      /** @prop {string} [content.customDimension.20] Custom parameter 20. */\n      this['content.customDimension.20'] = null\n\n      /** @prop {string} [ad.customDimension.1] Ad custom parameter 1. */\n      this['ad.customDimension.1'] = null\n\n      /** @prop {string} [ad.customDimension.2] Ad custom parameter 2. */\n      this['ad.customDimension.2'] = null\n\n      /** @prop {string} [ad.customDimension.3] Ad custom parameter 3. */\n      this['ad.customDimension.3'] = null\n\n      /** @prop {string} [ad.customDimension.4] Ad custom parameter 4. */\n      this['ad.customDimension.4'] = null\n\n      /** @prop {string} [ad.customDimension.5] Ad custom parameter 5. */\n      this['ad.customDimension.5'] = null\n\n      /** @prop {string} [ad.customDimension.6] Ad custom parameter 6. */\n      this['ad.customDimension.6'] = null\n\n      /** @prop {string} [ad.customDimension.7] Ad custom parameter 7. */\n      this['ad.customDimension.7'] = null\n\n      /** @prop {string} [ad.customDimension.8] Ad custom parameter 8. */\n      this['ad.customDimension.8'] = null\n\n      /** @prop {string} [ad.customDimension.9] Ad custom parameter 9. */\n      this['ad.customDimension.9'] = null\n\n      /** @prop {string} [ad.customDimension.10] Ad custom parameter 10. */\n      this['ad.customDimension.10'] = null\n\n      /** @prop {bool} [forceInit] Forces init to be sent instead of start, use it when mediaduration,\n      *  title, source or is live is reported with a wrong value by the player until jointime happens */\n      this.forceInit = false\n\n      /**\n      * @prop {object} [session.metrics]\n      * Item containing metrics in json format. Reported every beat if the values change\n      */\n      this['session.metrics'] = {}\n\n      /**\n      * @prop {bool} [session.context]\n      * Boolean to choose to report context or not. False by default\n      */\n      this['session.context'] = false\n\n      /**\n      * @prop {array<string>} [errors.fatal=[]]\n      * If it has elements on it, all the errors matching this code will fire the stop event to end the view\n      */\n      this['errors.fatal'] = []\n\n      /**\n      * @prop {array<string>} [errors.nonFatal=[]]\n      * If it has elements on it, all the errors matching this code won't fire a stop event to end the view\n      */\n      this['errors.nonFatal'] = []\n\n      /**\n      * @prop {array<string>} [errors.ignore=[]]\n      * If it has elements on it, all the errors matching this code wont be reported\n      */\n      this['errors.ignore'] = []\n\n      /**\n       * @prop {string} linkedViewId\n       * String to send on start events to link views with previous session events\n       */\n      this.linkedViewId = null\n\n      /**\n      * @prop {bool} [waitForMetadata]\n      * Boolean to delay the start event. Use with `pendingMetadata`\n      */\n      this.waitForMetadata = false\n\n      /**\n      * @prop {array<string>} [pendingMetadata]\n      * List of values that should be ready to send in start event. Use with `waitForMetadata` set to True.\n      */\n      this.pendingMetadata = []\n\n      this.setOptions(options)\n    },\n\n    /**\n    * Recursively sets the properties present in the params object.\n    * ie: this.username = params.username.\n    *\n    * @param {Object} options A literal or another Data containing values.\n    * @param {Object} [base=this] Start point for recursion.\n    */\n    setOptions: function (options, base) {\n      var isInBase = false\n      if (base === undefined) {\n        base = this\n        isInBase = true\n        var deprecatedOptions = new DeprecatedOptions()\n      }\n      if (typeof options !== 'undefined') {\n        for (var key in options) {\n          var deprecated = false\n          var newKey = null\n          if (isInBase) {\n            if (!this.hasOwnProperty(key)) { // eslint-disable-line no-prototype-builtins\n              if (deprecatedOptions.exists(key)) {\n                newKey = deprecatedOptions.getNewName(key)\n                deprecated = true\n              } else {\n                Log.warn('The option \"' + key + '\" does not exist, so it cannot be set')\n              }\n            }\n          }\n          if ((typeof base[key] === 'object' && base[key] !== null) && (!Array.isArray(base[key]) && key === 'parse.cdnNode.list')) {\n            this.setOptions(options[key], base[key])\n          } else {\n            if (deprecated) {\n              base[newKey] = options[key]\n            } else {\n              base[key] = options[key]\n            }\n          }\n        }\n      }\n    },\n\n    /**\n    * Sets all the values given in an array as extraparams. Limit is 20\n    * @param {array<string>} paramsArray array of extraparam strings\n    * */\n    setExtraParams: function (paramsArray) {\n      var maxLength = 20\n      if (typeof paramsArray !== 'object' || !paramsArray.length) return\n      if (paramsArray.length >= maxLength) paramsArray = paramsArray.slice(0, maxLength)\n      while (paramsArray.length < maxLength) {\n        paramsArray.push(null)\n      }\n      paramsArray.forEach(function (param, index) {\n        this['content.customDimension.' + (index + 1).toString()] = param\n      }.bind(this))\n    },\n\n    /**\n    * @alias youbora.options.prototype.setExtraParams.\n    */\n    setCustomDimensions: function () {\n      Options.prototype.setExtraParams.apply(this, arguments)\n    },\n\n    /**\n    * Sets all the values given in an array as extraparams. Limit is 10\n    * @param {array<string>} paramsArray array of extraparam strings\n    * */\n    setAdExtraParams: function (paramsArray) {\n      var maxLength = 10\n      if (typeof paramsArray !== 'object' || !paramsArray.length) return\n      if (paramsArray.length >= maxLength) paramsArray = paramsArray.slice(0, maxLength)\n      while (paramsArray.length < maxLength) {\n        paramsArray.push(null)\n      }\n      paramsArray.forEach(function (param, index) {\n        this['ad.customDimension.' + (index + 1).toString()] = param\n      }.bind(this))\n    },\n\n    /**\n    * @alias youbora.options.prototype.setAdExtraParams.\n    */\n    setAdCustomDimensions: function () {\n      Options.prototype.setAdExtraParams.apply(this, arguments)\n    }\n  }, {\n  // Constants\n    StreamingProtocol: StreamingProtocol,\n    TransportFormat: TransportFormat\n  }\n)\n\nmodule.exports = Options\n","/**\n * List of streaming protocols\n *   - HDS (Adobe HDS)\n *   - HLS (Apple HLS)\n *   - MSS (Microsoft Smooth Streaming)\n *   - DASH (MPEG-DASH)\n *   - RTMP (Adobe RTMP)\n *   - RTP (RTP)\n *   - RTSP (RTSP)\n */\nvar StreamingProtocol = {\n  HDS: 'HDS',\n  HLS: 'HLS',\n  MSS: 'MSS',\n  DASH: 'DASH',\n  RTMP: 'RTMP',\n  RTP: 'RTP',\n  RTSP: 'RTSP'\n}\n\nmodule.exports = StreamingProtocol\n","var YouboraObject = require('../object')\nvar Log = require('../log')\n\nvar startParams = [\n  'accountCode',\n  'username',\n  'anonymousUser',\n  'rendition',\n  'deviceInfo',\n  'player',\n  'title',\n  'title2',\n  'live',\n  'mediaDuration',\n  'mediaResource',\n  'parsedResource',\n  'transactionCode',\n  'properties',\n  'cdn',\n  'playerVersion',\n  'param1',\n  'param2',\n  'param3',\n  'param4',\n  'param5',\n  'param6',\n  'param7',\n  'param8',\n  'param9',\n  'param10',\n  'param11',\n  'param12',\n  'param13',\n  'param14',\n  'param15',\n  'param16',\n  'param17',\n  'param18',\n  'param19',\n  'param20',\n  'playerStartupTime',\n  'obfuscateIp',\n  'p2pEnabled',\n  'pluginVersion',\n  'pluginInfo',\n  'isp',\n  'connectionType',\n  'ip',\n  'referer',\n  'userType',\n  'streamingProtocol',\n  'transportFormat',\n  'householdId',\n  'adsBlocked',\n  'adsExpected',\n  'deviceUUID',\n  'smartswitchConfigCode',\n  'smartswitchGroupCode',\n  'smartswitchContractCode',\n  'libVersion',\n  'nodeHost',\n  'nodeType',\n  'appName',\n  'appReleaseVersion',\n  'package',\n  'saga',\n  'tvshow',\n  'season',\n  'titleEpisode',\n  'channel',\n  'imdbID',\n  'gracenoteID',\n  'contentType',\n  'genre',\n  'contentLanguage',\n  'subtitles',\n  'cost',\n  'price',\n  'playbackType',\n  'email',\n  'drm',\n  'videoCodec',\n  'audioCodec',\n  'codecSettings',\n  'codecProfile',\n  'containerFormat',\n  'contentId',\n  'contractedResolution',\n  'linkedViewId'\n]\n\nvar adStartParams = [\n  'playhead',\n  'adTitle',\n  'position',\n  'adDuration',\n  'adCampaign',\n  'adCreativeId',\n  'adProvider',\n  'adResource',\n  'adPlayerVersion',\n  'adProperties',\n  'adAdapterVersion',\n  'adInsertionType',\n  'extraparam1',\n  'extraparam2',\n  'extraparam3',\n  'extraparam4',\n  'extraparam5',\n  'extraparam6',\n  'extraparam7',\n  'extraparam8',\n  'extraparam9',\n  'extraparam10',\n  'fullscreen',\n  'audio',\n  'skippable',\n  'adNumber',\n  'breakNumber'\n]\n\nvar RequestBuilder = YouboraObject.extend(\n  /** @lends youbora.RequestBuilder.prototype */\n  {\n    /**\n     * This class helps building params associated with each event: /start, /joinTime...\n     *\n     * @constructs RequestBuilder\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     *\n     * @param {Plugin} plugin A Plugin instance\n     */\n    constructor: function (plugin) {\n      this._plugin = plugin\n      this._adNumber = 0\n\n      /** Stores a list of the last params fetched */\n      this.lastSent = {}\n    },\n\n    /**\n     * Adds to params all the entities specified in paramList, unless they are already set.\n     *\n     * @param {Object} params Object of params key:value.\n     * @param {Array.string} paramList A list of params to fetch.\n     * @param {bool} onlyDifferent If true, only fetches params that have changed\n     */\n    fetchParams: function (params, paramList, onlyDifferent) {\n      params = params || {}\n      paramList = paramList || []\n      for (var i = 0; i < paramList.length; i++) {\n        var param = paramList[i]\n\n        if (params[param]) { continue }\n        var getterName = RequestBuilder.getters[param]\n\n        if (this._plugin[getterName]) {\n          var value = this._plugin[getterName]()\n          if (value !== null && (!onlyDifferent || this.lastSent[param] !== value)) {\n            params[param] = value\n            this.lastSent[param] = value\n          }\n        } else {\n          Log.warn('Trying to call undefined getter ' + param + ':' + getterName)\n        }\n      }\n      return params\n    },\n\n    getGetters: function () {\n      return RequestBuilder.getters\n    },\n\n    buildBody: function (service) {\n      var body = null\n      return this.fetchParams(body, RequestBuilder.bodyParams[service], false)\n    },\n\n    /**\n     * Adds to params object all the entities specified in paramList, unless they are already set.\n     *\n     * @param {Object} params Object of params key:value.\n     * @param {string} service The name of the service. Use {@link Plugin.Service} enum.\n     */\n    buildParams: function (params, service) {\n      params = params || {}\n      this.fetchParams(params, RequestBuilder.params[service], false)\n      this.fetchParams(params, RequestBuilder.differentParams[service], true)\n      return params\n    },\n\n    /**\n     * Creates an adnumber if it does not exist and stores it in lastSent. If it already exists,\n     * it is incremented by 1.\n     *\n     * @returns {number} adNumber\n     */\n    getNewAdNumber: function () {\n      var adNumber = this.lastSent.adNumber\n      if (adNumber && this.lastSent.position === this._plugin.getAdPosition()) {\n        adNumber += 1\n      } else {\n        adNumber = 1\n      }\n      this.lastSent.adNumber = adNumber\n      return adNumber\n    },\n\n    /**\n * Creates an breaknumber if it does not exist and stores it in lastSent. If it already exists,\n * it is incremented by 1.\n *\n * @returns {number} breakNumber\n */\n    getNewBreakNumber: function () {\n      var breakNumber = 1\n      if (this.lastSent.breakNumber) {\n        breakNumber = this.lastSent.breakNumber + 1\n      }\n      this.lastSent.breakNumber = breakNumber\n      return breakNumber\n    },\n\n    /**\n     * Return changed entities since last check\n     *\n     * @returns {Object} params\n     */\n    getChangedEntities: function () {\n      return this.fetchParams({}, RequestBuilder.differentParams.entities, true)\n    }\n  },\n  /** @lends youbora.RequestBuilder */\n  {\n    // Static Members\n\n    /** List of params used by each service */\n    params: {\n      '/data': ['system', 'pluginVersion', 'requestNumber', 'username'],\n\n      '/init': startParams,\n      '/start': startParams,\n      '/joinTime': ['joinDuration', 'playhead', 'bitrate'],\n      '/pause': ['playhead'],\n      '/resume': ['pauseDuration', 'playhead'],\n      '/seek': ['seekDuration', 'playhead'],\n      '/bufferUnderrun': ['bufferDuration', 'playhead'],\n      '/error': ['player', 'playhead'].concat(startParams),\n      '/stop': ['bitrate', 'totalBytes', 'playhead', 'pauseDuration', 'metrics'],\n\n      '/infinity/video/event': [],\n\n      '/adInit': adStartParams,\n      '/adStart': adStartParams,\n      '/adJoin': ['playhead', 'position', 'adJoinDuration', 'adPlayhead', 'adNumber', 'breakNumber'],\n      '/adPause': ['playhead', 'position', 'adPlayhead', 'adNumber', 'breakNumber'],\n      '/adResume': ['playhead', 'position', 'adPlayhead', 'adPauseDuration', 'adNumber', 'breakNumber'],\n      '/adBufferUnderrun': ['playhead', 'position', 'adPlayhead', 'adBufferDuration', 'adNumber', 'breakNumber'],\n      '/adStop': ['playhead', 'position', 'adPlayhead', 'adBitrate', 'adTotalDuration', 'pauseDuration', 'adViewedDuration', 'adViewability', 'adNumber', 'breakNumber'],\n      '/adClick': ['playhead', 'position', 'adPlayhead', 'adNumber', 'breakNumber'],\n      '/adError': ['playhead'].concat(adStartParams),\n      '/adManifest': ['givenBreaks', 'expectedBreaks', 'expectedPattern', 'breaksTime'],\n      '/adBreakStart': ['position', 'givenAds', 'expectedAds', 'breakNumber', 'adInsertionType'],\n      '/adBreakStop': ['position', 'breakNumber'],\n      '/adQuartile': ['position', 'adViewedDuration', 'adViewability', 'adNumber', 'breakNumber'],\n\n      '/ping': ['droppedFrames', 'playrate', 'cdnDownloadedTraffic', 'p2pDownloadedTraffic', 'uploadTraffic', 'latency', 'packetLoss', 'packetSent', 'metrics', 'totalBytes'],\n\n      '/infinity/session/start': [\n        'accountCode',\n        'username',\n        'userType',\n        'anonymousUser',\n        'navContext',\n        'route',\n        'page',\n        'referer',\n        'referral',\n        'language',\n        'deviceInfo',\n        'adsBlocked',\n        'deviceUUID',\n        'libVersion',\n        'appName',\n        'appReleaseVersion',\n        'isp',\n        'connectionType',\n        'ip',\n        'obfuscateIp',\n        'param1',\n        'param2',\n        'param3',\n        'param4',\n        'param5',\n        'param6',\n        'param7',\n        'param8',\n        'param9',\n        'param10',\n        'param11',\n        'param12',\n        'param13',\n        'param14',\n        'param15',\n        'param16',\n        'param17',\n        'param18',\n        'param19',\n        'param20'\n      ],\n      '/infinity/session/stop': ['sessionMetrics'],\n      '/infinity/session/nav': ['navContext', 'route', 'page', 'scrollDepth'],\n      '/infinity/session/beat': ['sessionMetrics'],\n      '/infinity/session/event': ['accountCode', 'navContext'],\n\n      '/offlineEvents': {}\n    },\n\n    /** Values for request body */\n    bodyParams: {\n      '/offlineEvents': ['viewJson']\n    },\n\n    /** List of params used by each service (only if they are different) */\n    differentParams: {\n      entities: [\n        'rendition',\n        'title',\n        'title2',\n        'param1',\n        'param2',\n        'param3',\n        'param4',\n        'param5',\n        'param6',\n        'param7',\n        'param8',\n        'param9',\n        'param10',\n        'param11',\n        'param12',\n        'param13',\n        'param14',\n        'param15',\n        'param16',\n        'param17',\n        'param18',\n        'param19',\n        'param20',\n        'cdn',\n        'nodeHost',\n        'nodeType',\n        'nodeTypeString',\n        'subtitles',\n        'contentLanguage'\n      ]\n    },\n\n    /** List of params and its related getter */\n    getters: {\n      requestNumber: 'getRequestNumber',\n      playhead: 'getPlayhead',\n      playrate: 'getPlayrate',\n      fps: 'getFramesPerSecond',\n      droppedFrames: 'getDroppedFrames',\n      mediaDuration: 'getDuration',\n      bitrate: 'getBitrate',\n      totalBytes: 'getTotalBytes',\n      throughput: 'getThroughput',\n      rendition: 'getRendition',\n      title: 'getTitle',\n      title2: 'getTitle2',\n      live: 'getIsLive',\n      mediaResource: 'getResource',\n      parsedResource: 'getParsedResource',\n      transactionCode: 'getTransactionCode',\n      properties: 'getMetadata',\n      playerVersion: 'getPlayerVersion',\n      player: 'getPlayerName',\n      cdn: 'getCdn',\n      pluginVersion: 'getPluginVersion',\n      libVersion: 'getLibVersion',\n      userType: 'getUserType',\n      streamingProtocol: 'getStreamingProtocol',\n      transportFormat: 'getTransportFormat',\n      obfuscateIp: 'getObfuscateIp',\n      householdId: 'getHouseholdId',\n      latency: 'getLatency',\n      packetLoss: 'getPacketLoss',\n      packetSent: 'getPacketSent',\n      metrics: 'getVideoMetrics',\n\n      param1: 'getExtraparam1',\n      param2: 'getExtraparam2',\n      param3: 'getExtraparam3',\n      param4: 'getExtraparam4',\n      param5: 'getExtraparam5',\n      param6: 'getExtraparam6',\n      param7: 'getExtraparam7',\n      param8: 'getExtraparam8',\n      param9: 'getExtraparam9',\n      param10: 'getExtraparam10',\n      param11: 'getExtraparam11',\n      param12: 'getExtraparam12',\n      param13: 'getExtraparam13',\n      param14: 'getExtraparam14',\n      param15: 'getExtraparam15',\n      param16: 'getExtraparam16',\n      param17: 'getExtraparam17',\n      param18: 'getExtraparam18',\n      param19: 'getExtraparam19',\n      param20: 'getExtraparam20',\n\n      extraparam1: 'getAdExtraparam1',\n      extraparam2: 'getAdExtraparam2',\n      extraparam3: 'getAdExtraparam3',\n      extraparam4: 'getAdExtraparam4',\n      extraparam5: 'getAdExtraparam5',\n      extraparam6: 'getAdExtraparam6',\n      extraparam7: 'getAdExtraparam7',\n      extraparam8: 'getAdExtraparam8',\n      extraparam9: 'getAdExtraparam9',\n      extraparam10: 'getAdExtraparam10',\n\n      position: 'getAdPosition',\n      adNumber: 'getAdNumber',\n      breakNumber: 'getBreakNumber',\n      adPlayhead: 'getAdPlayhead',\n      adDuration: 'getAdDuration',\n      adCampaign: 'getAdCampaign',\n      adCreativeId: 'getAdCreativeId',\n      adBitrate: 'getAdBitrate',\n      adTitle: 'getAdTitle',\n      adResource: 'getAdResource',\n      adPlayerVersion: 'getAdPlayerVersion',\n      adProperties: 'getAdMetadata',\n      adAdapterVersion: 'getAdAdapterVersion',\n      givenBreaks: 'getGivenBreaks',\n      expectedBreaks: 'getExpectedBreaks',\n      expectedPattern: 'getExpectedPattern',\n      breaksTime: 'getBreaksTime',\n      givenAds: 'getGivenAds',\n      expectedAds: 'getExpectedAds',\n      adsExpected: 'getAdsExpected',\n      adViewedDuration: 'getAdViewedDuration',\n      adViewability: 'getAdViewability',\n      fullscreen: 'getIsFullscreen',\n      audio: 'getAudioEnabled',\n      skippable: 'getIsSkippable',\n      adProvider: 'getAdProvider',\n      adInsertionType: 'getAdInsertionType',\n\n      pluginInfo: 'getPluginInfo',\n\n      isp: 'getIsp',\n      connectionType: 'getConnectionType',\n      ip: 'getIp',\n\n      deviceInfo: 'getDeviceInfo',\n\n      system: 'getAccountCode',\n      accountCode: 'getAccountCode',\n      username: 'getUsername',\n      anonymousUser: 'getAnonymousUser',\n\n      joinDuration: 'getJoinDuration',\n      bufferDuration: 'getBufferDuration',\n      seekDuration: 'getSeekDuration',\n      pauseDuration: 'getPauseDuration',\n\n      adJoinDuration: 'getAdJoinDuration',\n      adBufferDuration: 'getAdBufferDuration',\n      adPauseDuration: 'getAdPauseDuration',\n      adTotalDuration: 'getAdTotalDuration',\n\n      referer: 'getReferer',\n      referral: 'getReferral',\n      language: 'getLanguage',\n\n      nodeHost: 'getNodeHost',\n      nodeType: 'getNodeType',\n      nodeTypeString: 'getNodeTypeString',\n\n      route: 'getReferer',\n      navContext: 'getContext',\n      page: 'getPageName',\n\n      playerStartupTime: 'getPlayerStartupTime',\n      pageLoadTime: 'getPageLoadTime',\n\n      cdnDownloadedTraffic: 'getCdnTraffic',\n      p2pDownloadedTraffic: 'getP2PTraffic',\n      p2pEnabled: 'getIsP2PEnabled',\n      uploadTraffic: 'getUploadTraffic',\n\n      viewJson: 'getOfflineView',\n      deviceUUID: 'getDeviceUUID',\n      sessionMetrics: 'getSessionMetrics',\n      scrollDepth: 'getScrollDepth',\n\n      adsBlocked: 'getIsBlocked',\n      linkedViewId: 'getLinkedViewId',\n\n      smartswitchConfigCode: 'getSmartswitchConfigCode',\n      smartswitchGroupCode: 'getSmartswitchGroupCode',\n      smartswitchContractCode: 'getSmartswitchContractCode',\n\n      appName: 'getAppName',\n      appReleaseVersion: 'getAppReleaseVersion',\n      package: 'getPackage',\n      saga: 'getSaga',\n      tvshow: 'getTvShow',\n      season: 'getSeason',\n      titleEpisode: 'getEpisodeTitle',\n      channel: 'getChannel',\n      drm: 'getDRM',\n      videoCodec: 'getVideoCodec',\n      audioCodec: 'getAudioCodec',\n      codecSettings: 'getCodecSettings',\n      codecProfile: 'getCodecProfile',\n      containerFormat: 'getContainerFormat',\n      contentId: 'getID',\n      imdbID: 'getImdbId',\n      gracenoteID: 'getGracenoteID',\n      contentType: 'getType',\n      genre: 'getGenre',\n      contentLanguage: 'getVideoLanguage',\n      subtitles: 'getSubtitles',\n      contractedResolution: 'getContractedResolution',\n      cost: 'getCost',\n      price: 'getPrice',\n      playbackType: 'getPlaybackType',\n      email: 'getEmail'\n    }\n\n  }\n)\n\nmodule.exports = RequestBuilder\n","var YouboraObject = require('../object')\n/**\n * This static class provides device detection methods.\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar BackgroundDetector = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.plugin = plugin\n    this.isInBackground = false\n    this.listenerReference = this._visibilityListener.bind(this)\n    this._reset()\n  },\n\n  startDetection: function () {\n    if (!this.isBackgroundDetectorStarted && typeof document !== 'undefined') {\n      this.isBackgroundDetectorStarted = true\n      document.addEventListener('visibilitychange', this.listenerReference)\n    }\n  },\n\n  stopDetection: function () {\n    if (this.isBackgroundDetectorStarted && typeof document !== 'undefined') {\n      document.removeEventListener('visibilitychange', this.listenerReference)\n      this._reset()\n    }\n  },\n\n  _reset: function () {\n    this.isBackgroundDetectorStarted = false\n  },\n\n  _visibilityListener: function (e) {\n    if (typeof document !== 'undefined') {\n      var settings = this._getSettings()\n      if (document.visibilityState === 'hidden') {\n        this._toBackground(settings)\n      } else if (document.visibilityState === 'visible') { // to Foreground\n        this._toForeground(settings)\n      }\n    }\n  },\n\n  _toBackground: function (settings) {\n    this.isInBackground = true\n    if (this.plugin && this.plugin._adsAdapter) {\n      this.plugin._adsAdapter.stopChronoView()\n    }\n    if (typeof settings === 'string') {\n      switch (settings) {\n        case 'stop':\n          this._fireStop()\n          break\n        case 'pause':\n          this._firePause()\n          break\n      }\n      if (this.plugin.infinity.infinityStarted) {\n        this.lastBeatTime = new Date().getTime()\n        var difftime = this.plugin._beat.chrono.startTime ? (this.lastBeatTime - this.plugin._beat.chrono.startTime) : 0\n        this.plugin._sendBeat(difftime)\n        this.plugin._beat.stop()\n      }\n    }\n  },\n\n  _toForeground: function (settings) {\n    this.isInBackground = false\n    // ads\n    if (this.plugin && this.plugin._adsAdapter) {\n      this.plugin._adsAdapter.startChronoView()\n    }\n    // nothing for video yet\n    if (typeof settings === 'string' && settings) {\n      if (this.plugin.infinity.infinityStarted) {\n        var now = new Date().getTime()\n        if (now - this.lastBeatTime < this.plugin.sessionExpire) { // if session not expired\n          this.plugin._sendBeat(now - this.lastBeatTime)\n          this.plugin._beat.start()\n        } else { // session expired\n          this.plugin.infinity.newSession()\n        }\n      }\n    }\n  },\n\n  _getSettings: function () {\n    if (typeof this.plugin.options['background.settings'] === 'string' && this.plugin.options['background.settings']) {\n      return this.plugin.options['background.settings']\n    }\n    if (this.plugin.deviceDetector.isSmartTV()) {\n      return this.plugin.options['background.settings.tv']\n    }\n    if (this.plugin.deviceDetector.isDesktop()) {\n      return this.plugin.options['background.settings.desktop']\n    }\n    if (this.plugin.deviceDetector.isAndroid()) {\n      return this.plugin.options['background.settings.android']\n    }\n    if (this.plugin.deviceDetector.isIphone()) {\n      return this.plugin.options['background.settings.iOS']\n    }\n    if (this.plugin.deviceDetector.isPlayStation()) {\n      return this.plugin.options['background.settings.playstation']\n    }\n  },\n\n  _firePause: function () {\n    this._fireX('firePause')\n  },\n\n  _fireStop: function () {\n    this._fireX('fireStop')\n    this.plugin.fireStop()\n  },\n\n  _fireX: function (fireMethod) {\n    this.adsAdapter = this.plugin.getAdsAdapter()\n    if (this.adsAdapter) {\n      this.adsAdapter[fireMethod]()\n    }\n    this.contentAdapter = this.plugin.getAdapter()\n    if (this.contentAdapter) {\n      this.contentAdapter[fireMethod]()\n    }\n  },\n\n  canBlockStartCalls: function () {\n    return (\n      this.isInBackground &&\n      this.plugin.options['background.enabled'] === true &&\n      this._getSettings() // it is stop or pause\n    )\n  }\n})\n\nmodule.exports = BackgroundDetector\n","var YouboraObject = require('../object')\n/**\n * This static class provides device detection methods.\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar DeviceDetector = YouboraObject.extend({\n  constructor: function () {\n    if (typeof navigator !== 'undefined' && navigator.userAgent) {\n      this._isSmartTVDevice = navigator.userAgent.toLowerCase().match(/smarttv/) ||\n        navigator.userAgent.toLowerCase().match(/smart-tv/) ||\n        navigator.userAgent.toLowerCase().match(/appletv/) ||\n        navigator.userAgent.toLowerCase().match(/apple tv/)\n      this._isPlaystationDevice = navigator.userAgent.match(/PlayStation/) !== null\n      this._isIphoneDevice = navigator.userAgent.match(/iPhone|iPad|iPod/i) !== null\n      this._isAndroidDevice = navigator.userAgent.match(/Android/) !== null\n      this._isSmartphoneDevice = !this._isSmartTVDevice && !this._isPlaystationDevice && (this._isIphoneDevice || this._isAndroidDevice)\n      this._isDesktopDevice = !this._isSmartphoneDevice && !this._isSmartTVDevice && !this._isPlaystationDevice\n    }\n  },\n\n  isIphone: function () {\n    return this._isIphoneDevice\n  },\n\n  isAndroid: function () {\n    return this._isAndroidDevice\n  },\n\n  isSmartphone: function () {\n    return this._isSmartphoneDevice\n  },\n\n  isDesktop: function () {\n    return this._isDesktopDevice\n  },\n\n  isSmartTV: function () {\n    return this._isSmartTVDevice\n  },\n\n  isPlayStation: function () {\n    return this._isPlaystationDevice\n  }\n})\n\nmodule.exports = DeviceDetector\n","var DataExtractor = require('./dataextractor')\nvar YouboraObject = require('../object')\nvar MD5 = require('./md5')\n\nvar HashGenerator = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.plugin = plugin\n    this.dataExtractor = new DataExtractor()\n    this.key = this.getPreviousKey()\n  },\n\n  generateHashKey: function () {\n    if (!this.key) {\n      var data = this.dataExtractor.getAllData()\n      this.key = this._hashFunction(data)\n      this.plugin.storage.setLocal('youboraDeviceUUID', this.key)\n    }\n  },\n\n  getKey: function () {\n    if (!this.key) this.generateHashKey()\n    return this.key\n  },\n\n  _hashFunction: function (inputString) {\n    var outputString = inputString\n    if (typeof inputString !== 'string') {\n      outputString = JSON.stringify(inputString)\n    }\n    return MD5(outputString)\n  },\n\n  _reset: function () {\n    this.key = undefined\n  },\n\n  getPreviousKey: function () {\n    return this.plugin.storage.getLocal('youboraDeviceUUID')\n  }\n\n})\n\nmodule.exports = HashGenerator\n","var YouboraObject = require('../object')\nvar Timer = require('../timer')\nvar Chrono = require('../chrono')\n\nvar PlayheadMonitor = YouboraObject.extend(\n  /** @lends youbora.PlayheadMonitor.prototype */\n  {\n    /**\n     * This class periodically checks the player's playhead in order to infer buffer and/or seek\n     * events.\n     *\n     * Instances of this class are bounded to an {@link Adapter} and fires its buffer and seek\n     * start and end methods.\n     *\n     * In order to use this feature, {@link Adapter#monitorPlayhead} should be used.\n     *\n     * @constructs PlayheadMonitor\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     *\n     * @param {Adapter} adapter Adapter to monitor. Must have getPlayhead defined.\n     * @param {PlayheadMonitor.Type} [type=NONE]\n     * Which metric to monitor seek and/or buffer.\n     * Use bitwise operators to join both values (Type.BUFFER | Type.SEEK)\n     * @param {int} [interval=800] How many ms will wait between progress. -1 to disable.\n     */\n    constructor: function (adapter, type, interval) {\n      this._adapter = adapter\n      this._seekEnabled = type & PlayheadMonitor.Type.SEEK\n      this._bufferEnabled = type & PlayheadMonitor.Type.BUFFER\n      interval = interval || 800\n\n      this._chrono = new Chrono()\n      this._lastPlayhead = 0\n\n      if (interval > 0) {\n        this._timer = new Timer(this.progress.bind(this), interval)\n      }\n    },\n\n    /**\n     * Start interval checks.\n     */\n    start: function () {\n      this.stop()\n      this._timer.start()\n    },\n\n    /**\n     * Stop interval checks.\n     */\n    stop: function () {\n      this._lastPlayhead = 0\n      if (this._timer) this._timer.stop()\n    },\n\n    skipNextTick: function () {\n      this._lastPlayhead = 0\n    },\n\n    /**\n     * Call this method at every tick of timeupdate/progress.\n     * If you defined an interval, do not fire this method manually.\n     */\n    progress: function () {\n      // Reset timer\n      var deltaTime = this._chrono.stop()\n      this._chrono.start()\n\n      // Define thresholds\n      var bufferThreshold = deltaTime * PlayheadMonitor.kBUFFER_THRESHOLD_RATIO\n      var seekThreshold = deltaTime * PlayheadMonitor.kSEEK_THRESHOLD_RATIO\n\n      if (this._adapter.getPlayrate && this._adapter.getPlayrate() && this._adapter.getPlayrate() !== 1) {\n        bufferThreshold *= this._adapter.getPlayrate()\n        seekThreshold *= this._adapter.getPlayrate()\n      }\n\n      // Calculate diff playhead\n      var currentPlayhead = this._getPlayhead()\n      var diffPlayhead = Math.abs(this._lastPlayhead - currentPlayhead) * 1000\n\n      // youbora.Log.debug('curr: ' + currentPlayhead + ' last: ' + this._lastPlayhead + ' diff: ' + diffPlayhead)\n\n      if (diffPlayhead < bufferThreshold) {\n        // Playhead is stalling > buffer\n        if (this._bufferEnabled &&\n          this._lastPlayhead > 0 &&\n          !this._adapter.flags.isPaused &&\n          !this._adapter.flags.isSeeking\n        ) {\n          this._adapter.fireBufferBegin(null, false)\n        }\n      } else if (diffPlayhead > seekThreshold) {\n        // Playhead has jumped > seek\n        if (this._seekEnabled && this._lastPlayhead > 0) {\n          this._adapter.fireSeekBegin(null, false)\n        }\n      } else {\n        // Healthy\n        if (this._seekEnabled) {\n          this._adapter.fireSeekEnd()\n        }\n        if (this._bufferEnabled) {\n          this._adapter.fireBufferEnd()\n        }\n      }\n\n      // Update Playhead\n      this._lastPlayhead = currentPlayhead\n    },\n    /**\n     * Returns adapter's playhead. Override to add a custom playhead getter.\n     * @private\n     * @returns {double} Playhead in seconds\n     */\n    _getPlayhead: function () {\n      return this._adapter.getPlayhead()\n    }\n  },\n  /** @lends youbora.PlayheadMonitor */\n  {\n    // Static methods\n\n    /**\n     * Enum for monitoring type\n     * @enum\n     */\n    Type: {\n      /** Would not monitor */\n      NONE: 0,\n      /** Sends buffer-begin/end */\n      BUFFER: 1,\n      /** Sends seek-begin/end */\n      SEEK: 2\n    },\n\n    /** Buffer threshold */\n    kBUFFER_THRESHOLD_RATIO: 0.5,\n\n    /** Seek threshold */\n    kSEEK_THRESHOLD_RATIO: 2\n  })\n\nmodule.exports = PlayheadMonitor\n","var youbora = require('youboralib')\nrequire('./adapter')\n\nmodule.exports = youbora\n","/* eslint no-extend-native: \"off\" */\n\n/**\n * When executed, this function applies polyfills to the following functionalities:\n * Function.prototype.bind and\n * Array.prototype.forEach.\n *\n * @memberof youbora\n */\nvar applyPolyfills = function () {\n  // Bind, changed for compatibility\n  Function.prototype.bind = Function.prototype.bind || function (context) {\n    var slice = Array.prototype.slice\n    var func = this\n    var args = slice.call(arguments, 1)\n    function bound () {\n      var invokedAsConstructor = func.prototype && (this instanceof func)\n      return func.apply(\n        !invokedAsConstructor && context || this, args.concat(slice.call(arguments)) // eslint-disable-line no-mixed-operators\n      )\n    }\n    bound.prototype = func.prototype\n    return bound\n  }\n\n  // Foreach\n  Array.prototype.forEach = Array.prototype.forEach || function (callback, thisArg) {\n    if (typeof (callback) !== 'function') {\n      throw new TypeError(callback + ' is not a function!')\n    }\n    var len = this.length\n    for (var i = 0; i < len; i++) {\n      callback.call(thisArg, this[i], i, this)\n    }\n  }\n\n  // Trunc\n  Math.trunc = Math.trunc || function (x) {\n    if (isNaN(x)) {\n      return NaN\n    }\n    if (x > 0) {\n      return Math.floor(x)\n    }\n    return Math.ceil(x)\n  }\n}\n\nmodule.exports = applyPolyfills\n","var F = function () { }\n\n/** See Object.create. */\nmodule.exports = function (o) {\n  if (arguments.length > 1) {\n    throw Error('Second argument not supported')\n  }\n  if (o === null) {\n    throw Error('Cannot set a null [[Prototype]]')\n  }\n  if (typeof o !== 'object') {\n    throw TypeError('Argument must be an object')\n  }\n  F.prototype = o\n  return new F()\n}\n","/**\n * List of ad positions\n */\nvar AdPosition = {\n  Preroll: 'pre',\n  Midroll: 'mid',\n  Postroll: 'post'\n}\nmodule.exports = AdPosition\n","/**\n * List of events that can be triggered by the adapter\n */\nvar Event = {\n  START: 'start',\n  JOIN: 'join',\n  PAUSE: 'pause',\n  RESUME: 'resume',\n  SEEK_BEGIN: 'seek-begin',\n  SEEK_END: 'seek-end',\n  BUFFER_BEGIN: 'buffer-begin',\n  BUFFER_END: 'buffer-end',\n  ERROR: 'error',\n  STOP: 'stop',\n  CLICK: 'click',\n  MANIFEST: 'manifest',\n  PODSTART: 'break-start',\n  PODSTOP: 'break-stop',\n  QUARTILE: 'quartile',\n  VIDEO_EVENT: 'video-event'\n}\nmodule.exports = Event\n","/**\n* List of ad manifest errors\n*/\nvar ManifestError = {\n  NO_RESPONSE: 'NO_RESPONSE',\n  EMPTY: 'EMPTY_RESPONSE',\n  WRONG: 'WRONG_RESPONSE'\n}\nmodule.exports = ManifestError\n","/**\n * List of youbora services.\n *\n * @enum\n */\nvar Service = {\n  DATA: '/data',\n\n  // Video\n  INIT: '/init',\n  START: '/start',\n  JOIN: '/joinTime',\n  PAUSE: '/pause',\n  RESUME: '/resume',\n  SEEK: '/seek',\n  BUFFER: '/bufferUnderrun',\n  ERROR: '/error',\n  STOP: '/stop',\n  PING: '/ping',\n\n  VIDEO_EVENT: '/infinity/video/event',\n\n  // Ads\n  AD_INIT: '/adInit',\n  AD_START: '/adStart',\n  AD_JOIN: '/adJoin',\n  AD_PAUSE: '/adPause',\n  AD_RESUME: '/adResume',\n  AD_BUFFER: '/adBufferUnderrun',\n  AD_STOP: '/adStop',\n  AD_CLICK: '/adClick',\n  AD_ERROR: '/adError',\n  AD_MANIFEST: '/adManifest',\n  AD_POD_START: '/adBreakStart',\n  AD_POD_STOP: '/adBreakStop',\n  AD_QUARTILE: '/adQuartile',\n\n  // Infinity\n  EVENT: '/infinity/session/event',\n  SESSION_START: '/infinity/session/start',\n  SESSION_STOP: '/infinity/session/stop',\n  NAV: '/infinity/session/nav',\n  BEAT: '/infinity/session/beat',\n\n  // Offline\n  OFFLINE_EVENTS: '/offlineEvents'\n}\nmodule.exports = Service\n","/**\n * List of will-send events.\n *\n * @memberof youbora.Plugin\n * @enum\n * @event\n */\nvar WillSendEvent = {\n  WILL_SEND_INIT: 'will-send-init',\n  WILL_SEND_START: 'will-send-start',\n  WILL_SEND_JOIN: 'will-send-join',\n  WILL_SEND_PAUSE: 'will-send-pause',\n  WILL_SEND_RESUME: 'will-send-resume',\n  WILL_SEND_SEEK: 'will-send-seek',\n  WILL_SEND_BUFFER: 'will-send-buffer',\n  WILL_SEND_ERROR: 'will-send-error',\n  WILL_SEND_FATAL_ERROR: 'will-send-fatal-error',\n  WILL_SEND_STOP: 'will-send-stop',\n  WILL_SEND_PING: 'will-send-ping',\n  WILL_SEND_VIDEO_EVENT: 'will-send-video-event',\n\n  WILL_SEND_AD_START: 'will-send-ad-start',\n  WILL_SEND_AD_JOIN: 'will-send-ad-join',\n  WILL_SEND_AD_PAUSE: 'will-send-ad-pause',\n  WILL_SEND_AD_RESUME: 'will-send-ad-resume',\n  WILL_SEND_AD_BUFFER: 'will-send-ad-buffer',\n  WILL_SEND_AD_STOP: 'will-send-ad-stop',\n  WILL_SEND_AD_CLICK: 'will-send-ad-click',\n  WILL_SEND_AD_ERROR: 'will-send-ad-error',\n  WILL_SEND_AD_MANIFEST: 'will-send-ad-manifest',\n  WILL_SEND_AD_POD_START: 'will-send-ad-break-start',\n  WILL_SEND_AD_POD_STOP: 'will-send-ad-break-stop',\n  WILL_SEND_AD_QUARTILE: 'will-send-ad-quartile',\n\n  WILL_SEND_SESSION_START: 'will-send-session-start',\n  WILL_SEND_SESSION_STOP: 'will-send-session-stop',\n  WILL_SEND_NAV: 'will-send-nav',\n  WILL_SEND_BEAT: 'will-send-beat',\n  WILL_SEND_EVENT: 'will-send-event',\n\n  WILL_SEND_OFFLINE_EVENTS: 'will-send-offline-events'\n}\nmodule.exports = WillSendEvent\n","/**\n * List of ad insertion types\n */\nvar InsertionType = {\n  ClientSide: 'csai',\n  ServerSide: 'ssai'\n}\nmodule.exports = InsertionType\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'LEVEL3',\n  parsers: [{\n    element: 'host+type',\n    headerName: 'X-WR-Diag',\n    regex: /Host:(.+)\\sType:(.+)/\n  }],\n  requestHeaders: {\n    'X-WR-Diag': 'host'\n  },\n  parseType: function (type) {\n    if (type) {\n      if (\n        type.indexOf('TCP_HIT') === 0 ||\n        type.indexOf('TCP_MEM_HIT') === 0 ||\n        type.indexOf('TCP_IMS_HIT') === 0\n      ) {\n        return 1\n      } else if (type.indexOf('TCP_MISS') === 0) {\n        return 2\n      }\n    }\n\n    return 0\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'CLOUDFRT',\n  parsers: [{\n    element: 'host',\n    headerName: 'X-Amz-Cf-Id',\n    regex: /(.+)/\n  }, {\n    element: 'type',\n    headerName: 'X-Cache',\n    regex: /(\\S+)\\s.+/\n  }],\n  parseType: function (type) {\n    switch (type) {\n      case 'Hit':\n        return 1\n      case 'Miss':\n        return 2\n      default:\n        return 0\n    }\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'AKAMAI',\n  // requestMethod: 'GET',\n  parsers: [{\n    element: 'type+host',\n    headerName: 'X-Cache',\n    regex: /(.+)\\sfrom.+AkamaiGHost\\/(.+)\\).+/\n  }, {\n    element: 'host',\n    headerName: 'akamai-mon-iucid-del',\n    regex: /(.*)/\n  }, {\n    element: 'type',\n    headerName: 'akamai-cache-status',\n    regex: /(.+)\\sfrom\\schild/\n  }],\n  requestHeaders: {\n    Pragma: 'akamai-x-cache-on'\n  },\n  parseType: function (type) {\n    var t = type.toLowerCase()\n    if (t.indexOf('hit') !== -1) {\n      return 1\n    } else if (t.indexOf('miss') !== -1) {\n      return 2\n    }\n    return 0\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'HIGHNEGR',\n  parsers: [{\n    element: 'host+type',\n    headerName: 'X-HW',\n    regex: /.+,[0-9]+\\.(.+)\\.(.+)/\n  }],\n  parseType: function (type) {\n    switch (type) {\n      case 'c':\n      case 'x':\n        return 1\n      default:\n        return 2\n    }\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'FASTLY',\n  parsers: [{\n    element: 'host',\n    headerName: 'X-Served-By',\n    regex: /([^,\\s]+)$/\n  }, {\n    element: 'type',\n    headerName: 'X-Cache',\n    regex: /([^,\\s]+)$/\n  }],\n  parseType: function (type) {\n    switch (type) {\n      case 'HIT':\n        return 1\n      case 'MISS':\n        return 2\n      default:\n        return 0\n    }\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'TELEFO',\n  parsers: [{\n    element: 'host+type',\n    headerName: 'x-tcdn',\n    regex: /Host:(.+)\\sType:(.+)/\n  }],\n  requestHeaders: {\n    'x-tcdn': 'host'\n  },\n  parseType: function (type) {\n    if (type) {\n      if (\n        type.indexOf('p') !== -1 ||\n        type.indexOf('c') !== -1\n      ) {\n        return 1\n      } else if (type.indexOf('i') !== -1 ||\n        type.indexOf('m') !== -1) {\n        return 2\n      }\n    }\n    return 0\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'AMAZON',\n  parsers: [{\n    element: 'host',\n    headerName: 'x-amz-cf-pop',\n    regex: /(.+)/\n  }, {\n    element: 'type',\n    headerName: 'x-cache',\n    regex: /(.+)\\sfrom.+/\n  }],\n  parseType: function (type) {\n    if (type.toLowerCase().indexOf('hit') !== -1) {\n      return 1\n    } else if (type.toLowerCase().indexOf('miss') !== -1) {\n      return 2\n    }\n    return 0\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  cdnName: 'EDGECAST',\n  parsers: [{\n    element: 'host',\n    headerName: 'Server',\n    regex: /\\((.+)\\/.+\\)/\n  }, {\n    element: 'type',\n    headerName: 'X-Cache',\n    regex: /(.+)/\n  }],\n  parseType: function (type) {\n    switch (type) {\n      case 'HIT':\n        return 1\n      case 'MISS':\n      default:\n        return 2\n    }\n  }\n}\n","// {@see CdnParser}\n\nmodule.exports = {\n  parsers: [{\n    element: 'name',\n    headerName: null,\n    regex: /(.+)/\n  }]\n}\n","var Emitter = require('../../../emitter')\nvar Log = require('../../../log')\nvar YBRequest = require('../../request')\n\nvar CdnSwitch = Emitter.extend({\n  constructor: function (plugin) {\n    this.plugin = plugin\n    this.headerName = 'x-cdn'\n  },\n\n  init: function () {\n    var url = null\n    if (this.plugin) {\n      if (this.plugin.getAdapter() && this.plugin.getAdapter().getURLToParse()) {\n        url = this.plugin.getAdapter().getURLToParse()\n      } else {\n        url = this.plugin.getResource()\n      }\n    }\n    if (this.plugin && this.plugin.getAdapter() && this.plugin.getAdapter().flags.isStarted) {\n      this._request(url)\n    }\n  },\n\n  done: function (data) {\n    this.emit(CdnSwitch.Events.DONE, data)\n  },\n\n  error: function () {\n    this.emit(CdnSwitch.Events.ERROR)\n  },\n\n  _successfulRequest: function (resp) {\n    setTimeout(this.init.bind(this), parseInt(this.plugin.options['parse.cdnTTL']) * 1000)\n    var headers = resp.getResponseHeaders().split('\\n')\n    var cdn = null\n    for (var i in headers) {\n      var line = headers[i]\n      var index = line.indexOf(this.headerName)\n      if (index > -1) {\n        cdn = line.substring(index + this.headerName.length + 1, line.length - 1).replace(' ', '')\n      }\n    }\n    this.done(cdn)\n  },\n\n  _failedRequest: function () {\n    setTimeout(this.init.bind(this), parseInt(this.plugin.options['parse.cdnTTL']) * 1000)\n    Log.warn('CDN switch detection request failed')\n    this.error()\n  },\n\n  _request: function (url) {\n    var request = new YBRequest(url, null, null, { method: 'HEAD', cache: true })\n    request.on(YBRequest.Event.SUCCESS, this._successfulRequest.bind(this))\n    request.on(YBRequest.Event.ERROR, this._failedRequest.bind(this))\n    request.send()\n  }\n\n}, {\n  Events: {\n    DONE: 'done',\n    ERROR: 'error'\n  }\n})\n\nmodule.exports = CdnSwitch\n","var YouboraObject = require('../object')\nvar Log = require('../log')\n\nvar DeprecatedOptions = YouboraObject.extend({\n  exists: function (optionName) {\n    return DeprecatedOptions.Dictionary.hasOwnProperty(optionName) // eslint-disable-line no-prototype-builtins\n  },\n\n  getNewName: function (optionName) {\n    var newName = DeprecatedOptions.Dictionary[optionName]\n    Log.warn('The option \"' + optionName + '\" is deprecated, use \"' + newName + '\" instead')\n    return newName\n  }\n}, {\n  // Keys are old option names\n  // Values are new option names\n  Dictionary: {\n    httpSecure: 'app.https',\n    username: 'user.name',\n    anonymousUser: 'user.anonymousId',\n    obfuscateIp: 'user.obfuscateIp',\n    userType: 'user.type',\n    'content.title2': 'content.program',\n    'background.settings.iphone': 'background.settings.iOS',\n    'parse.hls': 'parse.manifest',\n    'parse.dash': 'parse.manifest',\n    'parse.locationHeader': 'parse.manifest',\n    'extraparam.1': 'content.customDimension.1',\n    'extraparam.2': 'content.customDimension.2',\n    'extraparam.3': 'content.customDimension.3',\n    'extraparam.4': 'content.customDimension.4',\n    'extraparam.5': 'content.customDimension.5',\n    'extraparam.6': 'content.customDimension.6',\n    'extraparam.7': 'content.customDimension.7',\n    'extraparam.8': 'content.customDimension.8',\n    'extraparam.9': 'content.customDimension.9',\n    'extraparam.10': 'content.customDimension.10',\n    'extraparam.11': 'content.customDimension.11',\n    'extraparam.12': 'content.customDimension.12',\n    'extraparam.13': 'content.customDimension.13',\n    'extraparam.14': 'content.customDimension.14',\n    'extraparam.15': 'content.customDimension.15',\n    'extraparam.16': 'content.customDimension.16',\n    'extraparam.17': 'content.customDimension.17',\n    'extraparam.18': 'content.customDimension.18',\n    'extraparam.19': 'content.customDimension.19',\n    'extraparam.20': 'content.customDimension.20',\n    'ad.extraparam.1': 'ad.customDimension.1',\n    'ad.extraparam.2': 'ad.customDimension.2',\n    'ad.extraparam.3': 'ad.customDimension.3',\n    'ad.extraparam.4': 'ad.customDimension.4',\n    'ad.extraparam.5': 'ad.customDimension.5',\n    'ad.extraparam.6': 'ad.customDimension.6',\n    'ad.extraparam.7': 'ad.customDimension.7',\n    'ad.extraparam.8': 'ad.customDimension.8',\n    'ad.extraparam.9': 'ad.customDimension.9',\n    'ad.extraparam.10': 'ad.customDimension.10'\n  }\n})\n\nmodule.exports = DeprecatedOptions\n","var Emitter = require('../emitter')\nvar Timer = require('../timer')\nvar Chrono = require('../chrono')\nvar Constants = require('../constants')\nvar Util = require('../util')\n\nvar YBRequest = require('../comm/request')\nvar Communication = require('../comm/communication')\nvar FlowTransform = require('../comm/transform/flow')\nvar ViewTransform = require('../comm/transform/view')\nvar ResourceTransform = require('../comm/transform/resource')\nvar OfflineTransform = require('../comm/transform/offline')\n\nvar Options = require('./options')\nvar YouboraStorage = require('./storage')\nvar OfflineStorage = require('./offlineStorage')\nvar RequestBuilder = require('./requestbuilder')\n\nvar YouboraInfinity = require('../infinity/infinity')\n\nvar HybridNetwork = require('../monitors/hybridnetwork')\nvar BrowserLoadTimes = require('../monitors/browserLoadTimes')\nvar BackgroundDetector = require('../detectors/backgroundDetector')\nvar DeviceDetector = require('../detectors/deviceDetector')\nvar BlockDetector = require('../detectors/blockDetector')\nvar ResizeScrollDetector = require('../detectors/resizeScrollDetector')\nvar UUIDGenerator = require('../deviceUUID/hashgenerator')\n\nvar Plugin = Emitter.extend(\n  /** @lends youbora.Plugin.prototype */\n  {\n    /**\n     * This is the main class of video analytics. You may want to have one instance for each video\n     * you want to track. Will need {@link Adapter}s for both content and ads.\n     *\n     * @constructs Plugin\n     * @extends youbora.Emitter\n     * @memberof youbora\n     *\n     * @param {Options} [options] An object complying with {@link Options} constructor.\n     * @param {Adapter} [adapter] If an adapter is provided, setAdapter will be immediately called.\n     * @param {object} [dataReq] If a data response is given, it wont request to /data anything and will use this one instead.\n     */\n    constructor: function (options, adapter, dataReq) {\n      if (typeof adapter === 'string' && !dataReq) {\n        dataReq = adapter\n        adapter = null\n      }\n      /** Reference to {@link youbora.YouboraStorage} */\n      this.storage = new YouboraStorage()\n\n      /** UUIDGenerator manager */\n      this.uuidGenerator = new UUIDGenerator(this)\n\n      /** Instance of youbora infinity. */\n      this.infinity = new YouboraInfinity(this)\n\n      /** This flags indicates that /init has been called. */\n      this.isInitiated = false\n\n      /** This flags indicates that /adManifest has been called. */\n      this.isAdsManifestSent = false\n\n      /** Postroll counter to fix plugins reporting stop before postrolls */\n      this.playedPostrolls = 0\n\n      /** This flags indicates if an ad break is started */\n      this.isBreakStarted = false\n\n      /** Chrono for init times. */\n      this.initChrono = new Chrono()\n\n      /** Stored {@link Options} of the session. */\n      this.options = new Options(options)\n\n      /** Reference to {@link youbora.YouboraStorage} */\n      this.storage = new YouboraStorage(null, this.options.disableCookies, this.options.disableStorage)\n\n      /** Reference to {@link youbora.OfflineStorage} */\n      if (!this.options.disableStorage) {\n        this.offlineStorage = new OfflineStorage()\n      }\n\n      this._adapter = null\n      this._adsAdapter = null\n      this._ping = new Timer(this._sendPing.bind(this), 5000)\n      this._beat = new Timer(this._sendBeat.bind(this), 30000)\n      this._refreshData = new Timer(this._checkOldData.bind(this), 3600000) // 1h\n      this._refreshData.start()\n      this.sessionExpire = Number(this.storage.getLocal('sessionExpire')) * 1000 || 300000\n\n      this.requestBuilder = new RequestBuilder(this)\n\n      this.resourceTransform = new ResourceTransform(this)\n\n      this.lastEventTime = null\n\n      this.restartViewTransform(dataReq)\n\n      this._initInfinity()\n\n      this.hybridNetwork = new HybridNetwork()\n      this.browserLoadTimes = new BrowserLoadTimes(this)\n      this.deviceDetector = new DeviceDetector()\n      this.backgroundDetector = new BackgroundDetector(this)\n      this.resizeScrollDetector = new ResizeScrollDetector(this)\n      if (this.options['background.enabled']) this.backgroundDetector.startDetection()\n\n      if (this.options['ad.blockDetection']) {\n        this.blockDetector = new BlockDetector(this)\n      }\n\n      if (adapter) this.setAdapter(adapter)\n    },\n\n    _checkOldData: function () {\n      if (this._adapter && this._adapter.flags.isStarted) return\n      if (this.infinity.infinityStarted) return\n      this.restartViewTransform()\n    },\n\n    restartViewTransform: function (response) {\n      // FastData\n      this.viewTransform = new ViewTransform(this)\n      this.viewTransform.on(ViewTransform.Event.DONE, this._receiveData.bind(this))\n\n      // External response\n      if (response) {\n        this.viewTransform.setData(response)\n        return\n      }\n\n      if (this.getIsDataExpired() ||\n        ((this.storage.getLocal('accCode') !== this.options.accountCode) &&\n          (this.storage.getSession('accCode') !== this.options.accountCode))) { // If expired or nonexistant\n        this.storage.removeStorages('data')\n        this.storage.removeStorages('session')\n        this.storage.removeLocal('infinityStarted')\n        this.viewTransform.init() // request a new data\n      } else {\n        this.viewTransform.setData(this.getStoredData()) // use stored data\n      }\n    },\n\n    /**\n    * This callback is called when a correct data response is received.\n    *\n    * @param {any} e Response from fastdata\n    */\n    _receiveData: function (e) {\n      this._ping.interval = e.target.response.pingTime * 1000\n      this._beat.interval = e.target.response.beatTime * 1000\n      this.sessionExpire = e.target.response.sessionExpire * 1000\n      this.storage.setStorages('data', e.target.response.msg)\n      this.storage.setStorages('dataTime', new Date().getTime())\n      this.storage.setStorages('accCode', this.options.accountCode)\n      if (this.getIsSessionExpired()) {\n        this.viewTransform.setSession(this.viewTransform.response.code)\n        this.storage.setStorages('session', this.viewTransform.response.code)\n        this.storage.setStorages('host', this.viewTransform.response.host)\n      } else {\n        this.viewTransform.setSession(this.getSession())\n        this.viewTransform.setHost(this.getStorageHost())\n      }\n    },\n\n    /**\n    * Reset all variables and stop all timers\n    * @private\n    */\n    _reset: function () {\n      this._stopPings()\n      this.resourceTransform = new ResourceTransform(this)\n      if (this._adapter) { // The fix\n        this._adapter.flags.reset()\n      }\n      this.isInitiated = false\n      this.isStarted = false\n      this.startDelayed = false\n      this.isAdsManifestSent = false\n      this.initChrono.reset()\n      this._totalPrerollsTime = 0\n      this.requestBuilder.lastSent.breakNumber = 0\n      this.requestBuilder.lastSent.adNumber = 0\n      this._savedAdManifest = null\n      this._savedAdError = null\n      this.playedPostrolls = 0\n      this.isBreakStarted = false\n    },\n\n    /**\n    * Creates and enqueues related request using {@link Communication#sendRequest}.\n    * It will fire will-send-events.\n    *\n    * @param {string} willSendEvent Name of the will-send event. Use {@link Plugin.Event} enum.\n    * @param {string} service Name of the service. Use {@link Constants.Service} enum.\n    * @param {Object} params Params of the request\n    * @param {Object} body Body of the request, if it is a POST request\n    * @param {string} method Request method. GET by default\n    * @param {function} callback Callback method for successful request\n    * @param {Object} callbackParams Json with params for callback call\n    * @private\n    */\n    _send: function (willSendEvent, service, params, body, method, callback, callbackParams) {\n      var now = new Date().getTime()\n      if (this.options.preventZombieViews && this.lastEventTime && (now > (this.lastEventTime + (600 * 1000)))) { // 600 * 1000ms = 10 minutes\n        // if last event was sent more than 10 minutes ago, it will use new view code\n        this.viewTransform.nextView()\n      }\n      this.lastEventTime = (service === Constants.Service.STOP) ? null : now\n      params = this.requestBuilder.buildParams(params, service)\n\n      if (this.getIsLive()) {\n        params.mediaDuration = undefined\n        params.playhead = undefined\n      }\n\n      var data = {\n        params: params,\n        plugin: this,\n        adapter: this.getAdapter(),\n        adsAdapter: this.getAdsAdapter()\n      }\n\n      this.emit(willSendEvent, data)\n\n      if (this._comm && (params !== null || typeof method !== 'undefined') && this.options.enabled) {\n        this.lastServeiceSent = service\n        var options = {}\n        if (typeof method !== 'undefined' && method !== 'GET') {\n          options.method = method\n        }\n        var request = new YBRequest(null, service, params, options)\n        if (body) request.setBody(body)\n        this._comm.sendRequest(request, callback, callbackParams)\n      }\n    },\n\n    /**\n    * Initializes comm and its transforms.\n    * @private\n    */\n    _initComm: function () {\n      var resource = this.getResource()\n      if (this._adapter && this._adapter.getURLToParse()) {\n        resource = this._adapter.getURLToParse()\n      }\n      this.resourceTransform.init(resource)\n\n      this._comm = new Communication()\n      this._comm.addTransform(new FlowTransform())\n      this._comm.addTransform(this.viewTransform)\n      if (this.options && this.options.offline) {\n        this._comm.addTransform(new OfflineTransform(this))\n      } else {\n        this._comm.addTransform(this.resourceTransform)\n      }\n    },\n\n    /**\n    * Returns the current {@link youbora.Communication} instance.\n    *\n    * @returns {youbora.Communication} communication instance\n    */\n    getComm: function () {\n      return this._comm\n    },\n\n    /**\n    * Modifies current options. See {@link Options.setOptions}.\n    *\n    * @param {any} options\n    */\n    setOptions: function (options) {\n      if (options) {\n        this.options.setOptions(options)\n        if (typeof options['background.enabled'] === 'boolean') {\n          if (options['background.enabled']) {\n            this.backgroundDetector.startDetection()\n          } else {\n            this.backgroundDetector.stopDetection()\n          }\n        }\n      }\n    },\n\n    /**\n    * Get fastdata response to set it in another plugin instance\n    */\n    getFastDataConfig: function () {\n      return this.viewTransform.response.msg\n    },\n\n    /**\n    * Disable request sending.\n    */\n    disable: function () {\n      this.setOptions({ enabled: false })\n    },\n\n    /**\n    * Re-enable request sending.\n    */\n    enable: function () {\n      this.setOptions({ enabled: true })\n    }\n  },\n\n  /** @lends youbora.Plugin */\n  {\n    // Static Memebers //\n    /**\n    * List of events that could be fired\n    * @enum\n    * @event\n    */\n    Event: Constants.WillSendEvent\n  }\n)\n\n// Apply Mixins\n// Plugin is actually a big class, I decided to separate the logic into\n// different mixin files to ease the maintainability of each file.\n// Filename convention will be plugin+xxxxx.js where xxxxx is the added functionality.\nUtil.assign(Plugin.prototype, require('./plugin+content'))\nUtil.assign(Plugin.prototype, require('./plugin+getters'))\nUtil.assign(Plugin.prototype, require('./plugin+content+getters'))\nUtil.assign(Plugin.prototype, require('./plugin+ads'))\nUtil.assign(Plugin.prototype, require('./plugin+ads+getters'))\nUtil.assign(Plugin.prototype, require('./plugin+pings'))\nUtil.assign(Plugin.prototype, require('./plugin+fire'))\nUtil.assign(Plugin.prototype, require('./plugin+infinity'))\nUtil.assign(Plugin.prototype, require('./plugin+infinity+getters'))\n\nmodule.exports = Plugin\n","var Transform = require('./transform')\nvar Constants = require('../../constants')\n\n/**\n * This transform ensures that no requests will be sent before an /init or /start request.\n * As these are the two possible first requests that the API expects for a view.\n *\n * @constructs\n * @extends youbora.Transform\n * @memberof youbora\n * @name FlowTransform\n *\n * @param {Plugin} plugin Instance of {@link Plugin}\n */\nvar FlowTransform = Transform.extend(\n  /** @lends youbora.FlowTransform.prototype */\n  {\n    _services: [Constants.Service.INIT, Constants.Service.START, Constants.Service.OFFLINE_EVENTS],\n    /**\n     * Returns if transform is blocking.\n     *\n     * @param {YBRequest} request Request to transform.\n     * @return {bool} True if queue shall be blocked.\n     */\n    isBlocking: function (request) {\n      if (this._isBusy && request != null) {\n        if (this._services.indexOf(request.service) !== -1) {\n          this.done()\n        } else if (request.service === Constants.Service.ERROR) {\n          return false\n        }\n      }\n      return Transform.prototype.isBlocking.apply(this, arguments)\n    }\n  }\n)\n\nmodule.exports = FlowTransform\n","var YouboraObject = require('../object')\nvar Storage = require('./storage')\n\n/**\n * This class manages data storage for offline events in an storage.\n *\n * @extends youbora.Emitter\n * @memberof youbora\n */\nvar OfflineStorage = YouboraObject.extend({\n  constructor: function () {\n    this.storage = new Storage('youboraOffline', true) // No cookies for offline\n    this.actualView = null\n    this.viewList = []\n    this.givenIds = []\n    this._getOldViewList()\n  },\n\n  _newView: function () {\n    // search for first unused id\n    var viewId = this._getValidId()\n\n    // create empty view\n    this.storage.setLocal(viewId, '')\n\n    // add to viewlist\n    this.viewList.push(viewId)\n    this.storage.setLocal('views', this.viewList)\n\n    // save the id\n    this.actualView = viewId\n  },\n\n  addEvent: function (event, params) {\n    // if event is start, create new view\n    if (event === '/start') this._newView()\n\n    // if event is init, ignore\n    if (event === '/init') return null\n\n    // if we have no view discard\n    if (!this.actualView) return null\n\n    // create event object\n    var fullEvent = '{\"request\":\"' + event.slice(1) + '\",' // {\"request\":\"start\",\n    fullEvent += '\"unixtime\":' + Date.now() + ',' // \"unixtime\":1499876515,\n    for (var param in params) {\n      if (params[param] === undefined) break\n      fullEvent += '\"' + param + '\":' // \"aParam\":\n      if (param === 'code') {\n        fullEvent += '\"' + 'CODE_PLACEHOLDER' + '\",' // \"CODE_PLACEHOLDER\",\n      } else if (param === 'sessionId') {\n        fullEvent += '\"' + 'SESSION_PLACEHOLDER' + '\",' // \"SESSION_PLACEHOLDER\",\n      } else if (param === 'sessionRoot') {\n        fullEvent += '\"' + 'ROOT_PLACEHOLDER' + '\",' // \"ROOT_PLACEHOLDER\",\n      } else if (typeof params[param] === 'string') {\n        fullEvent += '\"' + params[param] + '\",' // \"aStringValue\",\n      } else if (typeof params[param] === 'object') {\n        fullEvent += '\"' + JSON.stringify(params[param]).replace(/\"/g, '\\\\\"') + '\",' // json object\n      } else {\n        fullEvent += params[param] + ',' // 123, for example\n      }\n    }\n    fullEvent = fullEvent.slice(0, -1) // remove the last comma\n    fullEvent += '}'\n\n    // get accumulated view object\n    var temp = this.storage.getLocal(this.actualView)\n    if (temp !== '') temp = temp + ',' // comma between events\n\n    // add the event\n    this.storage.setLocal(this.actualView, temp + fullEvent)\n  },\n\n  getView: function () {\n    if (this.viewList.length > this.givenIds.length) { // if we have any view not sent yet\n      var position = 0\n      while (true) {\n        var idToSend = this.viewList[position]\n        if (this.givenIds.indexOf(idToSend) < 0) {\n          this.givenIds.push(idToSend)\n          return ['[' + this.storage.getLocal(idToSend) + ']', idToSend]\n        }\n        position++\n      }\n    }\n    return [null, null]\n  },\n\n  removeView: function (id) {\n    this.storage.removeLocal(id)\n    var position = this.viewList.indexOf(id)\n    if (position !== -1) this.viewList.splice(position, 1)\n    position = this.givenIds.indexOf(id)\n    if (position !== -1) this.givenIds.splice(position, 1)\n    this.storage.setLocal('views', this.viewList.toString())\n    if (id === this.actualView) this.actualView = null\n  },\n\n  _getOldViewList: function () {\n    var stringList = ''\n    if (this.storage.getLocal('views')) {\n      stringList = this.storage.getLocal('views')\n    } else {\n      this.storage.setLocal('views', '')\n    }\n\n    if (stringList === '') {\n      this.viewList = []\n    } else if (typeof stringList.split === 'function') {\n      this.viewList = stringList.split(',')\n    }\n  },\n\n  _getValidId: function () {\n    // get a value not in the list\n    var id = Math.floor(Math.random() * 1e8).toString()\n    if (this.viewList.indexOf(id) >= 0) {\n      return this._getValidId()\n    }\n    return id\n  },\n\n  sent: function () {\n    this.givenIds = []\n  }\n})\n\nmodule.exports = OfflineStorage\n","var Transform = require('./transform')\n\n/**\n * This transform ensures that no requests will be sent without sessionId when is required\n *\n * @constructs\n * @extends youbora.Transform\n * @memberof youbora\n * @name WrongTransform\n *\n * @param {Plugin} plugin Instance of {@link Plugin}\n */\nvar WrongTransform = Transform.extend(\n  /** @lends youbora.WrongTransform.prototype */\n  {\n    /**\n   * Returns if transform is blocking.\n   *\n   * @param {YBRequest} request Request to transform.\n   * @return {bool} True if queue shall be blocked.\n   */\n    isBlocking: function (request) {\n      if (!request.params.sessionId) {\n        return true\n      }\n      return false\n    }\n  }\n)\n\nmodule.exports = WrongTransform\n","/* global PerformanceObserver */\nvar YouboraObject = require('../object')\nvar RUMSpeedIndex = require('./speedIndex')\n\n/**\n * This static class provides information about the load times of the page\n *\n * @constructs YouboraObject\n * @extends youbora.YouboraObject\n * @memberof youbora\n *\n */\nvar BrowserLoadTimes = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.infinity = plugin.infinity\n    this.timeObject = null\n    this.playerSetup = null\n    this.perfObject = null\n    this.myTimesObject = {}\n\n    if (typeof window !== 'undefined' && typeof window.addEventListener === 'function') {\n      window.addEventListener('load', this._windowLoaded.bind(this))\n      if (window.performance && window.performance.timing) {\n        try {\n          if (typeof window.performance.getEntriesByType === 'function') {\n            this.perfObject = window.performance\n          }\n        } catch (err) {\n          // Nothing\n        }\n        this.timeObject = window.performance.timing\n      }\n    }\n    try {\n      if (typeof PerformanceObserver === 'function') {\n        var observer = new PerformanceObserver(function (list, obj) {\n          var entries = list.getEntries()\n          this.myTimesObject.largestContentfulPaint = entries[entries.length - 1].renderTime\n        }.bind(this))\n        if (PerformanceObserver.supportedEntryTypes.indexOf('largest-contentful-paint') > -1) {\n          observer.observe({ entryTypes: ['largest-contentful-paint'] })\n        }\n      }\n    } catch (err) {\n      // Cant use PerformanceObserver, entryTypes...\n    }\n  },\n\n  _windowLoaded: function () {\n    this.myTimesObject.onLoad = new Date().getTime()\n    this._getEnoughFPS()\n    setTimeout(this._fireLoadTimesEvent.bind(this), 1000)\n  },\n\n  _fireLoadTimesEvent: function () {\n    this._getLastMetrics()\n    this.infinity.fireEvent('loadTimes', {}, this._getAllValues())\n  },\n\n  _getAllValues: function () {\n    var ret = {\n      PageLoadTime: this.getPageLoadTime(),\n      DNSTime: this.getDnsTime(),\n      TCPTime: this.getTcpTime(),\n      HandshakeTime: this.getHandshakeTime(),\n      DomReadyTime: this.getDomReadyTime(),\n      BackendTime: this.getBackendTime(),\n      FrontendTime: this.getFrontendTime(),\n      VisualReady: this.getTimeToVisuallyReady(),\n      TimeToInteractive: this.getTimeToInteractive(),\n      JsTime: this.getJSTime(),\n      CssTime: this.getCSSTime(),\n      ImageTime: this.getImageTime(),\n      FontTime: this.getFontTime(),\n      AvgReqLatency: this.getAvgReqLatency(),\n      MaxReqLatency: this.getMaxReqLatency(),\n      FirstPaint: this.getFirstPaint(),\n      FirstContentfulPaint: this.getFirstContentfulPaint(),\n      LargestContentfulPaint: this.getLargestContentfulPaint(),\n      SpeedIndex: this.getSpeedIndex()\n    }\n    for (var key in ret) {\n      if (ret[key] === null || ret[key] === undefined || ret[key] < 0) {\n        delete ret[key]\n      } else {\n        ret[key] = Math.round(ret[key])\n      }\n    }\n    return ret\n  },\n\n  // Getters\n\n  getPageLoadTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.timeObject.loadEventEnd - this.timeObject.navigationStart\n    }\n    return ret\n  },\n\n  getPlayerStartupTime: function () {\n    var ret = null\n    if (this.timeObject && this.playerSetup) {\n      ret = this.playerSetup - this.timeObject.navigationStart\n    }\n    return ret\n  },\n\n  getDnsTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.timeObject.domainLookupEnd - this.timeObject.domainLookupStart\n    }\n    return ret\n  },\n\n  getTcpTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.timeObject.connectEnd - this.timeObject.connectStart\n    }\n    return ret\n  },\n\n  getHandshakeTime: function () {\n    var ret = null\n    if (this.timeObject && this.timeObject.secureConnectionStart) {\n      ret = this.timeObject.connectEnd - this.timeObject.secureConnectionStart\n    }\n    return ret\n  },\n\n  getDomReadyTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.timeObject.domComplete - this.timeObject.navigationStart\n    }\n    return ret\n  },\n\n  getBackendTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.timeObject.responseStart - this.timeObject.navigationStart\n    }\n    return ret\n  },\n\n  getFrontendTime: function () {\n    var ret = null\n    if (this.timeObject) {\n      ret = this.myTimesObject.onLoad - this.timeObject.responseStart\n    }\n    return ret\n  },\n\n  getTimeToVisuallyReady: function () {\n    var ret = this.myTimesObject.firstPaint || 0\n    if (this.timeObject) {\n      return Math.max(\n        ret,\n        this.timeObject.domContentLoadedEventEnd - this.timeObject.navigationStart || 0\n      // this.myTimesObject.heroImages - this.timeObject.navigationStart || 0\n      )\n    }\n    return ret || null\n  },\n\n  getTimeToInteractive: function () {\n    if (this.myTimesObject.fps && this.getTimeToVisuallyReady()) {\n      return Math.max(this.myTimesObject.fps, this.getTimeToVisuallyReady())\n    } else {\n      setTimeout(function () { this.getTimeToInteractive() }.bind(this), 500)\n    }\n  },\n\n  getJSTime: function () {\n    return this._getXTime('script')\n  },\n\n  getCSSTime: function () {\n    return this._getXTime('css')\n  },\n\n  getImageTime: function () {\n    return this._getXTime('img')\n  },\n\n  getFontTime: function () {\n    return this._getXTime('css', ['.woff', '.otf', '.ttf'])\n  },\n\n  getAvgReqLatency: function () {\n    try {\n      if (this.perfObject && typeof this.perfObject.getEntriesByType === 'function') {\n        var count = 0\n        var latency = 0\n        var scripts = this.perfObject.getEntriesByType('resource')\n        for (var i in scripts) {\n          if (scripts[i].requestStart && scripts[i].responseStart) {\n            latency += scripts[i].responseStart - scripts[i].requestStart\n          }\n          count++\n        }\n        return latency / count\n      }\n    } catch (err) {\n      // Nothing\n    }\n    return null\n  },\n\n  getFirstPaint: function () {\n    return this.myTimesObject ? this.myTimesObject.firstPaint : null\n  },\n\n  getFirstContentfulPaint: function () {\n    return this.myTimesObject ? this.myTimesObject.firstContentfulPaint : null\n  },\n\n  getLargestContentfulPaint: function () {\n    return this.myTimesObject ? this.myTimesObject.largestContentfulPaint : null\n  },\n\n  getMaxReqLatency: function () {\n    try {\n      if (this.perfObject && typeof this.perfObject.getEntriesByType === 'function') {\n        var scripts = this.perfObject.getEntriesByType('resource')\n        var latency = 0\n        for (var i in scripts) {\n          if (scripts[i].requestStart && scripts[i].responseStart) {\n            latency = Math.max(latency, scripts[i].responseStart - scripts[i].requestStart)\n          }\n        }\n        return latency\n      }\n    } catch (err) {\n      // Nothing\n    }\n    return null\n  },\n\n  getSpeedIndex: function () {\n    var ret = null\n    if (typeof window !== 'undefined' && window.performance && typeof window.performance.getEntriesByType === 'function') {\n      try {\n        ret = RUMSpeedIndex()\n      } catch (e) {\n        // nothing\n      }\n    }\n    return ret\n  },\n\n  _getXTime: function (type, validExtensions) {\n    var ret = 0\n    try {\n      if (this.perfObject && typeof this.perfObject.getEntriesByType === 'function') {\n        var scripts = this.perfObject.getEntriesByType('resource')\n        for (var i in scripts) {\n          if (scripts[i].initiatorType === type) {\n            if (!validExtensions) {\n              ret += scripts[i].duration\n            } else {\n              var valid = false\n              for (var ext in validExtensions) {\n                if (scripts[i].name.indexOf(validExtensions[ext] > 0)) {\n                  valid = true\n                }\n              }\n              if (valid) {\n                ret += scripts[i].duration\n              }\n            }\n          }\n        }\n      }\n    } catch (err) {\n    // Nothing\n    }\n    return Math.round(ret) || null\n  },\n\n  _getLastMetrics: function () {\n    var firstPaint = null\n    var contentfulPaint = null\n    try {\n      if (this.perfObject && typeof this.perfObject.getEntriesByType === 'function') {\n        var entries = this.perfObject.getEntriesByType('paint')\n        for (var i in entries) {\n          if (entries[i].name === 'first-paint') {\n            firstPaint = entries[i].startTime\n          } else if (entries[i].name === 'first-contentful-paint') {\n            contentfulPaint = entries[i].startTime\n          }\n        }\n      }\n    } catch (err) {\n    // Nothing\n    }\n    // First paint\n    if (!firstPaint && this.timeObject) {\n      firstPaint = this.timeObject.msFirstPaint - this.timeObject.navigationStart\n    }\n    // TODO first paint for firefox\n    this.myTimesObject.firstPaint = firstPaint\n    // First contentful paint\n    this.myTimesObject.firstContentfulPaint = contentfulPaint\n    // Others\n    this.getTimeToInteractive()\n  },\n\n  _getEnoughFPS: function () {\n    if (this.timeObject && typeof window !== 'undefined') {\n      var req = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || function () {}\n      this.preFPS = new Date().getTime()\n      req(function () {\n        var now = new Date().getTime()\n        if (now < this.preFPS + 50) {\n          this.myTimesObject.fps = now - this.timeObject.navigationStart\n        } else {\n          setTimeout(function () { return this._getEnoughFPS() }.bind(this), 50)\n        }\n      }.bind(this))\n    } else {\n      return true\n    }\n  },\n\n  // Setters\n\n  setPlayerSetupTime: function () {\n    this.playerSetup = this.playerSetup || new Date().getTime()\n  }\n})\n\nmodule.exports = BrowserLoadTimes\n","/* istanbul ignore next */\n/******************************************************************************\nCopyright (c) 2014, Google Inc.\nAll rights reserved.\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n    * Redistributions of source code must retain the above copyright notice,\n      this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright notice,\n      this list of conditions and the following disclaimer in the documentation\n      and/or other materials provided with the distribution.\n    * Neither the name of the <ORGANIZATION> nor the names of its contributors\n    may be used to endorse or promote products derived from this software\n    without specific prior written permission.\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n******************************************************************************/\n\n/******************************************************************************\n*******************************************************************************\n  Calculates the Speed Index for a page by:\n  - Collecting a list of visible rectangles for elements that loaded\n    external resources (images, background images, fonts)\n  - Gets the time when the external resource for those elements loaded\n    through Resource Timing\n  - Calculates the likely time that the background painted\n  - Runs the various paint rectangles through the SpeedIndex calculation:\n    https://sites.google.com/a/webpagetest.org/docs/using-webpagetest/metrics/speed-index\n  TODO:\n  - Improve the start render estimate\n  - Handle overlapping rects (though maybe counting the area as multiple paints\n    will work out well)\n  - Detect elements with Custom fonts and the time that the respective font\n    loaded\n  - Better error handling for browsers that don't support resource timing\n*******************************************************************************\n******************************************************************************/\n\nvar RUMSpeedIndex = function (win) {\n  win = win || window\n  var doc = win.document\n\n  /****************************************************************************\n    Support Routines\n  ****************************************************************************/\n  // Get the rect for the visible portion of the provided DOM element\n  var GetElementViewportRect = function (el) {\n    var intersect = false\n    if (el.getBoundingClientRect) {\n      var elRect = el.getBoundingClientRect()\n      intersect = {\n        top: Math.max(elRect.top, 0),\n        left: Math.max(elRect.left, 0),\n        bottom: Math.min(elRect.bottom, (win.innerHeight || doc.documentElement.clientHeight)),\n        right: Math.min(elRect.right, (win.innerWidth || doc.documentElement.clientWidth))\n      }\n      if (intersect.bottom <= intersect.top ||\n          intersect.right <= intersect.left) {\n        intersect = false\n      } else {\n        intersect.area = (intersect.bottom - intersect.top) * (intersect.right - intersect.left)\n      }\n    }\n    return intersect\n  }\n\n  // Check a given element to see if it is visible\n  var CheckElement = function (el, url) {\n    if (url) {\n      var rect = GetElementViewportRect(el)\n      if (rect) {\n        rects.push({\n          url: url,\n          area: rect.area,\n          rect: rect\n        })\n      }\n    }\n  }\n\n  // Get the visible rectangles for elements that we care about\n  var GetRects = function () {\n    // Walk all of the elements in the DOM (try to only do this once)\n    var elements = doc.getElementsByTagName('*')\n    var re = /url\\(.*(http.*)\\)/ig\n    for (var i = 0; i < elements.length; i++) {\n      var el = elements[i]\n      var style = win.getComputedStyle(el)\n\n      // check for Images\n      if (el.tagName === 'IMG') {\n        CheckElement(el, el.src)\n      }\n      // Check for background images\n      if (style['background-image']) {\n        re.lastIndex = 0\n        var matches = re.exec(style['background-image'])\n        if (matches && matches.length > 1) { CheckElement(el, matches[1].replace('\"', '')) }\n      }\n      // recursively walk any iFrames\n      if (el.tagName === 'IFRAME') {\n        try {\n          var rect = GetElementViewportRect(el)\n          if (rect) {\n            var tm = RUMSpeedIndex(el.contentWindow)\n            if (tm) {\n              rects.push({\n                tm: tm,\n                area: rect.area,\n                rect: rect\n              })\n            }\n          }\n        } catch (e) {\n        }\n      }\n    }\n  }\n\n  // Get the time at which each external resource loaded\n  var GetRectTimings = function () {\n    var timings = {}\n    var requests = win.performance.getEntriesByType('resource')\n    for (var i = 0; i < requests.length; i++) { timings[requests[i].name] = requests[i].responseEnd }\n    for (var j = 0; j < rects.length; j++) {\n      if (!('tm' in rects[j])) { rects[j].tm = timings[rects[j].url] !== undefined ? timings[rects[j].url] : 0 }\n    }\n  }\n\n  // Get the first paint time.\n  var GetFirstPaint = function () {\n    // If the browser supports a first paint event, just use what the browser reports\n    if ('msFirstPaint' in win.performance.timing) { firstPaint = win.performance.timing.msFirstPaint - navStart }\n    var paintMetrics = win.performance.getEntriesByType('paint')\n    for (var k = 0; k < paintMetrics.length; k++) {\n      if (paintMetrics[k].name === 'first-paint') {\n        firstPaint = paintMetrics[k].startTime\n      }\n    }\n    // For browsers that don't support first-paint or where we get insane values,\n    // use the time of the last non-async script or css from the head.\n    if (firstPaint === undefined || firstPaint < 0 || firstPaint > 120000) {\n      firstPaint = win.performance.timing.responseStart - navStart\n      var headURLs = {}\n      var headElements = doc.getElementsByTagName('head')[0].children\n      for (var i = 0; i < headElements.length; i++) {\n        var el = headElements[i]\n        if (el.tagName === 'SCRIPT' && el.src && !el.async) { headURLs[el.src] = true }\n        if (el.tagName === 'LINK' && el.rel === 'stylesheet' && el.href) { headURLs[el.href] = true }\n      }\n      var requests = win.performance.getEntriesByType('resource')\n      var doneCritical = false\n      for (var j = 0; j < requests.length; j++) {\n        if (!doneCritical &&\n            headURLs[requests[j].name] &&\n           (requests[j].initiatorType === 'script' || requests[j].initiatorType === 'link')) {\n          var requestEnd = requests[j].responseEnd\n          if (firstPaint === undefined || requestEnd > firstPaint) { firstPaint = requestEnd }\n        } else {\n          doneCritical = true\n        }\n      }\n    }\n    firstPaint = Math.max(firstPaint, 0)\n  }\n\n  // Sort and group all of the paint rects by time and use them to\n  // calculate the visual progress\n  var CalculateVisualProgress = function () {\n    var paints = { 0: 0 }\n    var total = 0\n    for (var i = 0; i < rects.length; i++) {\n      var tm = firstPaint\n      if ('tm' in rects[i] && rects[i].tm > firstPaint) { tm = rects[i].tm }\n      if (paints[tm] === undefined) { paints[tm] = 0 }\n      paints[tm] += rects[i].area\n      total += rects[i].area\n    }\n    // Add a paint area for the page background (count 10% of the pixels not\n    // covered by existing paint rects.\n    var pixels = Math.max(doc.documentElement.clientWidth, win.innerWidth || 0) *\n                 Math.max(doc.documentElement.clientHeight, win.innerHeight || 0)\n    if (pixels > 0) {\n      pixels = Math.max(pixels - total, 0) * pageBackgroundWeight\n      if (paints[firstPaint] === undefined) { paints[firstPaint] = 0 }\n      paints[firstPaint] += pixels\n      total += pixels\n    }\n    // Calculate the visual progress\n    if (total) {\n      for (var time in paints) {\n        if (paints.hasOwnProperty(time)) { // eslint-disable-line no-prototype-builtins\n          progress.push({ tm: time, area: paints[time] })\n        }\n      }\n      progress.sort(function (a, b) { return a.tm - b.tm })\n      var accumulated = 0\n      for (var j = 0; j < progress.length; j++) {\n        accumulated += progress[j].area\n        progress[j].progress = accumulated / total\n      }\n    }\n  }\n\n  // Given the visual progress information, Calculate the speed index.\n  var CalculateSpeedIndex = function () {\n    if (progress.length) {\n      SpeedIndex = 0\n      var lastTime = 0\n      var lastProgress = 0\n      for (var i = 0; i < progress.length; i++) {\n        var elapsed = progress[i].tm - lastTime\n        if (elapsed > 0 && lastProgress < 1) { SpeedIndex += (1 - lastProgress) * elapsed }\n        lastTime = progress[i].tm\n        lastProgress = progress[i].progress\n      }\n    } else {\n      SpeedIndex = firstPaint\n    }\n  }\n\n  /****************************************************************************\n    Main flow\n  ****************************************************************************/\n  var rects = []\n  var progress = []\n  var firstPaint\n  var SpeedIndex\n  var pageBackgroundWeight = 0.1\n  try {\n    var navStart = win.performance.timing.navigationStart\n    GetRects()\n    GetRectTimings()\n    GetFirstPaint()\n    CalculateVisualProgress()\n    CalculateSpeedIndex()\n  } catch (e) {\n  }\n  return SpeedIndex\n}\n\nmodule.exports = RUMSpeedIndex\n","var YouboraObject = require('../object')\nvar Util = require('../util')\nvar YBRequest = require('../comm/request')\n\nvar BlockDetector = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.isBlocked = true\n    try {\n      this.xhr = YBRequest.prototype.createXHR()\n      if (this.xhr.addEventListener) {\n        var url = Util.addProtocol('ww.zxcvwwds.com/ww/wwds/-imwwge-wwd_wwds.html', plugin.options['app.https'])\n        this.xhr.open('GET', url.replace(/ww/g, 'a'), true)\n        this.xhr.addEventListener('load', function () {\n          this.isBlocked = false\n        }.bind(this))\n        this.xhr.send()\n      }\n    } catch (err) {\n      // this.isBlocked = true\n    }\n  }\n})\n\nmodule.exports = BlockDetector\n","var YouboraObject = require('../object')\n/**\n * This static class provides screen scrolling and resizing detection methods.\n *\n * @class\n * @static\n * @memberof youbora\n */\nvar ResizeScrollDetector = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.pluginref = plugin\n    this.listenerReference = this._changeListener.bind(this)\n    this.loadReference = this._loadListener.bind(this)\n    this.isEnabled = false\n\n    this.pageHeight = 0\n    this.maxHeight = 0\n    this.startDetection()\n  },\n\n  startDetection: function () {\n    if (!this.isEnabled && typeof window !== 'undefined' && typeof window.addEventListener === 'function') {\n      window.addEventListener('scroll', this.listenerReference)\n      window.addEventListener('resize', this.listenerReference)\n      window.addEventListener('load', this.loadReference)\n      this.isEnabled = true\n    }\n  },\n\n  stopDetection: function () {\n    if (this.isEnabled && typeof window !== 'undefined' && typeof window.removeEventListener === 'function') {\n      window.removeEventListener('scroll', this.listenerReference)\n      window.removeEventListener('resize', this.listenerReference)\n      window.removeEventListener('load', this.loadReference)\n      this.isEnabled = false\n    }\n  },\n\n  getScrollDepth: function () {\n    var ret = null\n    if (this.maxHeight && this.pageHeight) {\n      ret = Math.min(Math.trunc((this.maxHeight / this.pageHeight) * 100), 100)\n    }\n    return ret\n  },\n\n  _loadListener: function () {\n    if (typeof document !== 'undefined') {\n      var docEl = document.documentElement\n      if (docEl) {\n        this.pageHeight = Math.round(docEl.scrollHeight, docEl.clientHeight, docEl.offsetHeight)\n        this.maxHeight = window.innerHeight\n        this._updateCompletionRate()\n      }\n    }\n  },\n\n  _changeListener: function () {\n    if (this.pageHeight) {\n      var prevHeight = this.maxHeight\n      this.maxHeight = Math.max(this.maxHeight, window.pageYOffset + window.innerHeight)\n      if (prevHeight !== this.maxHeight) {\n        this._updateCompletionRate()\n      }\n    }\n    var adsAdapter = this.pluginref.getAdsAdapter()\n    if (adsAdapter && adsAdapter.flags.isStarted) {\n      if (!adsAdapter.getIsVisible()) {\n        adsAdapter.stopChronoView()\n      } else {\n        adsAdapter.startChronoView()\n      }\n    }\n  },\n\n  _updateCompletionRate: function () {\n    setTimeout(function () {\n      this.pluginref.storage.setSession('pageScrollDepth', this.getScrollDepth())\n    }.bind(this), 3000)\n  }\n})\n\nmodule.exports = ResizeScrollDetector\n","/* global ActiveXObject */\nvar YouboraObject = require('../object')\n\nvar DataExtractor = YouboraObject.extend({\n  constructor: function (plugin) {\n    this.plugin = plugin\n  },\n\n  getAllData: function () {\n    var returnValue = this.getNonRandomData()\n    returnValue.timestamp = this.getTimestamp()\n    return returnValue\n  },\n\n  getNonRandomData: function () {\n    var returnValue = {}\n    returnValue.userAgent = this.getUserAgent()\n    returnValue.threads = this.getVirtualCores()\n    returnValue.language = this.getLanguage()\n    returnValue.langList = this.getAvailableLanguages()\n    returnValue.resolution = this.getResolution()\n    returnValue.colorDepth = this.getColorDepth()\n    returnValue.deviceMemory = this.getMemory()\n    returnValue.touchscreen = this.getTouchscreen()\n    returnValue.localStorage = this.getLocalStorage()\n    returnValue.sessionStorage = this.getSessionStorage()\n    returnValue.cookiesAvailable = this.getCookiesAvailable()\n    returnValue.flashAvailable = this.getHasFlash()\n    returnValue.timeZone = this.getTimeZone()\n    returnValue.plugins = this.getPluginList()\n    return returnValue\n  },\n\n  // Getters\n  getUserAgent: function () {\n    return this._getNavigatorValue('userAgent')\n  },\n\n  getVirtualCores: function () {\n    return this._getNavigatorValue('hardwareConcurrency')\n  },\n\n  getLanguage: function () {\n    return this._getNavigatorValue('language')\n  },\n\n  getAvailableLanguages: function () {\n    return this._getNavigatorValue('languages')\n  },\n\n  getResolution: function () {\n    var ret = null\n    try {\n      if (this._getNavigatorValue('screen')) {\n        ret = navigator.screen.width.toString() + navigator.screen.height.toString()\n      }\n    } catch (err) {\n      // ret = null\n    }\n    return ret\n  },\n\n  getColorDepth: function () {\n    var ret = null\n    try {\n      if (this._getNavigatorValue('screen')) {\n        ret = navigator.screen.colorDepth\n      }\n    } catch (err) {\n      // ret = null\n    }\n    return ret\n  },\n\n  getMemory: function () {\n    return this._getNavigatorValue('deviceMemory')\n  },\n\n  getTouchscreen: function () {\n    return this._getNavigatorValue('maxTouchPoints') || false\n  },\n\n  getLocalStorage: function () {\n    var ret = false\n    try {\n      ret = typeof localStorage !== 'undefined'\n    } catch (err) {\n      // ret = false\n    }\n    return ret\n  },\n\n  getSessionStorage: function () {\n    var ret = false\n    try {\n      ret = typeof sessionStorage !== 'undefined'\n    } catch (err) {\n      // ret = false\n    }\n    return ret\n  },\n\n  getCookiesAvailable: function () {\n    return this._getNavigatorValue('cookieEnabled') || false\n  },\n\n  getHasFlash: function () {\n    var ret = false\n    try {\n      var plugins = this._getNavigatorValue('plugins')\n      ret = (plugins && typeof plugins['Shockwave Flash'] === 'object') || (typeof window !== 'undefined' && window.ActiveXObject && (new ActiveXObject('ShockwaveFlash.ShockwaveFlash')) !== false)\n    } catch (err) {\n      // ret = false\n    }\n    return ret\n  },\n\n  getPluginList: function () {\n    var ret = null\n    try {\n      var plugins = this._getNavigatorValue('plugins')\n      if (plugins && plugins.length !== 0) {\n        var pluginlist = ''\n        for (var counter = 0; counter < navigator.plugins.length; counter++) {\n          pluginlist += navigator.plugins[counter].description + ' ' + navigator.plugins[counter].filename + ' ' + navigator.plugins[counter].name + ' '\n        }\n        ret = pluginlist\n      }\n    } catch (err) {\n      // return null\n    }\n    return ret\n  },\n\n  getTimeZone: function () {\n    var ret = null\n    try {\n      var date = new Date()\n      ret = date.getTimezoneOffset().toString()\n    } catch (err) {\n      // return null\n    }\n    return ret\n  },\n\n  getTimestamp: function () {\n    return new Date().getTime()\n  },\n\n  _navigatorCheck: function () {\n    return typeof navigator !== 'undefined'\n  },\n\n  _getNavigatorValue: function (key) {\n    var ret = null\n    try {\n      if (this._navigatorCheck()) {\n        ret = navigator[key]\n      }\n    } catch (err) {\n      // ret = null\n    }\n    return ret\n  }\n\n})\n\nmodule.exports = DataExtractor\n","/* istanbul ignore next */\nvar MD5 = function (s) { function L (k, d) { return (k << d) | (k >>> (32 - d)) } function K (G, k) { var I, d, F, H, x; F = (G & 2147483648); H = (k & 2147483648); I = (G & 1073741824); d = (k & 1073741824); x = (G & 1073741823) + (k & 1073741823); if (I & d) { return (x ^ 2147483648 ^ F ^ H) } if (I | d) { if (x & 1073741824) { return (x ^ 3221225472 ^ F ^ H) } else { return (x ^ 1073741824 ^ F ^ H) } } else { return (x ^ F ^ H) } } function r (d, F, k) { return (d & F) | ((~d) & k) } function q (d, F, k) { return (d & k) | (F & (~k)) } function p (d, F, k) { return (d ^ F ^ k) } function n (d, F, k) { return (F ^ (d | (~k))) } function u (G, F, aa, Z, k, H, I) { G = K(G, K(K(r(F, aa, Z), k), I)); return K(L(G, H), F) } function f (G, F, aa, Z, k, H, I) { G = K(G, K(K(q(F, aa, Z), k), I)); return K(L(G, H), F) } function D (G, F, aa, Z, k, H, I) { G = K(G, K(K(p(F, aa, Z), k), I)); return K(L(G, H), F) } function t (G, F, aa, Z, k, H, I) { G = K(G, K(K(n(F, aa, Z), k), I)); return K(L(G, H), F) } function e (G) { var Z; var F = G.length; var x = F + 8; var k = (x - (x % 64)) / 64; var I = (k + 1) * 16; var aa = Array(I - 1); var d = 0; var H = 0; while (H < F) { Z = (H - (H % 4)) / 4; d = (H % 4) * 8; aa[Z] = (aa[Z] | (G.charCodeAt(H) << d)); H++ } Z = (H - (H % 4)) / 4; d = (H % 4) * 8; aa[Z] = aa[Z] | (128 << d); aa[I - 2] = F << 3; aa[I - 1] = F >>> 29; return aa } function B (x) { var k = \"\", F = \"\", G, d; for (d = 0; d <= 3; d++) { G = (x >>> (d * 8)) & 255; F = \"0\" + G.toString(16); k = k + F.substr(F.length - 2, 2) } return k } function J (k) { k = k.replace(/rn/g, \"n\"); var d = \"\"; for (var F = 0; F < k.length; F++) { var x = k.charCodeAt(F); if (x < 128) { d += String.fromCharCode(x) } else { if ((x > 127) && (x < 2048)) { d += String.fromCharCode((x >> 6) | 192); d += String.fromCharCode((x & 63) | 128) } else { d += String.fromCharCode((x >> 12) | 224); d += String.fromCharCode(((x >> 6) & 63) | 128); d += String.fromCharCode((x & 63) | 128) } } } return d } var C = Array(); var P, h, E, v, g, Y, X, W, V; var S = 7, Q = 12, N = 17, M = 22; var A = 5, z = 9, y = 14, w = 20; var o = 4, m = 11, l = 16, j = 23; var U = 6, T = 10, R = 15, O = 21; s = J(s); C = e(s); Y = 1732584193; X = 4023233417; W = 2562383102; V = 271733878; for (P = 0; P < C.length; P += 16) { h = Y; E = X; v = W; g = V; Y = u(Y, X, W, V, C[P + 0], S, 3614090360); V = u(V, Y, X, W, C[P + 1], Q, 3905402710); W = u(W, V, Y, X, C[P + 2], N, 606105819); X = u(X, W, V, Y, C[P + 3], M, 3250441966); Y = u(Y, X, W, V, C[P + 4], S, 4118548399); V = u(V, Y, X, W, C[P + 5], Q, 1200080426); W = u(W, V, Y, X, C[P + 6], N, 2821735955); X = u(X, W, V, Y, C[P + 7], M, 4249261313); Y = u(Y, X, W, V, C[P + 8], S, 1770035416); V = u(V, Y, X, W, C[P + 9], Q, 2336552879); W = u(W, V, Y, X, C[P + 10], N, 4294925233); X = u(X, W, V, Y, C[P + 11], M, 2304563134); Y = u(Y, X, W, V, C[P + 12], S, 1804603682); V = u(V, Y, X, W, C[P + 13], Q, 4254626195); W = u(W, V, Y, X, C[P + 14], N, 2792965006); X = u(X, W, V, Y, C[P + 15], M, 1236535329); Y = f(Y, X, W, V, C[P + 1], A, 4129170786); V = f(V, Y, X, W, C[P + 6], z, 3225465664); W = f(W, V, Y, X, C[P + 11], y, 643717713); X = f(X, W, V, Y, C[P + 0], w, 3921069994); Y = f(Y, X, W, V, C[P + 5], A, 3593408605); V = f(V, Y, X, W, C[P + 10], z, 38016083); W = f(W, V, Y, X, C[P + 15], y, 3634488961); X = f(X, W, V, Y, C[P + 4], w, 3889429448); Y = f(Y, X, W, V, C[P + 9], A, 568446438); V = f(V, Y, X, W, C[P + 14], z, 3275163606); W = f(W, V, Y, X, C[P + 3], y, 4107603335); X = f(X, W, V, Y, C[P + 8], w, 1163531501); Y = f(Y, X, W, V, C[P + 13], A, 2850285829); V = f(V, Y, X, W, C[P + 2], z, 4243563512); W = f(W, V, Y, X, C[P + 7], y, 1735328473); X = f(X, W, V, Y, C[P + 12], w, 2368359562); Y = D(Y, X, W, V, C[P + 5], o, 4294588738); V = D(V, Y, X, W, C[P + 8], m, 2272392833); W = D(W, V, Y, X, C[P + 11], l, 1839030562); X = D(X, W, V, Y, C[P + 14], j, 4259657740); Y = D(Y, X, W, V, C[P + 1], o, 2763975236); V = D(V, Y, X, W, C[P + 4], m, 1272893353); W = D(W, V, Y, X, C[P + 7], l, 4139469664); X = D(X, W, V, Y, C[P + 10], j, 3200236656); Y = D(Y, X, W, V, C[P + 13], o, 681279174); V = D(V, Y, X, W, C[P + 0], m, 3936430074); W = D(W, V, Y, X, C[P + 3], l, 3572445317); X = D(X, W, V, Y, C[P + 6], j, 76029189); Y = D(Y, X, W, V, C[P + 9], o, 3654602809); V = D(V, Y, X, W, C[P + 12], m, 3873151461); W = D(W, V, Y, X, C[P + 15], l, 530742520); X = D(X, W, V, Y, C[P + 2], j, 3299628645); Y = t(Y, X, W, V, C[P + 0], U, 4096336452); V = t(V, Y, X, W, C[P + 7], T, 1126891415); W = t(W, V, Y, X, C[P + 14], R, 2878612391); X = t(X, W, V, Y, C[P + 5], O, 4237533241); Y = t(Y, X, W, V, C[P + 12], U, 1700485571); V = t(V, Y, X, W, C[P + 3], T, 2399980690); W = t(W, V, Y, X, C[P + 10], R, 4293915773); X = t(X, W, V, Y, C[P + 1], O, 2240044497); Y = t(Y, X, W, V, C[P + 8], U, 1873313359); V = t(V, Y, X, W, C[P + 15], T, 4264355552); W = t(W, V, Y, X, C[P + 6], R, 2734768916); X = t(X, W, V, Y, C[P + 13], O, 1309151649); Y = t(Y, X, W, V, C[P + 4], U, 4149444226); V = t(V, Y, X, W, C[P + 11], T, 3174756917); W = t(W, V, Y, X, C[P + 2], R, 718787259); X = t(X, W, V, Y, C[P + 9], O, 3951481745); Y = K(Y, h); X = K(X, E); W = K(W, v); V = K(V, g) } var i = B(Y) + B(X) + B(W) + B(V); return i.toLowerCase() }\nmodule.exports = MD5\n","var Log = require('../log')\nvar Constants = require('../constants')\nvar Util = require('../util')\nvar Adapter = require('../adapter/adapter')\n\n// This file is designed to add extra functionalities to Plugin class\n\n/** @lends youbora.Plugin.prototype */\nvar PluginContentMixin = {\n  /**\n   * Sets an adapter for video content.\n   *\n   * @param {Adapter} adapter\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  setAdapter: function (adapter) {\n    if (this.browserLoadTimes) this.browserLoadTimes.setPlayerSetupTime()\n    if (adapter.plugin) {\n      Log.warn('Adapters can only be added to a single plugin')\n    } else {\n      this.removeAdapter()\n\n      this._adapter = adapter\n      adapter.plugin = this\n      adapter.setIsAds(false)\n\n      // Register listeners\n      this.contentAdapterListeners = {}\n      this.contentAdapterListeners[Adapter.Event.START] = this._startListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.JOIN] = this._joinListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.PAUSE] = this._pauseListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.RESUME] = this._resumeListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.SEEK_BEGIN] = this._seekBufferBeginListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.SEEK_END] = this._seekEndListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.BUFFER_BEGIN] = this._seekBufferBeginListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.BUFFER_END] = this._bufferEndListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.ERROR] = this._errorListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.STOP] = this._stopListener.bind(this)\n      this.contentAdapterListeners[Adapter.Event.VIDEO_EVENT] = this._videoEventListener.bind(this)\n\n      for (var key in this.contentAdapterListeners) {\n        this._adapter.on(key, this.contentAdapterListeners[key])\n      }\n    }\n  },\n\n  /**\n   * Returns current adapter or null.\n   *\n   * @returns {Adapter}\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdapter: function () {\n    return this._adapter\n  },\n\n  /**\n   * Removes the current adapter. Fires stop if needed. Calls adapter.dispose().\n   *\n   * @memberof youbora.Plugin.prototype\n   * */\n  removeAdapter: function () {\n    if (this._adapter) {\n      this._adapter.dispose()\n      this._adapter.plugin = null\n\n      if (this.contentAdapterListeners) {\n        for (var key in this.contentAdapterListeners) {\n          this._adapter.off(key, this.contentAdapterListeners[key])\n        }\n        delete this.contentAdapterListeners\n      }\n\n      this._adapter = null\n    }\n  },\n\n  // ---------------------------------------- LISTENERS -----------------------------------------\n  _startListener: function (e) {\n    if (!this.isInitiated) {\n      this.viewTransform.nextView()\n      this._initComm()\n      this._startPings()\n    } else if (this.initChrono.startTime !== 0) {\n      this._adapter.chronos.join.startTime = this.initChrono.startTime\n    }\n    var params = e.data.params || {}\n    var allParamsReady = this.getResource() && typeof this.getIsLive() === 'boolean' &&\n      (this.getIsLive() || (typeof this.getDuration() === 'number' && this.getDuration() > 0)) && this.getTitle()\n    allParamsReady = this.options.forceInit ? false : (allParamsReady && this._isExtraMetadataReady())\n    if (allParamsReady && !this.isInitiated) { // start\n      this._send(Constants.WillSendEvent.WILL_SEND_START, Constants.Service.START, params)\n      this._adSavedError()\n      this._adSavedManifest()\n      Log.notice(Constants.Service.START + ' ' + (params.title || params.mediaResource))\n      this.isStarted = true\n      // chrono if had no adapter when inited\n    } else if (!this.isInitiated) { // init\n      this.isInitiated = true\n      this._adapter.chronos.join.start()\n      this._send(Constants.WillSendEvent.WILL_SEND_INIT, Constants.Service.INIT, params)\n      this._adSavedError()\n      this._adSavedManifest()\n      Log.notice(Constants.Service.INIT + ' ' + (params.title || params.mediaResource))\n    }\n  },\n\n  _retryStart: function (e) {\n    if (this._isExtraMetadataReady()) {\n      this._send(Constants.WillSendEvent.WILL_SEND_START, Constants.Service.START, {})\n      this.startDelayed = false\n    }\n  },\n\n  _joinListener: function (e) {\n    var params = {}\n    Util.assign(params, e.data.params || {})\n    if (!this._adsAdapter || !this._adsAdapter.flags.isStarted) {\n      if (this._adsAdapter) {\n        this._adapter.chronos.join.startTime = Math.min(\n          this._adapter.chronos.join.startTime + (this._totalPrerollsTime || 0),\n          new Date().getTime()\n        )\n        this._totalPrerollsTime = 0\n      }\n      if (this.isInitiated && !this.isStarted) { // start if just inited\n        if (this._isExtraMetadataReady()) {\n          this._send(Constants.WillSendEvent.WILL_SEND_START, Constants.Service.START, params)\n        } else {\n          this.startDelayed = true\n        }\n        this._adSavedError()\n        this._adSavedManifest()\n        Log.notice(Constants.Service.START + ' ' + (params.title || params.mediaResource))\n        this.isStarted = true\n      }\n      params = e.data.params || {}\n      if (this._adsAdapter && this.isBreakStarted) {\n        this._adsAdapter.fireBreakStop()\n      }\n      this._send(Constants.WillSendEvent.WILL_SEND_JOIN, Constants.Service.JOIN, params)\n      Log.notice(Constants.Service.JOIN + ' ' + params.joinDuration + 'ms')\n    } else { // If it is currently showing ads, join is invalidated\n      if (this._adapter.monitor) this._adapter.monitor.stop()\n      this._adapter.flags.isJoined = false\n      this._adapter.chronos.join.stopTime = 0\n    }\n  },\n\n  _pauseListener: function (e) {\n    if (this._adapter) {\n      if (this._adapter.flags.isBuffering ||\n        this._adapter.flags.isSeeking ||\n        (this._adsAdapter && this._adsAdapter.flags.isStarted)) {\n        this._adapter.chronos.pause.reset()\n      }\n    }\n\n    var params = e.data.params || {}\n    this._send(Constants.WillSendEvent.WILL_SEND_PAUSE, Constants.Service.PAUSE, params)\n    Log.notice(Constants.Service.PAUSE + ' at ' + params.playhead + 's')\n  },\n\n  _resumeListener: function (e) {\n    if (this._adsAdapter && this.isBreakStarted && !this._adsAdapter.flags.isStarted) {\n      this._adsAdapter.fireBreakStop()\n    }\n    var params = e.data.params || {}\n    this._send(Constants.WillSendEvent.WILL_SEND_RESUME, Constants.Service.RESUME, params)\n    Log.notice(Constants.Service.RESUME + ' ' + params.pauseDuration + 'ms')\n    this._adapter.chronos.pause.reset()\n  },\n\n  _seekEndListener: function (e) {\n    var params = e.data.params || {}\n    this._send(Constants.WillSendEvent.WILL_SEND_SEEK, Constants.Service.SEEK, params)\n    Log.notice(Constants.Service.SEEK +\n      ' to ' + params.playhead +\n      ' in ' + params.seekDuration + 'ms'\n    )\n  },\n\n  _seekBufferBeginListener: function (e) {\n    if (this._adapter && this._adapter.flags.isPaused) this._adapter.chronos.pause.reset()\n    Log.notice(e.type)\n  },\n\n  _bufferEndListener: function (e) {\n    var params = e.data.params || {}\n    this._send(Constants.WillSendEvent.WILL_SEND_BUFFER, Constants.Service.BUFFER, params)\n    Log.notice(Constants.Service.BUFFER +\n      ' to ' + params.playhead +\n      ' in ' + params.bufferDuration + 'ms'\n    )\n  },\n\n  _errorListener: function (e) {\n    if (!this._blockError(e.data.params)) {\n      this.fireError(e.data.params || {})\n      this._adSavedError()\n      this._adSavedManifest()\n    }\n  },\n\n  _blockError: function (errorParams) {\n    var now = Date.now()\n    var sameError = this._lastErrorParams\n      ? this._lastErrorParams.errorCode === errorParams.errorCode && this._lastErrorParams.msg === errorParams.msg\n      : false\n    if (sameError && this._lastErrorTime + 5000 > now) {\n      this._lastErrorTime = now\n      return true\n    }\n    this._lastErrorTime = now\n    this._lastErrorParams = errorParams\n    return false\n  },\n\n  _stopListener: function (e) {\n    this.fireStop(e.data.params || {})\n  },\n\n  _isStopReady: function (e) {\n    var ret = false\n    // this solution is only for the case of:\n    if (!this.requestBuilder.lastSent.live && // VOD, live have no postrolls\n      this._adsAdapter && // having ads adapter connected\n      this._adapter && // playhead close to the end of the content (or 0 because is already restarted)\n      (!this._adapter.getPlayhead() || this._adapter.getPlayhead() >= this.requestBuilder.lastSent.mediaDuration - 1)) {\n      var expectedPostrolls = 0\n      var pat = this.options['ad.expectedPattern']\n      // We can get the expectedPostrolls from the expected pattern if it has postrolls defined\n      if (pat && pat.post && pat.post[0]) {\n        expectedPostrolls = pat.post[0]\n        // If not, while playing postrolls after adbreakstart we can get the givenAds\n      } else if (this.requestBuilder.lastSent.breaksTime) {\n        if (this.requestBuilder.lastSent.position === Constants.AdPosition.Postroll) {\n          expectedPostrolls = this.requestBuilder.lastSent.givenAds\n        }\n        // Or before playing postrolls, at least, we can check using breaksTime (from adManifest event) if we expect at least 1 postroll\n        if (!expectedPostrolls && this.requestBuilder.lastSent.breaksTime) {\n          var breaks = this.requestBuilder.lastSent.breaksTime\n          if (breaks.length > 0 && this.requestBuilder.lastSent.mediaDuration) { // If there is no duration probably is a live content, so no postrolls\n            var lastTimePosition = Math.round(breaks[breaks.length - 1])\n            if (lastTimePosition + 1 >= this.requestBuilder.lastSent.mediaDuration) {\n              expectedPostrolls = 1\n            }\n          }\n        }\n        // If none of the previous solutions found anything, we assume we have no postrolls\n      } else {\n        ret = true\n      }\n      // Finally, if the number of played postrolls is the same (or more) than the expected, we can close the view\n      if (expectedPostrolls <= this.playedPostrolls) {\n        ret = true\n      }\n    } else {\n      ret = true\n    }\n    return ret\n  },\n\n  _videoEventListener: function (e) {\n    this._send(Constants.WillSendEvent.WILL_SEND_VIDEO_EVENT, Constants.Service.VIDEO_EVENT, e.data.params)\n  },\n\n  _isExtraMetadataReady: function (e) {\n    // If the option is disabled, always is ready\n    if (!this.options.waitForMetadata || this.options.pendingMetadata.length < 1) return true\n    // If for existing parameters, one of them is false (no value for it), return false\n    var getters = this.requestBuilder.getGetters()\n    return this.options.pendingMetadata.map(function (element) {\n      if (getters.hasOwnProperty(element)) { // eslint-disable-line no-prototype-builtins\n        return !!this[getters[element]]()\n      }\n    }.bind(this)).indexOf(false) < 0\n  }\n}\n\nmodule.exports = PluginContentMixin\n","var YouboraObject = require('../object')\nvar Chrono = require('../chrono')\n\nvar PlaybackChronos = YouboraObject.extend(\n  /** @lends youbora.PlaybackChronos.prototype */\n  {\n    /**\n     * This class contains all the {@link Chrono}s related to view status.\n     * Chronos measure time lapses between events.\n     * ie: between start and join, between seek-begin and seek-end, etc.\n     * Each plugin will have an instance of this class.\n     *\n     * @constructs PlaybackChronos\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     */\n    constructor: function () {\n      this.reset()\n    },\n\n    /** Reset flag values */\n    reset: function () {\n      /** Chrono between start and joinTime. */\n      this.join = new Chrono()\n\n      /** Chrono between seek-begin and seek-end. */\n      this.seek = new Chrono()\n\n      /** Chrono between pause and resume. */\n      this.pause = new Chrono()\n\n      /** Chrono between buffer-begin and buffer-end. */\n      this.buffer = new Chrono()\n\n      /** Chrono for the totality of the view. */\n      this.total = new Chrono()\n\n      // For ads\n\n      /** List of chronos with seen intervals */\n      this.viewedMax = []\n    }\n  }\n)\n\nmodule.exports = PlaybackChronos\n","var YouboraObject = require('../object')\n\nvar PlaybackFlags = YouboraObject.extend(\n  /** @lends youbora.PlaybackFlags.prototype */\n  {\n    /**\n     * This class contains all the flags related to view status.\n     * Each plugin will have an instance of this class.\n     *\n     * @constructs PlaybackFlags\n     * @extends youbora.YouboraObject\n     * @memberof youbora\n     */\n    constructor: function () {\n      this.reset()\n    },\n\n    /** Reset flag values */\n    reset: function () {\n      /** Flag when Start has been sent. */\n      this.isStarted = false\n\n      /** Flag when Join has been sent. */\n      this.isJoined = false\n\n      /** Flag when Player is paused. */\n      this.isPaused = false\n\n      /** Flag when Player is seeking. */\n      this.isSeeking = false\n\n      /** Flag when Player is buffering. */\n      this.isBuffering = false\n\n      /** Flag when Player is ended. */\n      this.isEnded = false\n\n      /** Flag when Player view ends and stop is already sent. */\n      this.isStopped = false\n\n      /** Flag with last quartile sent. */\n      this.lastQuartileSent = 0\n    }\n  }\n)\n\nmodule.exports = PlaybackFlags\n","var AdapterConstants = require('../constants/adapter')\nvar Chrono = require('../chrono')\n\nvar AdapterAdsMixin = {\n  /** Override to return current ad position */\n  getPosition: function () {\n    return null\n  },\n\n  /** Override to return the given ad structure (list with number of pre, mid, and post breaks) */\n  getGivenBreaks: function () {\n    return null\n  },\n\n  /** Override to return the ad structure requested (list with number of pre, mid, and post breaks) */\n  getExpectedBreaks: function () {\n    return null\n  },\n\n  /** Override to return the structure of ads requested */\n  getExpectedPattern: function () {\n    return null\n  },\n\n  /** Override to return a list of playheads of ad breaks begin time */\n  getBreaksTime: function () {\n    return null\n  },\n\n  /** Override to return the number of ads given for the break */\n  getGivenAds: function () {\n    return null\n  },\n\n  /** Override to return the number of ads requested for the break */\n  getExpectedAds: function () {\n    return null\n  },\n\n  /** Override to return if the ad is being shown in the screen or not\n   * The standard definition is: more than 50% of the pixels of the ad are on the screen\n   */\n  getIsVisible: function () {\n    return true\n  },\n\n  /** Override to return a boolean showing if the audio is enabled when the ad begins */\n  getAudioEnabled: function () {\n    return null\n  },\n\n  /** Override to return if the ad is skippable */\n  getIsSkippable: function () {\n    return null\n  },\n\n  /** Override to return a boolean showing if the player is in fullscreen mode when the ad begins */\n  getIsFullscreen: function () {\n    return null\n  },\n\n  /** Override to return the ad campaign */\n  getCampaign: function () {\n    return null\n  },\n\n  /** Override to return the ad creative id */\n  getCreativeId: function () {\n    return null\n  },\n\n  /** Override to return the ad provider name */\n  getProvider: function () {\n    return null\n  },\n\n  /** Override to return the ad insertion type\n   * Use constants:\n   * youbora.Constants.AdInsertionType.ClientSide\n   * youbora.Constants.AdInsertionType.ServerSide\n  */\n  getAdInsertionType: function () {\n    return null\n  },\n\n  /**\n * Emits related event and set flags if current status is valid.\n * ie: won't sent start if isStarted is already true.\n *\n * @param {Object} [params] Object of key:value params to add to the request.\n */\n  fireClick: function (params) {\n    if (typeof params === 'string') {\n      params = { url: params }\n    }\n    this.emit(AdapterConstants.Event.CLICK, { params: params })\n  },\n\n  /**\n   * Emits related event and set flags if current status is valid.\n   * ie: won't sent start if isStarted is already true.\n   *\n   * @param {Object} [params] Object of key:value params to add to the request.\n   */\n  fireQuartile: function (quartile) {\n    if (this.flags.isStarted && typeof quartile === 'number' &&\n      quartile > this.flags.lastQuartileSent && quartile < 4) {\n      this.flags.lastQuartileSent++\n      this.emit(AdapterConstants.Event.QUARTILE, { params: { quartile: quartile } })\n    }\n  },\n\n  /**\n  * Starts a new chrono for viewedMax and restarts viewedAcum\n  */\n  startChronoView: function () {\n    if (this.getIsVisible() && !this.plugin.backgroundDetector.isInBackground) {\n      var max = this.chronos.viewedMax\n      if (max.length === 0 || max[max.length - 1].stopTime !== 0) {\n        max.push(new Chrono())\n        max[max.length - 1].start()\n      }\n    }\n  },\n\n  /**\n  * Stops a new chrono for viewedMax and restarts viewedAcum\n  */\n  stopChronoView: function () {\n    var max = this.chronos.viewedMax\n    if (max[0] && max.length > 0 && max[max.length - 1].stopTime === 0) {\n      max[max.length - 1].stop()\n    }\n  },\n\n  /**\n  * @param {Object} [params] Object of key:value params to add to the request.\n  */\n  fireManifest: function (params, message) {\n    var paramsObject = { params: params }\n    if (typeof params === 'string') {\n      paramsObject = { params: { errorType: params, errorMessage: message } }\n    }\n    this.emit(AdapterConstants.Event.MANIFEST, paramsObject)\n  },\n\n  /*\n  * Emits related event and set flags if current status is valid.\n  * ie: won't sent start if isStarted is already true.\n  *\n  * @param {Object} [params] Object of key:value params to add to the request.\n  */\n  fireSkip: function (params) {\n    if (params === undefined) {\n      params = {}\n    }\n    params.skipped = true\n    this.fireStop(params)\n  },\n\n  /**\n  * Emits related event and set flags if current status is valid.\n  * ie: won't sent start if isStarted is already true.\n  *\n  * @param {Object} [params] Object of key:value params to add to the request.\n  */\n  fireBreakStart: function (params) {\n    this.emit(AdapterConstants.Event.PODSTART, { params: params })\n  },\n\n  /**\n  * Emits related event and set flags if current status is valid.\n  * ie: won't sent start if isStarted is already true.\n  *\n  * @param {Object} [params] Object of key:value params to add to the request.\n  */\n  fireBreakStop: function (params) {\n    this.emit(AdapterConstants.Event.PODSTOP, { params: params })\n  }\n}\n\nmodule.exports = AdapterAdsMixin\n","var AdapterConstants = require('../constants/adapter')\nvar Log = require('../log')\n\nvar AdapterContentMixin = {\n  /** Override to return current playrate */\n  getPlayrate: function () {\n    return !this.flags.isPaused ? 1 : 0\n  },\n\n  /** Override to return Frames Per Secon (FPS) */\n  getFramesPerSecond: function () {\n    return null\n  },\n\n  /** Override to return dropped frames since start */\n  getDroppedFrames: function () {\n    return null\n  },\n\n  /** Override to return user bandwidth throughput */\n  getThroughput: function () {\n    return null\n  },\n\n  /** Override to return rendition */\n  getRendition: function () {\n    return null\n  },\n\n  /** Override to return title2 */\n  getTitle2: function () {\n    return null\n  },\n\n  /** Override to recurn true if live and false if VOD */\n  getIsLive: function () {\n    return null\n  },\n\n  /** Override to return CDN traffic bytes not using streamroot or peer5. */\n  getCdnTraffic: function () {\n    return null\n  },\n\n  /** Override to return P2P traffic bytes not using streamroot or peer5. */\n  getP2PTraffic: function () {\n    return null\n  },\n\n  /** Override to return P2P traffic sent in bytes, not using streamroot or peer5. */\n  getUploadTraffic: function () {\n    return null\n  },\n\n  /** Override to return if P2P is enabled not using streamroot or peer5. */\n  getIsP2PEnabled: function () {\n    return null\n  },\n  /** Override to return household id */\n  getHouseholdId: function () {\n    return null\n  },\n\n  /** Override to return the latency */\n  getLatency: function () {\n    return null\n  },\n\n  /** Override to return the number of packets lost */\n  getPacketLoss: function () {\n    return null\n  },\n\n  /** Override to return the number of packets sent */\n  getPacketSent: function () {\n    return null\n  },\n\n  /** Override to return a json with metrics */\n  getMetrics: function () {\n    return null\n  },\n\n  /** Override to return the audio codec */\n  getAudioCodec: function () {\n    return null\n  },\n\n  /** Override to return the video codec */\n  getVideoCodec: function () {\n    return null\n  },\n\n  /** Override to return a chunk or intermediate manifest url */\n  getURLToParse: function () {\n    return null\n  },\n\n  /**\n * Emits related event and set flags if current status is valid.\n * ie: won't sent start if isStarted is already true.\n *\n * @param {Object} [params] Object of key:value params to add to the request.\n * @param {bool} [convertFromBuffer=true] If false, will convert current buffer to seek.\n */\n  fireSeekBegin: function (params, convertFromBuffer) {\n    if (this.plugin && this.plugin.getIsLive() && this.plugin.options['content.isLive.noSeek']) return null\n    if (this.flags.isJoined && !this.flags.isSeeking) {\n      if (this.flags.isBuffering) {\n        if (convertFromBuffer !== false) {\n          Log.notice('Converting current buffer to seek')\n\n          this.chronos.seek = this.chronos.buffer.clone()\n          this.chronos.buffer.reset()\n\n          this.flags.isBuffering = false\n        } else {\n          return\n        }\n      } else {\n        this.chronos.seek.start()\n      }\n\n      this.flags.isSeeking = true\n      this.emit(AdapterConstants.Event.SEEK_BEGIN, { params: params })\n    }\n  },\n\n  /**\n   * Emits related event and set flags if current status is valid.\n   * ie: won't sent start if isStarted is already true.\n   *\n   * @param {Object} [params] Object of key:value params to add to the request.\n   */\n  fireSeekEnd: function (params) {\n    if (this.plugin && this.plugin.getIsLive() && this.plugin.options['content.isLive.noSeek']) return null\n    if (this.flags.isJoined && this.flags.isSeeking) {\n      this.cancelSeek()\n      this.emit(AdapterConstants.Event.SEEK_END, { params: params })\n    }\n  },\n\n  /**\n   *\n   * @param {Object} [params] Object of key:value params to add to the request.\n   */\n  cancelSeek: function (params) {\n    if (this.flags.isJoined && this.flags.isSeeking) {\n      this.flags.isSeeking = false\n\n      this.chronos.seek.stop()\n\n      if (this.monitor) this.monitor.skipNextTick()\n    }\n  },\n\n  /**\n * Emits event request.\n *\n * @param {Object} [params] Object of key:value params to add to the request.\n */\n  fireEvent: function (eventName, dimensions, values, topLevelDimensions) {\n    var returnparams = topLevelDimensions || {}\n    returnparams.name = eventName || ''\n    returnparams.dimensions = dimensions || {}\n    returnparams.values = values || {}\n    this.emit(AdapterConstants.Event.VIDEO_EVENT, { params: returnparams })\n  }\n}\n\nmodule.exports = AdapterContentMixin\n","var Util = require('../util')\n\nvar version = require('../version')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginGetterMixin = {\n  /**\n     * Returns service host\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getHost: function () {\n    var host = this.options.host\n    if (this.viewTransform && this.viewTransform.response && this.viewTransform.response.host) {\n      host = this.viewTransform.response.host\n    }\n    return Util.addProtocol(Util.stripProtocol(host), this.options['app.https'])\n  },\n\n  getUserType: function () {\n    return this.options['user.type']\n  },\n\n  /**\n     * Returns parse Manifest Flag\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  isParseManifest: function () {\n    return this.options['parse.manifest']\n  },\n\n  /**\n     * Returns parse CdnNode Flag\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  isParseCdnNode: function () {\n    return this.options['parse.cdnNode']\n  },\n\n  /**\n     * Returns parse cdn switch Flag\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  isCdnSwitch: function () {\n    return this.options['parse.cdnSwitchHeader']\n  },\n\n  /**\n     * Returns Cdn list\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getParseCdnNodeList: function () {\n    return this.options['parse.cdnNode.list']\n  },\n\n  /**\n     * Returns Cdn header name\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getParseCdnNodeNameHeader: function () {\n    return this.options['parse.cdnNameHeader']\n  },\n\n  /**\n     * Returns obfuscateIp option\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getObfuscateIp: function () {\n    return this.options['user.obfuscateIp']\n  },\n\n  /**\n     * Returns content's Extraparam1\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam1: function () {\n    return this.options['content.customDimension.1']\n  },\n\n  /**\n     * Returns content's Extraparam2\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam2: function () {\n    return this.options['content.customDimension.2']\n  },\n\n  /**\n     * Returns content's Extraparam3\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam3: function () {\n    return this.options['content.customDimension.3']\n  },\n\n  /**\n     * Returns content's Extraparam4\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam4: function () {\n    return this.options['content.customDimension.4']\n  },\n  /**\n     * Returns content's Extraparam5\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam5: function () {\n    return this.options['content.customDimension.5']\n  },\n\n  /**\n     * Returns content's Extraparam6\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam6: function () {\n    return this.options['content.customDimension.6']\n  },\n\n  /**\n     * Returns content's Extraparam7\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam7: function () {\n    return this.options['content.customDimension.7']\n  },\n\n  /**\n     * Returns content's Extraparam8\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam8: function () {\n    return this.options['content.customDimension.8']\n  },\n\n  /**\n     * Returns content's Extraparam9\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam9: function () {\n    return this.options['content.customDimension.9']\n  },\n\n  /**\n     * Returns content's Extraparam10\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam10: function () {\n    return this.options['content.customDimension.10']\n  },\n\n  /**\n     * Returns content's Extraparam11\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam11: function () {\n    return this.options['content.customDimension.11']\n  },\n\n  /**\n     * Returns content's Extraparam12\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam12: function () {\n    return this.options['content.customDimension.12']\n  },\n\n  /**\n     * Returns content's Extraparam13\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam13: function () {\n    return this.options['content.customDimension.13']\n  },\n\n  /**\n     * Returns content's Extraparam14\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam14: function () {\n    return this.options['content.customDimension.14']\n  },\n  /**\n     * Returns content's Extraparam15\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam15: function () {\n    return this.options['content.customDimension.15']\n  },\n\n  /**\n     * Returns content's Extraparam16\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam16: function () {\n    return this.options['content.customDimension.16']\n  },\n\n  /**\n     * Returns content's Extraparam17\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam17: function () {\n    return this.options['content.customDimension.17']\n  },\n\n  /**\n     * Returns content's Extraparam18\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam18: function () {\n    return this.options['content.customDimension.18']\n  },\n\n  /**\n     * Returns content's Extraparam19\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam19: function () {\n    return this.options['content.customDimension.19']\n  },\n\n  /**\n     * Returns content's Extraparam20\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getExtraparam20: function () {\n    return this.options['content.customDimension.20']\n  },\n\n  /**\n     * Returns ad's Extraparam1\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam1: function () {\n    return this.options['ad.customDimension.1']\n  },\n\n  /**\n     * Returns ad's Extraparam2\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam2: function () {\n    return this.options['ad.customDimension.2']\n  },\n\n  /**\n     * Returns ad's Extraparam3\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam3: function () {\n    return this.options['ad.customDimension.3']\n  },\n\n  /**\n     * Returns ad's Extraparam4\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam4: function () {\n    return this.options['ad.customDimension.4']\n  },\n  /**\n     * Returns ad's Extraparam5\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam5: function () {\n    return this.options['ad.customDimension.5']\n  },\n\n  /**\n     * Returns ad's Extraparam6\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam6: function () {\n    return this.options['ad.customDimension.6']\n  },\n\n  /**\n     * Returns ad's Extraparam7\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam7: function () {\n    return this.options['ad.customDimension.7']\n  },\n\n  /**\n     * Returns ad's Extraparam8\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam8: function () {\n    return this.options['ad.customDimension.8']\n  },\n\n  /**\n     * Returns ad's Extraparam9\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam9: function () {\n    return this.options['ad.customDimension.9']\n  },\n\n  /**\n     * Returns ad's Extraparam10\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdExtraparam10: function () {\n    return this.options['ad.customDimension.10']\n  },\n\n  /**\n     * Returns PluginInfo\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getPluginInfo: function () {\n    var ret = {\n      lib: version,\n      adapter: this.getAdapterVersion(),\n      adAdapter: this.getAdAdapterVersion()\n    }\n    return ret\n  },\n\n  /**\n     * Returns Ip\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getIp: function () {\n    return this.options['network.ip']\n  },\n\n  /**\n     * Returns Isp\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getIsp: function () {\n    return this.options['network.isp']\n  },\n\n  /**\n     * Returns ConnectionType\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getConnectionType: function () {\n    return this.options['network.connectionType']\n  },\n\n  /** Returns deviceInfo json\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getDeviceInfo: function () {\n    var info = {}\n    if (this.getDeviceCode()) info.deviceCode = this.getDeviceCode()\n    if (this.getModel()) info.model = this.getModel()\n    if (this.getBrand()) info.brand = this.getBrand()\n    if (this.getDeviceType()) info.deviceType = this.getDeviceType()\n    if (this.getDeviceName()) info.deviceName = this.getDeviceName()\n    if (this.getOsName()) info.osName = this.getOsName()\n    if (this.getOsVersion()) info.osVersion = this.getOsVersion()\n    if (this.getBrowserName()) info.browserName = this.getBrowserName()\n    if (this.getBrowserVersion()) info.browserVersion = this.getBrowserVersion()\n    if (this.getBrowserType()) info.browserType = this.getBrowserType()\n    if (this.getBrowserEngine()) info.browserEngine = this.getBrowserEngine()\n    return (info !== {} ? info : null)\n  },\n\n  /**\n     * Returns DeviceCode\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getDeviceCode: function () {\n    return this.options['device.code']\n  },\n\n  /**\n     * Returns Device model\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getModel: function () {\n    return this.options['device.model']\n  },\n\n  /**\n     * Returns Device brand\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getBrand: function () {\n    return this.options['device.brand']\n  },\n\n  /**\n     * Returns Device type\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getDeviceType: function () {\n    return this.options['device.type']\n  },\n\n  /**\n     * Returns Device name\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getDeviceName: function () {\n    return this.options['device.name']\n  },\n\n  /**\n     * Returns Device OS name\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getOsName: function () {\n    return this.options['device.osName']\n  },\n\n  /**\n     * Returns Device OS Version\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getOsVersion: function () {\n    return this.options['device.osVersion']\n  },\n\n  /**\n     * Returns Device browser name\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getBrowserName: function () {\n    return this.options['device.browserName']\n  },\n\n  /**\n     * Returns Device browser version\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getBrowserVersion: function () {\n    return this.options['device.browserVersion']\n  },\n\n  /**\n     * Returns Device browser type\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getBrowserType: function () {\n    return this.options['device.browserType']\n  },\n\n  /**\n     * Returns DeviceCode\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getBrowserEngine: function () {\n    return this.options['device.browserEngine']\n  },\n\n  /**\n     * Returns AccountCode\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAccountCode: function () {\n    return this.options.accountCode\n  },\n\n  /**\n     * Returns Username\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getUsername: function () {\n    return this.options['user.name']\n  },\n\n  /**\n     * Returns AnonymousUser\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAnonymousUser: function () {\n    return this.options['user.anonymousId']\n  },\n\n  /**\n     * Returns user email\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getEmail: function () {\n    return this.options['user.email']\n  },\n\n  /**\n     * Get URL referer.\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getReferer: function () {\n    var ret = this.options.referer || ''\n    if (!ret && typeof window !== 'undefined' && window.location) {\n      ret = window.location.href\n    }\n    return ret\n  },\n\n  /**\n     * Get URL referral.\n     * Previous page url.\n     * @memberof youbora.Plugin.prototype\n     */\n  getReferral: function () {\n    var ret = this.options.referral || ''\n    if (!ret && typeof document !== 'undefined') {\n      ret = document.referrer\n    }\n    return ret\n  },\n\n  /**\n     * Get Browser language\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getLanguage: function () {\n    var ret = null\n    if (typeof navigator !== 'undefined') {\n      ret = navigator.language\n    }\n    return ret\n  },\n\n  /**\n     * Returns the nodehost\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getNodeHost: function () {\n    return this.options['content.cdnNode'] || this.resourceTransform.getNodeHost()\n  },\n\n  /**\n     * Returns the node type id\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getNodeType: function () {\n    return this.options['content.cdnType'] || this.resourceTransform.getNodeType()\n  },\n\n  /**\n     * Returns the node type string\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getNodeTypeString: function () {\n    return this.resourceTransform.getNodeTypeString()\n  },\n\n  /**\n     * Returns requestNumber value, to prevent /data calls being cached\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getRequestNumber: function () {\n    return Math.random()\n  },\n\n  /**\n     * Returns a whole offline view and its id.\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getOfflineView: function () {\n    var ret = null\n    if (this.offlineStorage) {\n      ret = this.offlineStorage.getView()\n    }\n    return ret\n  },\n\n  getDeviceUUID: function () {\n    var id = null\n    if (!this.options['device.isAnonymous']) {\n      id = this.options['device.id'] || this.uuidGenerator.getKey()\n    }\n    return id\n  },\n\n  getSmartswitchConfigCode: function () {\n    return this.options['smartswitch.configCode']\n  },\n\n  getSmartswitchGroupCode: function () {\n    return this.options['smartswitch.groupCode']\n  },\n\n  getSmartswitchContractCode: function () {\n    return this.options['smartswitch.contractCode']\n  },\n\n  getAppName: function () {\n    return this.options['app.name']\n  },\n\n  getAppReleaseVersion: function () {\n    return this.options['app.releaseVersion']\n  },\n\n  getIsBlocked: function () {\n    return this.blockDetector ? this.blockDetector.isBlocked : null\n  }\n}\n\nmodule.exports = PluginGetterMixin\n","var Log = require('../log')\nvar Util = require('../util')\nvar version = require('../version')\nvar TransportFormat = require('../constants/transportFormat.js')\nvar StreamingProtocol = require('../constants/streamingProtocols')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginContentGetterMixin = {\n  /**\n       * Returns content's playhead\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPlayhead: function () {\n    var ret = this._safeGetterAdapter('getPlayhead')\n    return Util.parseNumber(ret, 0)\n  },\n\n  /**\n       * Returns content's PlayRate\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPlayrate: function () {\n    var ret = 0\n    if (this._adapter && this._adapter.flags && !this._adapter.flags.isPaused) {\n      try {\n        ret = this._adapter.getPlayrate()\n      } catch (err) {\n        Log.warn('An error occured while calling getPlayrate', err)\n      }\n    }\n    return ret\n  },\n\n  /**\n       * Returns content's FramesPerSecond\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getFramesPerSecond: function () {\n    return this._safeGetterAdapter('getFramesPerSecond', 'content.fps')\n  },\n\n  /**\n       * Returns content's DroppedFrames\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getDroppedFrames: function () {\n    var ret = this._safeGetterAdapter('getDroppedFrames')\n    if (!ret) {\n      ret = this.getWebkitDroppedFrames()\n    }\n    return Util.parseNumber(ret, 0)\n  },\n\n  /**\n       * Returns dropped frames as per webkitDroppedFrameCount\n       *\n       * @returns {number}\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getWebkitDroppedFrames: function () {\n    if (this._adapter && this._adapter.tag && this._adapter.tag.webkitDroppedFrameCount) {\n      return this._adapter.tag.webkitDroppedFrameCount\n    }\n    return null\n  },\n\n  /**\n       * Returns content's Duration\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getDuration: function () {\n    var ret = this._safeGetterAdapter('getDuration', 'content.duration') || null\n    return Util.parseNumber(Math.round(ret), null)\n  },\n\n  /**\n       * Returns content's Bitrate\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getBitrate: function () {\n    var ret = this._safeGetterAdapter('getBitrate', 'content.bitrate')\n    if (!ret || ret === -1) {\n      ret = this.getWebkitBitrate()\n    }\n    return Util.parseNumber(ret, -1)\n  },\n\n  /**\n       * Returns content's total bytes downloaded\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getTotalBytes: function () {\n    return this.options['content.sendTotalBytes'] ? this._safeGetterAdapter('getTotalBytes', 'content.totalBytes') : null\n  },\n\n  /**\n       * Returns bitrate as per webkitVideoDecodedByteCount\n       *\n       * @param {Object} tag Video tag DOM reference.\n       * @returns {number}\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getWebkitBitrate: function () {\n    if (this._adapter && this._adapter.tag && this._adapter.tag.webkitVideoDecodedByteCount) {\n      var bitrate = this._adapter.tag.webkitVideoDecodedByteCount\n      if (this._lastWebkitBitrate) {\n        var delta = this._adapter.tag.webkitVideoDecodedByteCount - this._lastWebkitBitrate\n        bitrate = Math.round(((delta) / this.viewTransform.response.pingTime) * 8)\n      }\n      this._lastWebkitBitrate = this._adapter.tag.webkitVideoDecodedByteCount\n      return bitrate !== 0 ? bitrate : -1\n    }\n  },\n\n  /**\n       * Returns content's Throughput\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getThroughput: function () {\n    var ret = this._safeGetterAdapter('getThroughput', 'content.throughput')\n    return Util.parseNumber(ret, -1)\n  },\n\n  /**\n       * Returns content's Rendition\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getRendition: function () {\n    return this._safeGetterAdapter('getRendition', 'content.rendition')\n  },\n\n  /**\n       * Returns content's Title\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getTitle: function () {\n    return this._safeGetterAdapter('getTitle', 'content.title')\n  },\n\n  /**\n       * Returns content's Title2\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getTitle2: function () {\n    return this._safeGetterAdapter('getTitle2', 'content.program')\n  },\n\n  /**\n       * Returns content's IsLive\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getIsLive: function () {\n    var ret = this.options['content.isLive']\n    if (!ret && ret !== false) {\n      ret = this._safeGetterAdapter('getIsLive') || false\n    }\n    return ret\n  },\n\n  /**\n       * Returns content's Resource after being parsed by the resourceTransform\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getResource: function () {\n    return this._safeGetterAdapter('getResource', 'content.resource')\n  },\n\n  getParsedResource: function () {\n    var ret = null\n    if (!this.resourceTransform.isBlocking()) {\n      ret = this.resourceTransform.getResource()\n    }\n    return (ret === this.getResource()) ? null : ret\n  },\n\n  /**\n       * Returns content's TransactionCode\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getTransactionCode: function () {\n    return this.options['content.transactionCode']\n  },\n\n  /**\n       * Returns content's Metadata\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getMetadata: function () {\n    return this.options['content.metadata']\n  },\n\n  /**\n       * Returns content's PlayerVersion\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPlayerVersion: function () {\n    return this._safeGetterAdapter('getPlayerVersion') || ''\n  },\n\n  /**\n       * Returns content's PlayerName\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPlayerName: function () {\n    return this._safeGetterAdapter('getPlayerName') || ''\n  },\n\n  /**\n       * Returns content's Cdn\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getCdn: function () {\n    var ret = null\n    if (!this.resourceTransform.isBlocking()) {\n      ret = this.resourceTransform.getCdnName()\n    }\n    return ret || this.options['content.cdn']\n  },\n\n  /**\n       * Returns content's PluginVersion\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPluginVersion: function () {\n    var ret = this.getAdapterVersion()\n    if (!ret) ret = version + '-adapterless-js'\n\n    return ret\n  },\n\n  /**\n       * Returns content's PluginVersion\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getLibVersion: function () {\n    return version\n  },\n\n  /**\n       * Returns ads adapter getVersion or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getAdapterVersion: function () {\n    return this._safeGetterAdapter('getVersion')\n  },\n\n  /**\n       * Returns cdn traffic received in bytes or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getCdnTraffic: function () {\n    return this._safeGetterAdapter('getCdnTraffic') || this.hybridNetwork.getCdnTraffic()\n  },\n\n  /**\n       * Returns p2p traffic received in bytes or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getP2PTraffic: function () {\n    return this._safeGetterAdapter('getP2PTraffic') || this.hybridNetwork.getP2PTraffic()\n  },\n\n  /**\n       * Returns p2p traffic sent in bytes or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getUploadTraffic: function () {\n    return this._safeGetterAdapter('getUploadTraffic') || this.hybridNetwork.getUploadTraffic()\n  },\n\n  /**\n       * Returns if p2p plugin is enabled or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getIsP2PEnabled: function () {\n    return this._safeGetterAdapter('getIsP2PEnabled') || this.hybridNetwork.getIsP2PEnabled()\n  },\n\n  /** Returns streaming protocol (DASH, HLS, HDS...) */\n  getStreamingProtocol: function () {\n    var ret = this.options['content.streamingProtocol']\n    // if ret is not in the list of possible options, ret = null\n    if (ret) {\n      for (var i in StreamingProtocol) {\n        if (StreamingProtocol[i] === ret) {\n          return ret\n        }\n      }\n    }\n    return null\n  },\n\n  /** Returns transport format (TS, MP4) */\n  getTransportFormat: function () {\n    var ret = this.options['content.transportFormat']\n    if (!ret && this.options['parse.manifest'] && !this.resourceTransform.isBlocking()) {\n      ret = this.resourceTransform.getTransportFormat()\n    }\n    // if ret is not in the list of possible options, ret = null\n    if (ret) {\n      for (var i in TransportFormat) {\n        if (TransportFormat[i] === ret) {\n          return ret\n        }\n      }\n    }\n    return null\n  },\n\n  /** Returns household id */\n  getHouseholdId: function () {\n    return this._safeGetterAdapter('getHouseholdId')\n  },\n\n  /**\n       * Returns latency of a live video, or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getLatency: function () {\n    return this.getIsLive() ? this._safeGetterAdapter('getLatency') : null\n  },\n\n  /**\n       * Returns the amount of packets lost, or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPacketLoss: function () {\n    return this._safeGetterAdapter('getPacketLoss')\n  },\n\n  /**\n       * Returns the amount of packets sent, or null\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPacketSent: function () {\n    return this._safeGetterAdapter('getPacketSent')\n  },\n\n  /**\n       * Returns a json with the metrics to be reported in pings when changed\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getVideoMetrics: function () {\n    return Util.getMetricsFrom(this._adapter ? this._adapter.getMetrics() : null, this.options['content.metrics'])\n  },\n\n  getPlayerStartupTime: function () {\n    return this.browserLoadTimes.getPlayerStartupTime()\n  },\n\n  // ----------------------------------------- CHRONOS ------------------------------------------\n\n  /**\n       * Returns JoinDuration chrono delta time\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getJoinDuration: function () {\n    return this._adapter ? this._adapter.chronos.join.getDeltaTime(false) : -1\n  },\n\n  /**\n       * Returns BufferDuration chrono delta time\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getBufferDuration: function () {\n    return this._adapter ? this._adapter.chronos.buffer.getDeltaTime(false) : -1\n  },\n\n  /**\n       * Returns SeekDuration chrono delta time\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getSeekDuration: function () {\n    return this._adapter ? this._adapter.chronos.seek.getDeltaTime(false) : -1\n  },\n\n  /**\n       * Returns pauseDuration chrono delta time\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPauseDuration: function () {\n    return this._adapter ? this._adapter.chronos.pause.getDeltaTime(false) : 0\n  },\n\n  /**\n       * Returns content's package\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPackage: function () {\n    return this.options['content.package']\n  },\n\n  /**\n       * Returns content's saga\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getSaga: function () {\n    return this.options['content.saga']\n  },\n\n  /**\n       * Returns content's tv show\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getTvShow: function () {\n    return this.options['content.tvShow']\n  },\n\n  /**\n       * Returns content's season\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getSeason: function () {\n    return this.options['content.season']\n  },\n\n  /**\n       * Returns content's episode title\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getEpisodeTitle: function () {\n    return this.options['content.episodeTitle']\n  },\n\n  /**\n       * Returns content's channel\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getChannel: function () {\n    return this.options['content.channel']\n  },\n\n  /**\n       * Returns content's id\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getID: function () {\n    return this.options['content.id']\n  },\n\n  /**\n       * Returns content's IMDB id\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getImdbId: function () {\n    return this.options['content.imdbId']\n  },\n\n  /**\n       * Returns content's gracenote id\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getGracenoteID: function () {\n    return this.options['content.gracenoteId']\n  },\n\n  /**\n       * Returns content's type\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getType: function () {\n    return this.options['content.type']\n  },\n\n  /**\n       * Returns content's genre\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getGenre: function () {\n    return this.options['content.genre']\n  },\n\n  /**\n       * Returns content's language\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getVideoLanguage: function () {\n    return this.options['content.language']\n  },\n\n  /**\n       * Returns content's subtitles\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getSubtitles: function () {\n    return this.options['content.subtitles']\n  },\n\n  /**\n       * Returns content's contracted resolution\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getContractedResolution: function () {\n    return this.options['content.contractedResolution']\n  },\n\n  /**\n       * Returns content's cost\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getCost: function () {\n    return this.options['content.cost']\n  },\n\n  /**\n       * Returns content's price\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPrice: function () {\n    return this.options['content.price']\n  },\n\n  /**\n       * Returns content's playback type\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getPlaybackType: function () {\n    if (this.options['content.playbackType']) {\n      return this.options['content.playbackType']\n    }\n    if (this.getIsLive()) {\n      return 'Live'\n    }\n    return 'VoD'\n  },\n\n  /**\n       * Returns content's DRM\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getDRM: function () {\n    return this.options['content.drm']\n  },\n\n  /**\n       * Returns content's video codec\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getVideoCodec: function () {\n    return this._safeGetterAdapter('getVideoCodec', 'content.encoding.videoCodec')\n  },\n\n  /**\n       * Returns content's audio codec\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getAudioCodec: function () {\n    return this._safeGetterAdapter('getAudioCodec', 'content.encoding.audioCodec')\n  },\n\n  /**\n       * Returns content's codec settings\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getCodecSettings: function () {\n    return this.options['content.encoding.codecSettings']\n  },\n\n  /**\n       * Returns content's codec profile\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getCodecProfile: function () {\n    return this.options['content.encoding.codecProfile']\n  },\n\n  /**\n       * Returns content's container format\n       *\n       * @memberof youbora.Plugin.prototype\n       */\n  getContainerFormat: function () {\n    return this.options['content.encoding.containerFormat']\n  },\n\n  /**\n     * Returns linked view id string\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getLinkedViewId: function () {\n    return this.options.linkedViewId\n  },\n\n  _safeGetterAdapter: function (functionName, optionName) {\n    var ret = null\n    if (optionName && this.options[optionName]) {\n      ret = this.options[optionName]\n    } else {\n      try {\n        if (this._adapter && typeof this._adapter[functionName] === 'function') {\n          ret = this._adapter[functionName]()\n        }\n      } catch (err) {\n        Log.warn('An error occured while calling ' + functionName, err)\n      }\n    }\n    return ret\n  }\n}\n\nmodule.exports = PluginContentGetterMixin\n","var Log = require('../log')\nvar Constants = require('../constants')\nvar Adapter = require('../adapter/adapter')\nvar Util = require('../util')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginAdsMixin = {\n  /**\n     * Returns current adapter or null.\n     *\n     * @returns {Adapter}\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  getAdsAdapter: function () {\n    return this._adsAdapter\n  },\n\n  /**\n     * Sets an adapter for ads.\n     *\n     * @param {Adapter} adsAdapter\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  setAdsAdapter: function (adsAdapter) {\n    if (adsAdapter.plugin) {\n      Log.warn('Adapters can only be added to a single plugin')\n    } else {\n      this.removeAdsAdapter()\n      adsAdapter.plugin = this\n      this._adsAdapter = adsAdapter\n      adsAdapter.setIsAds(true)\n      this.adsAdapterListeners = {}\n      this.adsAdapterListeners[Adapter.Event.START] = this._adStartListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.JOIN] = this._adJoinListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.PAUSE] = this._adPauseListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.RESUME] = this._adResumeListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.BUFFER_BEGIN] = this._adBufferBeginListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.BUFFER_END] = this._adBufferEndListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.STOP] = this._adStopListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.ERROR] = this._adErrorListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.CLICK] = this._adClickListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.MANIFEST] = this._adManifestListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.PODSTART] = this._adBreakStartListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.PODSTOP] = this._adBreakStopListener.bind(this)\n      this.adsAdapterListeners[Adapter.Event.QUARTILE] = this._adQuartileListener.bind(this)\n      for (var key in this.adsAdapterListeners) {\n        this._adsAdapter.on(key, this.adsAdapterListeners[key])\n      }\n    }\n  },\n\n  /**\n     * Removes the current adapter. Fires stop if needed. Calls adapter.dispose()\n     *\n     * @memberof youbora.Plugin.prototype\n     */\n  removeAdsAdapter: function () {\n    if (this._adsAdapter) {\n      this._adsAdapter.dispose()\n      this._adsAdapter.plugin = null\n      if (this.adsAdapterListeners) {\n        for (var key in this.adsAdapterListeners) {\n          this._adsAdapter.off(key, this.adsAdapterListeners[key])\n        }\n        delete this.adsAdapterListeners\n      }\n      this.resizeScrollDetector.stopDetection()\n      this._adsAdapter = null\n    }\n  },\n\n  // ---------------------------------------- LISTENERS -----------------------------------------\n  _adStartListener: function (e) {\n    if (this._adapter) {\n      this._adapter.fireBufferEnd()\n      this._adapter.fireSeekEnd()\n      if (!this.isInitiated && !this._adapter.flags.isStarted) this._adapter.fireStart()\n      if (this._adapter.flags.isPaused) this._adapter.chronos.pause.reset()\n    } else {\n      this.fireInit()\n    }\n    if (this._adsAdapter) {\n      this._adsAdapter.chronos.viewedMax = []\n    }\n    var params = e.data.params || {}\n    params.adNumber = this.requestBuilder.getNewAdNumber()\n    var allParamsReady = (this.getAdResource() || this.getAdTitle()) && typeof this.getAdDuration() === 'number'\n    if (allParamsReady) {\n      this.adStartSent = true\n      this._adsAdapter.fireManifest()\n      this._adsAdapter.fireBreakStart()\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_START, Constants.Service.AD_START, params)\n    } else {\n      this.adInitSent = true\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_INIT, Constants.Service.AD_INIT, params)\n    }\n  },\n\n  _adJoinListener: function (e) {\n    var params = {}\n    Util.assign(params, e.data.params || {})\n    if (this.adInitSent && !this.adStartSent) {\n      this._adsAdapter.fireManifest()\n      this._adsAdapter.fireBreakStart()\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_START, Constants.Service.AD_START, params)\n    }\n    this._adsAdapter.startChronoView()\n    if (this.adConnected) {\n      this._adsAdapter.chronos.join.startTime = this.adConnectedTime\n      this._adsAdapter.chronos.total.startTime = this.adConnectedTime\n      this.adConnectedTime = 0\n      this.adConnected = false\n    }\n    params = e.data.params || {}\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_JOIN, Constants.Service.AD_JOIN, params)\n    this.adInitSent = false\n    this.adStartSent = false\n  },\n\n  _adPauseListener: function (e) {\n    var params = e.data.params || {}\n    this._adsAdapter.stopChronoView()\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_PAUSE, Constants.Service.AD_PAUSE, params)\n  },\n\n  _adResumeListener: function (e) {\n    var params = e.data.params || {}\n    this._adsAdapter.startChronoView()\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_RESUME, Constants.Service.AD_RESUME, params)\n  },\n\n  _adBufferBeginListener: function (e) {\n    Log.notice('Ad Buffer Begin')\n    this._adsAdapter.stopChronoView()\n    if (this._adsAdapter && this._adsAdapter.flags.isPaused) {\n      this._adsAdapter.chronos.pause.reset()\n    }\n  },\n\n  _adBufferEndListener: function (e) {\n    var params = e.data.params || {}\n    this._adsAdapter.startChronoView()\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_BUFFER, Constants.Service.AD_BUFFER, params)\n  },\n\n  _adStopListener: function (e) {\n    this._adsAdapter.stopChronoView()\n    this._adsAdapter.flags.reset()\n    this._totalPrerollsTime = (this._totalPrerollsTime || 0) + this._adsAdapter.chronos.total.getDeltaTime()\n\n    var params = e.data.params || {}\n    params.position = this.requestBuilder.lastSent.position\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_STOP, Constants.Service.AD_STOP, params)\n\n    // If its a stop for a postroll we check if we can detect if its the last one to call view stop\n    if (this.requestBuilder.lastSent.position === Constants.AdPosition.Postroll) {\n      var pat = this.options['ad.expectedPattern']\n      this.playedPostrolls++\n      // If we know the amount of postrolls and this was the last one\n      if ((this.requestBuilder.lastSent.givenAds && this.requestBuilder.lastSent.givenAds <= this.playedPostrolls) ||\n      // Or if we have expected (and not given!) and this was the last expected one\n      (!this.requestBuilder.lastSent.givenAds && pat && pat.post && pat.post[0] && pat.post[0] <= this.playedPostrolls)) {\n        this.fireStop()\n      }\n    }\n\n    this.adConnected = true\n    this.adConnectedTime = new Date().getTime()\n  },\n\n  _adErrorListener: function (e) {\n    var params = e.data.params || {}\n    if (this._adapter && !this._adapter.flags.isStarted && !this.isInitiated) {\n      this._savedAdError = e\n      return null // Ignore ad errors before content\n    }\n    if (this._blockAdError(e.data.params)) return null\n    if (this._adsAdapter) {\n      this._adsAdapter.fireManifest()\n      this._adsAdapter.fireBreakStart()\n    }\n    if (!this._adsAdapter || !this._adsAdapter.flags.isStarted) {\n      params.adNumber = this.requestBuilder.getNewAdNumber()\n    }\n    if (!this.isBreakStarted) {\n      params.breakNumber = this.requestBuilder.getNewBreakNumber()\n    }\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_ERROR, Constants.Service.AD_ERROR, params)\n  },\n\n  _adSavedError: function () {\n    if (this._savedAdError) {\n      this._adErrorListener(this._savedAdError)\n      this._savedAdError = null\n    }\n  },\n\n  _adSavedManifest: function () {\n    if (this._savedAdManifest) {\n      this._adManifestListener(this._savedAdManifest)\n      this._savedAdManifest = null\n    }\n  },\n\n  _blockAdError: function (errorParams) {\n    var now = Date.now()\n    var sameError = this._lastAdErrorParams &&\n      this._lastAdErrorParams.errorCode === errorParams.errorCode &&\n      this._lastAdErrorParams.msg === errorParams.msg &&\n      this._lastAdErrorParams.adCreativeId === this.getAdCreativeId()\n\n    if (sameError && this._lastAdErrorTime + 5000 > now) {\n      this._lastAdErrorTime = now\n      return true\n    }\n    this._lastAdErrorTime = now\n    this._lastAdErrorParams = errorParams\n    return false\n  },\n\n  _adClickListener: function (e) {\n    var params = e.data.params || {}\n    this._adsAdapter.stopChronoView()\n    this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_CLICK, Constants.Service.AD_CLICK, params)\n  },\n\n  _adManifestListener: function (e) {\n    if (!this.isAdsManifestSent) {\n      if (this._adapter && !this._adapter.flags.isStarted && !this.isInitiated) {\n        this._savedAdManifest = e\n        return null // Ignore ad manifest before content\n      }\n      var params = e.data.params || {}\n      this.isAdsManifestSent = true\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_MANIFEST, Constants.Service.AD_MANIFEST, params)\n    }\n  },\n\n  _adBreakStartListener: function (e) {\n    if (!this.isBreakStarted) {\n      this.isBreakStarted = true\n      var params = e.data.params || {}\n      params.breakNumber = this.requestBuilder.getNewBreakNumber()\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_POD_START, Constants.Service.AD_POD_START, params)\n      this.adConnected = false\n    }\n  },\n\n  _adBreakStopListener: function (e) {\n    if (this.isBreakStarted) {\n      this.isBreakStarted = false\n      var params = e.data.params || {}\n      params.position = this.requestBuilder.lastSent.position\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_POD_STOP, Constants.Service.AD_POD_STOP, params)\n      this.adConnected = false\n    }\n  },\n\n  _adQuartileListener: function (e) {\n    var params = e.data.params || {}\n    if (params.quartile) {\n      this._sendAdEventIfAllowed(Constants.WillSendEvent.WILL_SEND_AD_QUARTILE, Constants.Service.AD_QUARTILE, params)\n    }\n  },\n\n  _sendAdEventIfAllowed: function (willSend, service, params) {\n    if (!this.options['ad.ignore']) this._send(willSend, service, params)\n    Log.notice(service)\n  }\n\n}\n\nmodule.exports = PluginAdsMixin\n","var Log = require('../log')\nvar Util = require('../util')\nvar Constants = require('../constants')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginAdsGettersMixin = {\n  /**\n   * Returns ads's PlayerVersion\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdPlayerVersion: function () {\n    return this._safeGetterAdsAdapter('getPlayerVersion') || ''\n  },\n\n  /**\n   * Returns ad's position\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdPosition: function () {\n    var ret = Constants.AdPosition.Preroll\n    if (this._adsAdapter) {\n      try {\n        var temporalRet = this._adsAdapter.getPosition()\n        if (Constants.AdPosition.Preroll === temporalRet ||\n          Constants.AdPosition.Midroll === temporalRet ||\n          Constants.AdPosition.Postroll === temporalRet) {\n          ret = temporalRet\n        }\n      } catch (err) {\n        Log.warn('An error occured while calling getAdPosition', err)\n      }\n    }\n    if (!ret && this._adapter) {\n      ret = (this._adapter.flags.isJoined) ? Constants.AdPosition.Midroll : Constants.AdPosition.Preroll\n    }\n    return ret\n  },\n\n  getAdNumber: function () {\n    return this.requestBuilder.lastSent.adNumber || 0\n  },\n\n  getBreakNumber: function () {\n    return this.requestBuilder.lastSent.breakNumber || 0\n  },\n\n  /**\n   * Returns ad's AdPlayhead\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdPlayhead: function () {\n    var ret = this._safeGetterAdsAdapter('getPlayhead')\n    return Util.parseNumber(ret, 0)\n  },\n\n  /**\n   * Returns ad's AdDuration\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdDuration: function () {\n    var ret = this._safeGetterAdsAdapter('getDuration')\n    return Util.parseNumber(ret, 0)\n  },\n\n  /**\n   * Returns ad's AdBitrate\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdBitrate: function () {\n    var ret = this._safeGetterAdsAdapter('getBitrate')\n    if (!ret || ret === -1) {\n      ret = this.getWebkitAdBitrate()\n    }\n    return Util.parseNumber(ret, -1)\n  },\n\n  /**\n   * Returns bitrate as per webkitVideoDecodedByteCount\n   *\n   * @param {Object} tag Video tag DOM reference.\n   * @returns {number}\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getWebkitAdBitrate: function () {\n    if (this._adsAdapter && this._adsAdapter.tag && this._adsAdapter.tag.webkitVideoDecodedByteCount) {\n      var bitrate = this._adsAdapter.tag.webkitVideoDecodedByteCount\n      if (this._lastWebkitAdBitrate) {\n        var delta = this._adsAdapter.tag.webkitVideoDecodedByteCount - this._lastWebkitAdBitrate\n        bitrate = Math.round(((delta) / this.viewTransform.response.pingTime) * 8)\n      }\n      this._lastWebkitAdBitrate = this._adsAdapter.tag.webkitVideoDecodedByteCount\n      return bitrate !== 0 ? bitrate : -1\n    }\n  },\n\n  /**\n   * Returns ad's AdTitle\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdTitle: function () {\n    return this._safeGetterAdsAdapter('getTitle', 'ad.title')\n  },\n\n  /**\n   * Returns ad's AdResource\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdResource: function () {\n    return this._safeGetterAdsAdapter('getResource', 'ad.resource')\n  },\n\n  /**\n   * Returns ad's campaign\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdCampaign: function () {\n    return this._safeGetterAdsAdapter('getCampaign', 'ad.campaign')\n  },\n\n  /**\n  * Returns ad's campaign\n  *\n  * @memberof youbora.Plugin.prototype\n  */\n  getAdCreativeId: function () {\n    return this._safeGetterAdsAdapter('getCreativeId', 'ad.creativeId')\n  },\n\n  /**\n  * Returns ad's provider\n  *\n  * @memberof youbora.Plugin.prototype\n  */\n  getAdProvider: function () {\n    return this._safeGetterAdsAdapter('getProvider', 'ad.provider')\n  },\n\n  /**\n   * Returns ads adapter getVersion or null\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdAdapterVersion: function () {\n    return this._safeGetterAdsAdapter('getVersion')\n  },\n\n  /**\n   * Returns ad's AdMetadata\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdMetadata: function () {\n    return this.options['ad.metadata']\n  },\n\n  /**\n   * Returns the type of ad insertion (clientside, serverside)\n   * @returns {string} ad insertion type\n   */\n  getAdInsertionType: function () {\n    return this._safeGetterAdsAdapter('getAdInsertionType')\n  },\n\n  getGivenBreaks: function () {\n    return this._safeGetterAdsAdapter('getGivenBreaks', 'ad.givenBreaks')\n  },\n\n  getExpectedBreaks: function () {\n    var ret = null\n    var expBreaks = this.options['ad.expectedBreaks']\n    var expPattern = this.options['ad.expectedPattern']\n    if (expBreaks) {\n      ret = expBreaks\n    } else if (expPattern) {\n      ret = 0\n      ret = expPattern.pre ? expPattern.pre.length : 0\n      ret += expPattern.mid ? expPattern.mid.length : 0\n      ret += expPattern.post ? expPattern.post.length : 0\n    } else if (this._adsAdapter) {\n      try {\n        ret = this._adsAdapter.getExpectedBreaks()\n      } catch (err) {\n        Log.warn('An error occured while calling expectedBreaks', err)\n      }\n    }\n    return ret\n  },\n\n  getExpectedPattern: function () {\n    return this._safeGetterAdsAdapter('getExpectedPattern', 'ad.expectedPattern')\n  },\n\n  getBreaksTime: function () {\n    return this._safeGetterAdsAdapter('getBreaksTime', 'ad.breaksTime')\n  },\n\n  getGivenAds: function () {\n    return this._safeGetterAdsAdapter('getGivenAds', 'ad.givenAds')\n  },\n\n  getExpectedAds: function () {\n    var ret = null\n    try {\n      if (this._adsAdapter) {\n        var pattern = this.options['ad.expectedPattern']\n        if (pattern && this.getAdPosition()) {\n          var list = []\n          if (pattern.pre) list = list.concat(pattern.pre)\n          if (pattern.mid) list = list.concat(pattern.mid)\n          if (pattern.post) list = list.concat(pattern.post)\n          if (list.length > 0) {\n            var position = this.requestBuilder.lastSent.breakNumber\n            if (position > list.length) position = list.length\n            ret = list[position - 1]\n          }\n        } else {\n          ret = this._adsAdapter.getExpectedAds()\n        }\n      }\n    } catch (err) {\n      Log.warn('An error occured while calling expectedAds', err)\n    }\n    return ret\n  },\n\n  getAdsExpected: function () {\n    var ret = null\n    try {\n      ret = (this.getExpectedPattern() || this.getGivenAds()) || false\n    } catch (err) {\n      Log.warn('An error occured while calling givenAds or expectedPattern', err)\n    }\n    return ret\n  },\n\n  // ----------------------------------------- CHRONOS ------------------------------------------\n\n  /**\n   * Returns AdJoinDuration chrono delta time\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdJoinDuration: function () {\n    return this._adsAdapter ? this._adsAdapter.chronos.join.getDeltaTime(false) : -1\n  },\n\n  /**\n   * Returns AdBufferDuration chrono delta time\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdBufferDuration: function () {\n    return this._adsAdapter ? this._adsAdapter.chronos.buffer.getDeltaTime(false) : -1\n  },\n\n  /**\n   * Returns AdPauseDuration chrono delta time\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdPauseDuration: function () {\n    return this._adsAdapter ? this._adsAdapter.chronos.pause.getDeltaTime(false) : 0\n  },\n\n  /**\n   * Returns total totalAdDuration chrono delta time\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  getAdTotalDuration: function () {\n    return this._adsAdapter ? this._adsAdapter.chronos.total.getDeltaTime(false) : -1\n  },\n\n  getAdViewedDuration: function () {\n    return this._getTimeMaxOrAcum(true)\n  },\n\n  getAdViewability: function () {\n    return this._getTimeMaxOrAcum()\n  },\n\n  _getTimeMaxOrAcum: function (acum) {\n    var maxTime = 0\n    if (this._adsAdapter) {\n      this._adsAdapter.chronos.viewedMax.forEach(function (chrono) {\n        if (acum) {\n          maxTime += chrono.getDeltaTime(false)\n        } else {\n          maxTime = Math.max(chrono.getDeltaTime(false), maxTime)\n        }\n      })\n    }\n    return maxTime\n  },\n\n  getAudioEnabled: function () {\n    return this._safeGetterAdsAdapter('getAudioEnabled')\n  },\n\n  getIsSkippable: function () {\n    return this._safeGetterAdsAdapter('getIsSkippable')\n  },\n\n  getIsFullscreen: function () {\n    return this._safeGetterAdsAdapter('getIsFullscreen')\n  },\n\n  _safeGetterAdsAdapter: function (func, option) {\n    var ret = null\n    if (option && this.options[option]) {\n      ret = this.options[option]\n    } else {\n      try {\n        if (this._adsAdapter && typeof this._adsAdapter[func] === 'function') {\n          ret = this._adsAdapter[func]()\n        }\n      } catch (err) {\n        Log.warn('An error occured while calling ' + func, err)\n      }\n    }\n    return ret\n  }\n}\n\nmodule.exports = PluginAdsGettersMixin\n","var Log = require('../log')\nvar Constants = require('../constants')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginPingMixin = {\n  /**\n   * Starts sending pings.\n   *\n   * @private\n   * @memberof youbora.Plugin.prototype\n   */\n  _startPings: function () {\n    if (!this._ping.isRunning) this._ping.start()\n  },\n\n  /**\n   * Stops sending pings.\n   *\n   * @private\n   * @memberof youbora.Plugin.prototype\n   */\n  _stopPings: function () {\n    this._ping.stop()\n  },\n\n  /**\n   * Sends ping request\n   *\n   * @param {number} diffTime Time since the last ping\n   *\n   * @private\n   * @memberof youbora.Plugin.prototype\n   */\n  _sendPing: function (diffTime) {\n    var params = {\n      diffTime: diffTime,\n      entities: this.requestBuilder.getChangedEntities()\n    }\n    if (this._adapter) {\n      if (this._adapter.flags.isPaused) {\n        params = this.requestBuilder.fetchParams(params, ['pauseDuration'])\n      } else {\n        params = this.requestBuilder.fetchParams(params, ['bitrate', 'throughput', 'fps'])\n      }\n      if (this._adapter.flags.isJoined) {\n        params = this.requestBuilder.fetchParams(params, ['playhead'])\n      }\n      if (this._adapter.flags.isBuffering) {\n        params = this.requestBuilder.fetchParams(params, ['bufferDuration'])\n      }\n      if (this._adapter.flags.isSeeking) {\n        params = this.requestBuilder.fetchParams(params, ['seekDuration'])\n      }\n\n      if (this._adsAdapter && !this.options['ad.ignore']) {\n        if (this._adsAdapter.flags.isStarted) {\n          params = this.requestBuilder.fetchParams(params, ['adPlayhead', 'adViewedDuration', 'adViewability'])\n          if (this._adsAdapter.flags.isPaused) {\n            params = this.requestBuilder.fetchParams(params, ['adPauseDuration'])\n          } else {\n            params = this.requestBuilder.fetchParams(params, ['adBitrate'])\n          }\n        }\n        if (this._adsAdapter.flags.isBuffering) {\n          params = this.requestBuilder.fetchParams(params, ['adBufferDuration'])\n        }\n      }\n    }\n\n    this._send(Constants.WillSendEvent.WILL_SEND_PING, Constants.Service.PING, params)\n    if (this.startDelayed) {\n      this._retryStart()\n    }\n    Log.verbose(Constants.Service.PING)\n  }\n}\n\nmodule.exports = PluginPingMixin\n","var Log = require('../log')\nvar Util = require('../util')\nvar Constants = require('../constants')\nvar Transform = require('../comm/transform/transform')\n\n// This file is designed to add extra functionalities to Plugin class\n\n/** @lends youbora.Plugin.prototype */\nvar PluginFireMixin = {\n  /**\n   * Sends /init. Should be called once the user has requested the content. Does not need\n   * a working adapter or player to work. it won't sent start if isInitiated is true.\n   *\n   * @param {Object} [params] Object of key:value params.\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  fireInit: function (params) {\n    if (!this.isInitiated) {\n      if (!this.getAdapter() || (this.getAdapter() && !this.getAdapter().flags.isStarted)) {\n        this.viewTransform.nextView()\n        this._initComm()\n        this._startPings()\n        this.initChrono.start()\n        this.isInitiated = true\n\n        params = params || {}\n        this._send(Constants.WillSendEvent.WILL_SEND_INIT, Constants.Service.INIT, params)\n        this._adSavedError()\n        this._adSavedManifest()\n        Log.notice(Constants.Service.INIT + ' ' + (params.title || params.mediaResource))\n      }\n    }\n  },\n\n  /**\n   * Sends /error. Should be used when the error is related to out-of-player errors: like async\n   * resource load or player loading errors.\n   *\n   * @param {String|Object} [code] Error Code, if an object is sent, it will be treated as params.\n   * @param {String} [msg] Error Message\n   * @param {Object} [metadata] Object defining error metadata\n   * @param {String} [level] Level of the error. Currently supports 'error' and 'fatal'\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  fireError: function (object, msg, metadata, level) {\n    this.fireInit()\n    var params = Util.buildErrorParams(object, msg, metadata, level)\n    if (params.code) {\n      delete params.code\n    }\n    this._send(Constants.WillSendEvent.WILL_SEND_ERROR, Constants.Service.ERROR, params)\n    this._adSavedError()\n    this._adSavedManifest()\n    Log.notice(Constants.Service.ERROR +\n      ' ' + params.errorLevel +\n      ' ' + params.errorCode\n    )\n\n    if (params.errorLevel === 'fatal') {\n      this.fireStop()\n    }\n  },\n\n  /**\n   * Calls fireErrors and then stops pings.\n   *\n   * @param {String|Object} [code] Error Code, if an object is sent, it will be treated as params.\n   * @param {String} [msg] Error Message\n   * @param {Object} [metadata] Object defining error metadata\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  fireFatalError: function (object, msg, metadata, level) {\n    this.fireError(object, msg, metadata, level)\n    this.fireStop()\n  },\n\n  /**\n   * Fires /stop. Should be used to terminate sessions once the player is gone or if\n   * plugin.fireError() is called.\n   *\n   * @param {Object} [params] Object of key:value params.\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  fireStop: function (params) {\n    if (this.isInitiated || this.isStarted) {\n      if (this._adapter) {\n        this._adapter.flags.isStopped = true\n        if (this._adapter.monitor) this._adapter.monitor.stop()\n      }\n      if (this._adsAdapter && this.isBreakStarted) {\n        this._adsAdapter.fireBreakStop()\n      }\n      params = params || {}\n      this._send(Constants.WillSendEvent.WILL_SEND_STOP, Constants.Service.STOP, params)\n      var chronos = this._adapter ? this._adapter.chronos : null\n      if (chronos) {\n        chronos.total.stop()\n        chronos.join.reset()\n        chronos.pause.reset()\n        chronos.buffer.reset()\n        chronos.seek.reset()\n      }\n      Log.notice(Constants.Service.STOP + ' at ' + params.playhead + 's')\n      this._reset()\n    }\n  },\n\n  /**\n   * Fires /offlineEvents. If offline is disabled, will try to send all the views stored.\n   *\n   * @param {Object} [params] Object of key:value params.\n   *\n   * @memberof youbora.Plugin.prototype\n   */\n  fireOfflineEvents: function (params) {\n    if (this.options && !this.options.offline) {\n      if (!this.isInitiated &&\n        (!this._adapter || !this._adapter.flags.isStarted) &&\n        (!this._adsAdapter || !this._adsAdapter.flags.isStarted)) {\n        this._offlineParams = params\n        if (this.viewTransform.response.code && this.viewTransform.response.host) {\n          this._generateAndSendOffline()\n        } else {\n          this.offlineReference = this._generateAndSendOffline.bind(this)\n          this.viewTransform.on(Transform.Event.DONE, this.offlineReference)\n        }\n      } else {\n        Log.error('Adapters have to be stopped')\n      }\n    } else {\n      Log.error('To send offline events, offline option must be disabled')\n    }\n  },\n\n  _generateAndSendOffline: function () {\n    if (this.options.disableStorage) return null\n    var params = this._offlineParams\n    this._initComm()\n    while (true) {\n      var bodyAndId = this.requestBuilder.buildBody(Constants.Service.OFFLINE_EVENTS).viewJson\n      if (bodyAndId[0] === null) break\n      var newViewCode = this.viewTransform.nextView()\n      var body = bodyAndId[0].replace(/CODE_PLACEHOLDER/g, newViewCode.toString())\n        .replace(/,\"sessionId\":\"SESSION_PLACEHOLDER\"/g, '') // this.viewTransform.getSession()\n        .replace(/,\"sessionRoot\":\"ROOT_PLACEHOLDER\"/g, '') // this.viewTransform.getSession()\n      // modify to support offline+infinity\n      this._send(Constants.WillSendEvent.WILL_SEND_OFFLINE_EVENTS, Constants.Service.OFFLINE_EVENTS,\n        params, body, 'POST', function (a, callbackParams) {\n          this.offlineStorage.removeView(callbackParams.offlineId)\n        }.bind(this), { offlineId: bodyAndId[1] })\n    }\n    this.offlineStorage.sent()\n    this._offlineParams = null\n  }\n}\n\nmodule.exports = PluginFireMixin\n","var Constants = require('../constants')\nvar Log = require('../log')\nvar YBRequest = require('../comm/request')\nvar Util = require('../util')\n\nvar YouboraInfinity = require('../infinity/infinity')\n\n// This file is designed to add extra functionalities to Plugin class\n\nvar PluginInfinityMixin = {\n  _initInfinity: function () {\n    this.infinity.on(YouboraInfinity.Event.NAV, this._navListener.bind(this))\n    this.infinity.on(YouboraInfinity.Event.SESSION_START, this._sessionStartListener.bind(this))\n    this.infinity.on(YouboraInfinity.Event.SESSION_STOP, this._sessionStopListener.bind(this))\n    this.infinity.on(YouboraInfinity.Event.EVENT, this._eventListener.bind(this))\n  },\n\n  _sendInfinity: function (willSendEvent, service, params) {\n    params = this.requestBuilder.buildParams(params, service)\n\n    var data = {\n      params: params,\n      plugin: this,\n      adapter: this.getAdapter(),\n      adsAdapter: this.getAdsAdapter()\n    }\n\n    this.emit(willSendEvent, data)\n\n    if (this.infinity._comm && params !== null && this.options.enabled) {\n      this.lastServeiceSent = service\n      this.infinity._comm.sendRequest(new YBRequest(null, service, params))\n    }\n  },\n\n  // ---------------------------------------- LISTENERS -----------------------------------------\n\n  _navListener: function (e) {\n    var params = e.data.params || {}\n    this._sendInfinity(Constants.WillSendEvent.WILL_SEND_NAV, Constants.Service.NAV, params)\n\n    // start beats\n    if (!this._beat.isRunning) this._beat.start()\n\n    Log.notice(Constants.Service.NAV + ' ' + params.route)\n  },\n\n  _sessionStartListener: function (e) {\n    var params = e.data.params || {}\n    this._sendInfinity(\n      Constants.WillSendEvent.WILL_SEND_SESSION_START,\n      Constants.Service.SESSION_START,\n      params\n    )\n\n    // start beats\n    if (!this._beat.isRunning) this._beat.start()\n\n    Log.notice(Constants.Service.SESSION_START + ' ' + params.route)\n  },\n\n  _sessionStopListener: function (e) {\n    var params = e.data.params || {}\n    this._sendInfinity(\n      Constants.WillSendEvent.WILL_SEND_SESSION_STOP,\n      Constants.Service.SESSION_STOP,\n      params\n    )\n\n    // stop beats\n    if (this._beat.isRunning) this._beat.stop()\n\n    Log.notice(Constants.Service.SESSION_STOP + ' ' + params.route)\n  },\n\n  _eventListener: function (e) {\n    var params = e.data.params || {}\n    this._sendInfinity(Constants.WillSendEvent.WILL_SEND_EVENT, Constants.Service.EVENT, params)\n    Log.notice(Constants.Service.EVENT + ' ' + params.name)\n  },\n\n  /**\n   * Sends beat request\n   *\n   * @param {number} diffTime Time since the last ping\n   *\n   * @private\n   * @memberof youbora.Plugin.prototype\n   */\n  _sendBeat: function (diffTime) {\n    var params = {\n      diffTime: diffTime\n    }\n\n    this._sendInfinity(Constants.WillSendEvent.WILL_SEND_BEAT, Constants.Service.BEAT, params)\n    if (this.infinity) {\n      this.infinity._setLastActive()\n    }\n    Log.verbose(Constants.Service.BEAT)\n  },\n\n  // ---------------------------------------- GETTERS -----------------------------------------\n\n  /**\n* Returns a json with the metrics to be reported in beats when changed\n*\n* @memberof youbora.Plugin.prototype\n*/\n  getSessionMetrics: function () {\n    return Util.getMetricsFrom(this.options['session.metrics'])\n  }\n}\n\nmodule.exports = PluginInfinityMixin\n","// This file is designed to add extra functionalities to Plugin class\n\nvar PluginInfinityGettersMixin = {\n  getContext: function () {\n    var ret = 'Default'\n    if (this.options['session.context']) {\n      ret = this.storage.getSession('context')\n    }\n    return ret\n  },\n\n  getScrollDepth: function () {\n    var ret = this.storage.getSession('pageScrollDepth')\n    this.storage.removeSession('pageScrollDepth')\n    return ret\n  },\n\n  getSession: function () {\n    return this.storage.getStorages('session')\n  },\n\n  getStorageHost: function () {\n    return this.storage.getStorages('host')\n  },\n\n  getStoredData: function () {\n    return this.storage.getStorages('data')\n  },\n\n  getDataTime: function () {\n    return this.storage.getStorages('dataTime')\n  },\n\n  getLastActive: function () {\n    return this.storage.getStorages('lastactive')\n  },\n\n  setStoredData: function (data) {\n    this.storage.setStorages('data', data)\n  },\n\n  setSession: function (session) {\n    this.storage.setStorages('session', session)\n  },\n\n  setDataTime: function (time) {\n    this.storage.setStorages('dataTime', time)\n  },\n\n  setLastActive: function (last) {\n    this.storage.setStorages('lastactive', last)\n  },\n\n  getPageName: function () {\n    if (typeof document !== 'undefined' && document.title) {\n      return document.title\n    }\n  },\n\n  getPageLoadTime: function () {\n    return this.browserLoadTimes.getPageLoadTime()\n  },\n\n  getIsSessionExpired: function () {\n    var now = new Date().getTime()\n    return !this.getSession() || (this.infinity.getFirstActive() < now - this.sessionExpire)\n  },\n\n  getIsDataExpired: function () {\n    var now = new Date().getTime()\n    return !this.storage.isEnabled() || !this.getStoredData() || (this.infinity.getFirstActive() < now - this.sessionExpire)\n  }\n}\n\nmodule.exports = PluginInfinityGettersMixin\n","/* global bitmovin */\nvar youbora = require('youboralib')\nvar manifest = require('../manifest.json')\n\nyoubora.adapters.Bitmovin = youbora.Adapter.extend({\n  getVersion: function () {\n    return manifest.version + '-' + manifest.name + '-' + manifest.tech\n  },\n\n  getPlayhead: function () {\n    return this.playingAds ? this.lastPlayhead : this.player.getCurrentTime()\n  },\n\n  getDuration: function () {\n    return this.player.getDuration()\n  },\n\n  getPlayrate: function () {\n    if (this.flags.isPaused) return 0\n    if (typeof this.player.getPlaybackSpeed() !== 'undefined') {\n      return this.player.getPlaybackSpeed()\n    }\n    return 1\n  },\n\n  getDroppedFrames: function () {\n    return this.player.getDroppedFrames()\n  },\n\n  getBitrate: function () {\n    if (this.player.getPlaybackVideoData && this.player.getPlaybackVideoData() &&\n            this.player.getPlaybackVideoData().bitrate) {\n      return this.player.getPlaybackVideoData().bitrate\n    } else {\n      return -1\n    }\n  },\n\n  getRendition: function () {\n    if (this.player.getPlaybackVideoData && this.player.getPlaybackVideoData()) {\n      var playbackValues = this.player.getPlaybackVideoData()\n      if (playbackValues.bitrate) {\n        if (playbackValues.width && playbackValues.height) {\n          return youbora.Util.buildRenditionString(playbackValues.width, playbackValues.height, playbackValues.bitrate)\n        }\n        return playbackValues.bitrate\n      }\n      return this.player.getPlaybackVideoData().id\n    }\n    return -1\n  },\n\n  getIsLive: function () {\n    return this.player.isLive()\n  },\n\n  getResource: function () {\n    if (this.player.getConfig) {\n      var sourceObject = this.player.getConfig().source\n      if (sourceObject) {\n        return sourceObject.dash || sourceObject.hls || sourceObject.progressive\n      }\n    }\n    return 'unknown'\n  },\n\n  getPlayerName: function () {\n    return 'Bitmovin'\n  },\n\n  getPlayerVersion: function () {\n    return bitmovin.player.version\n  },\n\n  registerListeners: function () {\n    this.monitorPlayhead(true, true)\n\n    var EVENT = this.player.EVENT || bitmovin.player.EVENT\n    this.references = {}\n    this.references[EVENT.ON_ERROR] = this.errorListener.bind(this)\n    this.references[EVENT.ON_PAUSED] = this.pauseListener.bind(this)\n    this.references[EVENT.ON_PLAY] = this.playListener.bind(this)\n    this.references[EVENT.ON_PLAYING] = this.playingListener.bind(this)\n    this.references[EVENT.ON_PLAYBACK_FINISHED] = this.endedListener.bind(this)\n    this.references[EVENT.ON_SEEK] = this.seekingListener.bind(this)\n    this.references[EVENT.ON_SEEKED] = this.seekedListener.bind(this)\n    this.references[EVENT.ON_SEGMENT_PLAYBACK] = this.joinListener.bind(this)\n    this.references[EVENT.ON_SOURCE_UNLOADED] = this.endedListener.bind(this)\n    this.references[EVENT.ON_STOP_BUFFERING] = this.joinListener.bind(this)\n    this.references[EVENT.ON_TIME_CHANGED] = this.joinChangedListener.bind(this)\n    this.references[EVENT.ON_AD_BREAK_FINISHED] = this.endAdsListener.bind(this)\n    this.references[EVENT.ON_AD_BREAK_STARTED] = this.startAdsListener.bind(this)\n    for (var key in this.references) {\n      this.player.addEventHandler(key, this.references[key])\n    }\n  },\n\n  /** Unregister listeners to this.player. */\n  unregisterListeners: function () {\n    // Disable playhead monitoring\n    if (this.monitor) this.monitor.stop()\n\n    // unregister listeners\n    if (this.player && this.references) {\n      for (var key in this.references) {\n        this.player.removeEventHandler(key, this.references[key])\n        delete this.references[key]\n      }\n    }\n  },\n\n  /** Listener for 'ON_PLAY' event. */\n  playListener: function (e) {\n    if (!this.plugin.getAdsAdapter()) this.plugin.setAdsAdapter(new youbora.adapters.Bitmovin.NativeAdsAdapter(this.player))\n    this.fireStart()\n    this.fireResume()\n  },\n\n  /** Listener for 'ON_SEGMENT_PLAYBACK' and 'ON_STOP_BUFFERING' events. */\n  joinListener: function (e) {\n    this.fireJoin()\n  },\n\n  /** Listener for 'ON_PAUSED' event. */\n  pauseListener: function (e) {\n    if (!this.flags.isSeeking) this.firePause()\n  },\n\n  /** Listener for 'ON_PLAYING' events. */\n  playingListener: function (e) {\n    this.fireStart()\n  },\n\n  /** Listener for 'ON_ERROR' event. */\n  errorListener: function (e) {\n    this.fireError(e.code, e.message)\n    // 200, 303, 403, 404, 405, 900, 901 Advertisement\n    // 1000 to 1028 Setup error\n    // 2000, 2001, 2002, 3000 to 3047 Error\n    // 5000 to 5013 Warning\n    if (e.code >= 1000 && e.code <= 4999) {\n      this.fireStop()\n    }\n  },\n\n  /** Listener for 'ON_SEEK' event. */\n  seekingListener: function (e) {\n    this.fireSeekBegin()\n  },\n\n  /** Listener for 'ON_SEEKED' event. */\n  seekedListener: function (e) {\n    this.monitor.skipNextTick()\n  },\n\n  /** Listener for 'ON_PLAYBACK_FINISHED' event. */\n  endedListener: function (e) {\n    this.fireStop()\n  },\n\n  /** Listener for 'ON_TIME_CHANGED' event */\n  joinChangedListener: function (e) {\n    if (this.getPlayhead() > 0) {\n      this.fireStart()\n      this.fireJoin()\n    }\n    this.lastPlayhead = this.getPlayhead()\n  },\n\n  /** Listener for 'ON_AD_BREAK_FINISHED' event */\n  endAdsListener: function (e) {\n    this.playingAds = false\n    this.fireResume()\n  },\n\n  /** Listener for 'ON_AD_BREAK_STARTED' event */\n  startAdsListener: function (e) {\n    this.playingAds = true\n    this.firePause()\n  }\n},\n// Static members\n{\n  NativeAdsAdapter: require('./ads/nativeads')\n}\n)\n\nmodule.exports = youbora.adapters.Bitmovin\n","/* global bitmovin */\nvar youbora = require('youboralib')\nvar manifest = require('../../manifest.json')\n\nyoubora.adapters.Bitmovin = youbora.Adapter.extend({\n  getVersion: function () {\n    return manifest.version + '-' + manifest.name + '-' + manifest.tech\n  },\n\n  getDuration: function () {\n    return this.duration\n  },\n\n  getPosition: function () {\n    return this.plugin.getAdapter().flags.isJoined ? 'mid' : 'pre'\n  },\n\n  registerListeners: function () {\n    var EVENT = this.player.EVENT || bitmovin.player.EVENT\n    this.references = {}\n    this.references[EVENT.ON_AD_CLICKED] = this.clickListener.bind(this)\n    this.references[EVENT.ON_AD_ERROR] = this.errorListener.bind(this)\n    this.references[EVENT.ON_AD_FINISHED] = this.endListener.bind(this)\n    this.references[EVENT.ON_AD_MANIFEST_LOADED] = this.manifestListener.bind(this)\n    this.references[EVENT.ON_AD_PLAYBACK_FINISHED] = this.endListener.bind(this)\n    this.references[EVENT.ON_AD_SKIPPED] = this.skipListener.bind(this)\n    this.references[EVENT.ON_AD_STARTED] = this.joinListener.bind(this)\n    this.references[EVENT.ON_AD_BREAK_FINISHED] = this.endListener.bind(this)\n    this.references[EVENT.ON_AD_BREAK_STARTED] = this.playListener.bind(this)\n    // this.references[EVENT.ON_AD_QUARTILE] = this.quartileListener.bind(this)\n    this.references[EVENT.ON_PAUSED] = this.pauseListener.bind(this)\n    this.references[EVENT.ON_PLAYING] = this.playingListener.bind(this)\n    for (var key in this.references) {\n      this.player.addEventHandler(key, this.references[key])\n    }\n  },\n\n  /** Unregister listeners to this.player. */\n  unregisterListeners: function () {\n    // unregister listeners\n    if (this.player && this.references) {\n      for (var key in this.references) {\n        this.player.removeEventHandler(key, this.references[key])\n        delete this.references[key]\n      }\n    }\n  },\n\n  playListener: function (e) {\n    this.fireStart()\n    this.fireResume()\n  },\n\n  pauseListener: function (e) {\n    this.firePause()\n  },\n\n  playingListener: function (e) {\n    this.fireResume()\n  },\n\n  joinListener: function (e) {\n    this.duration = e.duration\n    this.fireStart()\n    this.fireJoin()\n  },\n\n  clickListener: function (e) {\n    this.fireClick(e.clickThroughUrl)\n  },\n\n  endListener: function (e) {\n    this.fireStop()\n    this.duration = null\n  },\n\n  errorListener: function (e) {\n    // 200, 303, 403, 404, 405, 900, 901 Advertisement\n    if (e.code >= 200 && e.code <= 999) {\n      this.fireError(e.code, e.message)\n      this.fireStop()\n      this.duration = null\n    }\n  },\n\n  skipListener: function (e) {\n    this.fireSkip()\n    this.duration = null\n  },\n\n  manifestListener: function (e) {\n    youbora.Log.error(e)\n  }\n\n  /* quartileListener: function (e) {\n              var quartileNumber = 1\n              if (e.quartile === \"midpoint\") {\n                quartileNumber = 2\n              } else if (e.quartile === \"thirdQuartile\") {\n                quartileNumber = 3\n              }\n              this.fireQuartile(quartileNumber)\n            } */\n\n})\n\nmodule.exports = youbora.adapters.Bitmovin\n"],"sourceRoot":""}